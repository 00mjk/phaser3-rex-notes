!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).rexgridalignplugin=i()}(this,function(){"use strict";function e(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function t(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,i){return(s=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function o(t,i){return!i||"object"!=typeof i&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}var h=Math.sqrt(3),u=Math.sqrt(3),i=0,a=1,c=2,l=3,f=i,d=a,g=c,y=l,p={},T=i,v=a,O=c,x=l,_={},b={},w=i,k=a,E=c,W=l,H={},P={},M=function(t,i,e){if(t&&"number"!=typeof t){if(t.hasOwnProperty(i))return t[i];if(-1===i.indexOf("."))return e;for(var n=i.split("."),r=t,s=e,o=0;o<n.length;o++){if(!r.hasOwnProperty(n[o])){s=e;break}s=r[n[o]],r=r[n[o]]}return s}return e},X=i,Y=a,m=c,z=l,R=function(){function i(t){e(this,i),this.resetFromJSON(t)}return t(i,[{key:"resetFromJSON",value:function(t){if(this.setType(M(t,"staggeraxis",1),M(t,"staggerindex",1)),this.setDirectionMode(),this.setOriginPosition(M(t,"x",0),M(t,"y",0)),this.size=M(t,"size",void 0),void 0!==this.size){var i={size:this.size,type:this.staggeraxis},e=function(t){return 0===t.type?2*t.size:h*t.size}(i),n=function(t){return 0===t.type?u*t.size:2*t.size}(i);this.setCellSize(e,n)}else this.setCellSize(M(t,"cellWidth",0),M(t,"cellHeight",0))}},{key:"setType",value:function(t,i){return"string"==typeof t&&(t=S[t]),"string"==typeof i&&(i=F[i]),this.staggeraxis=t,this.staggerindex=i,this.mode=0===t?0===i?z:m:0===i?Y:X,this}},{key:"setDirectionMode",value:function(){return this.directions=6,this}},{key:"setOriginPosition",value:function(t,i){return this.x=t,this.y=i,this}},{key:"setCellSize",value:function(t,i){return this.width=t,this.height=i,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t}},{key:"cellHeight",get:function(){return this.height}},{key:"cellHieght",set:function(t){this.height=t}}]),i}(),C={getWorldXY:function(t,i,e){void 0===e?e={}:!0===e&&(e=p);var n=t*this.width,r=i*this.height;switch(this.mode){case f:1&i&&(n+=this._halfWidth),r*=.75;break;case d:1&i&&(n-=this._halfWidth),r*=.75;break;case g:n*=.75,1&t&&(r+=this._halfHeight);break;case y:n*=.75,1&t&&(r-=this._halfHeight)}return n+=this.x,r+=this.y,e.x=n,e.y=r,e},getWorldX:function(t,i){return this.getWorldXY(t,i,!0).x},getWorldY:function(t,i){return this.getWorldXY(t,i,!0).y},getTileXY:function(t,i,e){var n,r;switch(void 0===e?e={}:!0===e&&(e=P),t-=this.x,i-=this.y,this.mode){case w:case k:r=i*(4/3)/this.height,n=t/this.width-2/3*(i/this.height);break;case E:case W:r=i/this.height-2/3*(t/this.width),n=t*(4/3)/this.width}var s=function(t,i,e){return void 0===e?e={}:!0===e&&(e=_),e.x=t,e.y=-t-i,e.z=i,e}(n,r,H);return function(t,i,e,n){"number"!=typeof t&&(t=(n=t).x,i=n.y,e=n.z),void 0===n?n={}:!0===n&&(n=_);var r=Math.round(t),s=Math.round(i),o=Math.round(e),h=Math.abs(r-t),u=Math.abs(s-i),a=Math.abs(o-e);u<h&&a<h?r=-s-o:a<u?s=-r-o:o=-r-s,n.x=r,n.y=s,n.z=o}(s),function(t,i,e,n,r){switch(void 0===r?r={}:!0===r&&(r=b),t){case T:r.x=i+(n-(1&n))/2,r.y=n;break;case v:r.x=i+(n+(1&n))/2,r.y=n;break;case O:r.x=i,r.y=n+(i-(1&i))/2;break;case x:r.x=i,r.y=n+(i+(1&i))/2}}(this.mode,s.x,s.y,s.z,e),e},getTileX:function(t,i){return this.getTileXY(t,i,!0).x},getTileY:function(t,i){return this.getTileXY(t,i,!0).y}};Object.assign(R.prototype,C);function N(){}var S={y:0,x:1},F={even:0,odd:1},j=new Phaser.GameObjects.Zone({sys:{queueDepthSort:N,events:{once:N}}},0,0,1,1);j.setOrigin(0);function G(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),$(t,K(i)+e),Q(t,Z(i)+n),t}function B(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),it(t,tt(i)-e),Q(t,Z(i)+n),t}function I(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),nt(t,et(i)+e),Q(t,Z(i)+n),t}function L(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),st(t,K(i)+e,ot(i)+n),t}function D(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),it(t,tt(i)-e),rt(t,ot(i)+n),t}function q(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),nt(t,et(i)+e),rt(t,ot(i)+n),t}function J(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),$(t,K(i)+e),ut(t,ht(i)-n),t}function A(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),it(t,tt(i)-e),ut(t,ht(i)-n),t}function U(t,i,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),nt(t,et(i)+e),ut(t,ht(i)-n),t}var V={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12},Z=function(t){return t.y+t.displayHeight-t.displayHeight*t.originY},K=function(t){return t.x-t.displayWidth*t.originX+.5*t.displayWidth},Q=function(t,i){return t.y=i-t.displayHeight+t.displayHeight*t.originY,t},$=function(t,i){var e=t.displayWidth*t.originX;return t.x=i+e-.5*t.displayWidth,t},tt=function(t){return t.x-t.displayWidth*t.originX},it=function(t,i){return t.x=i+t.displayWidth*t.originX,t},et=function(t){return t.x+t.displayWidth-t.displayWidth*t.originX},nt=function(t,i){return t.x=i-t.displayWidth+t.displayWidth*t.originX,t},rt=function(t,i){var e=t.displayHeight*t.originY;return t.y=i+e-.5*t.displayHeight,t},st=function(t,i,e){return $(t,i),rt(t,e)},ot=function(t){return t.y-t.displayHeight*t.originY+.5*t.displayHeight},ht=function(t){return t.y-t.displayHeight*t.originY},ut=function(t,i){return t.y=i+t.displayHeight*t.originY,t},at=[];at[V.BOTTOM_CENTER]=G,at[V.BOTTOM_LEFT]=B,at[V.BOTTOM_RIGHT]=I,at[V.CENTER]=L,at[V.LEFT_CENTER]=D,at[V.RIGHT_CENTER]=q,at[V.TOP_CENTER]=J,at[V.TOP_LEFT]=A,at[V.TOP_RIGHT]=U;var ct=function(t,i,e,n,r){return at[e](t,i,n,r)},lt=Phaser.Utils.Objects.GetFastValue,ft=new R,dt={},gt={},yt=function(){function i(t){e(this,i),this.resetFromJSON(t)}return t(i,[{key:"resetFromJSON",value:function(t){this.setType(M(t,"type",0)),this.setDirectionMode(M(t,"dir",4)),this.setOriginPosition(M(t,"x",0),M(t,"y",0)),this.setCellSize(M(t,"cellWidth",0),M(t,"cellHeight",0))}},{key:"setType",value:function(t){return"string"==typeof t&&(t=Tt[t]),this.mode=t,this}},{key:"setDirectionMode",value:function(t){return"string"==typeof t&&(t=vt[t]),this.directions=t,this}},{key:"setOriginPosition",value:function(t,i){return this.x=t,this.y=i,this}},{key:"setCellSize",value:function(t,i){return this.width=t,this.height=i,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t}},{key:"cellHeight",get:function(){return this.height}},{key:"cellHieght",set:function(t){this.height=t}}]),i}(),pt={getWorldXY:function(t,i,e){var n,r;switch(void 0===e?e={}:!0===e&&(e=dt),this.mode){case 0:n=t*this.width,r=i*this.height;break;case 1:n=(t-i)*this._halfWidth,r=(t+i)*this._halfHeight}return n+=this.x,r+=this.y,e.x=n,e.y=r,e},getWorldX:function(t,i){return this.getWorldXY(t,i,!0).x},getWorldY:function(t,i){return this.getWorldXY(t,i,!0).y},getTileXY:function(t,i,e){void 0===e?e={}:!0===e&&(e=gt),t-=this.x,i-=this.y;var n=t/this.width,r=i/this.height;switch(this.mode){case 0:e.x=Math.round(n),e.y=Math.round(r);break;case 1:e.x=Math.round(+n+r),e.y=Math.round(r-n)}return e},getTileX:function(t,i){return this.getTileXY(t,i,!0).x},getTileY:function(t,i){return this.getTileXY(t,i,!0).y}};Object.assign(yt.prototype,pt);var Tt={orthogonal:0,isometric:1,staggered:2},vt={"4dir":4,"8dir":8},Ot=Phaser.Utils.Objects.GetFastValue,xt=new yt;return function(){function i(t){return e(this,i),o(this,r(i).call(this,t))}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&s(t,i)}(i,Phaser.Plugins.BasePlugin),t(i,[{key:"start",value:function(){this.game.events.once("destroy",this.destroy,this)}},{key:"hexagon",value:function(t,i){return function(t,i){void 0===i&&(i={});var e=lt(i,"width",-1),n=lt(i,"height",-1),r=lt(i,"cellWidth",1),s=lt(i,"cellHeight",r),o=lt(i,"staggeraxis",1),h=lt(i,"staggerindex",1),u=lt(i,"position",Phaser.Display.Align.CENTER),a=lt(i,"x",0),c=lt(i,"y",0);ft.setOriginPosition(a,c).setCellSize(r,s).setType(o,h),j.setSize(r,s);for(var l=n-1,f=e-1,d=0,g=0,y=0,p=t.length;y<p;y++)if(ft.getWorldXY(g,d,j),ct(t[y],j,u),-1===e)d++;else if(-1===n)g++;else if(g===f){if(d===l)break;g=0,d++}else g++;return t}(t,i)}},{key:"quad",value:function(t,i){return function(t,i){void 0===i&&(i={});var e=Ot(i,"width",-1),n=Ot(i,"height",-1),r=Ot(i,"cellWidth",1),s=Ot(i,"cellHeight",r),o=Ot(i,"type",0),h=Ot(i,"position",Phaser.Display.Align.CENTER),u=Ot(i,"x",0),a=Ot(i,"y",0);xt.setOriginPosition(u,a).setCellSize(r,s).setType(o),j.setSize(r,s);for(var c=n-1,l=e-1,f=0,d=0,g=0,y=t.length;g<y;g++)if(xt.getWorldXY(d,f,j),ct(t[g],j,h),-1===e)f++;else if(-1===n)d++;else if(d===l){if(f===c)break;d=0,f++}else d++;return t}(t,i)}}]),i}()});
