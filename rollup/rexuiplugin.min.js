!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexuiplugin=e()}(this,function(){"use strict";function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_(t):e}function a(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}function d(t,e,i){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=a(t,e);if(n){var s=Object.getOwnPropertyDescriptor(n,e);return s.get?s.get.call(i):s.value}})(t,e,i||t)}function r(t,e,i,n){return(r="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,i,n){var s,r=a(t,e);if(r){if((s=Object.getOwnPropertyDescriptor(r,e)).set)return s.set.call(n,i),!0;if(!s.writable)return!1}if(s=Object.getOwnPropertyDescriptor(n,e)){if(!s.writable)return!1;s.value=i,Object.defineProperty(n,e,s)}else o(n,e,i);return!0})(t,e,i,n)}function s(t,e,i,n,s){if(!r(t,e,i,n||t)&&s)throw new Error("failed to set property");return i}function h(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(t,e,i){var n=i.length;if(2<=n){var s=i[n-2],r=i[n-1];if(t===s&&e===r)return i}return i.push(t,e),i}function l(t,e,i,n,s,r,o,a){var h,l,u,c=w(i,"x",i),d=w(i,"y",i);r&&(s+=360),n=b(n);for(var f=((s=b(s))-n)/o,v=0;v<=o;v++)u=n+f*v,h=t+c*Math.cos(u),l=e+d*Math.sin(u),p(h,l,a);return a}var c=function(){function i(t){M(this,i),this.scene=t}return v(i,null,[{key:"register",value:function(t,e){i.prototype[t]=e}}]),i}(),f=Phaser.Utils.Objects.GetValue,g=function(){function r(t,e,i,n,s){M(this,r),this.cornerRadius={},this._width=0,this._height=0,this.setTo(t,e,i,n,s)}return v(r,[{key:"setTo",value:function(t,e,i,n,s){return this.setPosition(t,e),this.setRadius(s),this.setSize(i,n),this}},{key:"setPosition",value:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}},{key:"setRadius",value:function(t){var e,i;void 0===t&&(t=0),i="number"==typeof t?e=t:(e=f(t,"x",0),f(t,"y",0));var n=this.cornerRadius;return n.tl=m(f(t,"tl",void 0),e,i),n.tr=m(f(t,"tr",void 0),e,i),n.bl=m(f(t,"bl",void 0),e,i),n.br=m(f(t,"br",void 0),e,i),this}},{key:"setSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"minWidth",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}},{key:"minHeight",get:function(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}},{key:"width",get:function(){return this._width},set:function(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}},{key:"height",get:function(){return this._height},set:function(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}},{key:"radius",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}}]),r}(),m=function(t,e,i){return void 0===t?{x:e,y:i}:"number"==typeof t?{x:t,y:t}:t},k=Math.PI/180,b=function(t){return t*k},w=Phaser.Utils.Objects.GetValue,C=t;function t(t,e,i){i=i||2;var n,s,r,o,a,h,l,u=e&&e.length,c=u?e[0]*i:t.length,d=S(t,0,c,i,!0),f=[];if(!d||d.next===d.prev)return f;if(u&&(d=function(t,e,i,n){var s,r,o,a,h,l=[];for(s=0,r=e.length;s<r;s++)o=e[s]*n,a=s<r-1?e[s+1]*n:t.length,(h=S(t,o,a,n,!1))===h.next&&(h.steiner=!0),l.push(L(h));for(l.sort(R),s=0;s<l.length;s++)B(l[s],i),i=O(i,i.next);return i}(t,e,d,i)),t.length>80*i){n=r=t[0],s=o=t[1];for(var v=i;v<c;v+=i)(a=t[v])<n&&(n=a),(h=t[v+1])<s&&(s=h),r<a&&(r=a),o<h&&(o=h);l=0!==(l=Math.max(r-n,o-s))?1/l:0}return T(d,f,i,n,s,l),f}function S(t,e,i,n,s){var r,o;if(s===0<J(t,e,i,n))for(r=e;r<i;r+=n)o=G(r,t[r],t[r+1],o);else for(r=i-n;e<=r;r-=n)o=G(r,t[r],t[r+1],o);return o&&V(o,o.next)&&(U(o),o=o.next),o}function O(t,e){if(!t)return t;e=e||t;var i,n=t;do{if(i=!1,n.steiner||!V(n,n.next)&&0!==F(n.prev,n,n.next))n=n.next;else{if(U(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function T(t,e,i,n,s,r,o){if(t){!o&&r&&function(t,e,i,n){var s=t;for(;null===s.z&&(s.z=Y(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next,s!==t;);s.prevZ.nextZ=null,s.prevZ=null,function(t){var e,i,n,s,r,o,a,h,l=1;do{for(i=t,r=t=null,o=0;i;){for(o++,n=i,e=a=0;e<l&&(a++,n=n.nextZ);e++);for(h=l;0<a||0<h&&n;)0!==a&&(0===h||!n||i.z<=n.z)?(i=(s=i).nextZ,a--):(n=(s=n).nextZ,h--),r?r.nextZ=s:t=s,s.prevZ=r,r=s;i=n}r.nextZ=null,l*=2}while(1<o)}(s)}(t,n,s,r);for(var a,h,l=t;t.prev!==t.next;)if(a=t.prev,h=t.next,r?j(t,n,s,r):P(t))e.push(a.i/i),e.push(t.i/i),e.push(h.i/i),U(t),t=h.next,l=h.next;else if((t=h)===l){o?1===o?T(t=D(t,e,i),e,i,n,s,r,2):2===o&&z(t,e,i,n,s,r):T(O(t),e,i,n,s,r,1);break}}}function P(t){var e=t.prev,i=t,n=t.next;if(0<=F(e,i,n))return!1;for(var s=t.next.next;s!==t.prev;){if(H(e.x,e.y,i.x,i.y,n.x,n.y,s.x,s.y)&&0<=F(s.prev,s,s.next))return!1;s=s.next}return!0}function j(t,e,i,n){var s=t.prev,r=t,o=t.next;if(0<=F(s,r,o))return!1;for(var a=s.x<r.x?s.x<o.x?s.x:o.x:r.x<o.x?r.x:o.x,h=s.y<r.y?s.y<o.y?s.y:o.y:r.y<o.y?r.y:o.y,l=s.x>r.x?s.x>o.x?s.x:o.x:r.x>o.x?r.x:o.x,u=s.y>r.y?s.y>o.y?s.y:o.y:r.y>o.y?r.y:o.y,c=Y(a,h,e,i,n),d=Y(l,u,e,i,n),f=t.prevZ,v=t.nextZ;f&&f.z>=c&&v&&v.z<=d;){if(f!==t.prev&&f!==t.next&&H(s.x,s.y,r.x,r.y,o.x,o.y,f.x,f.y)&&0<=F(f.prev,f,f.next))return!1;if(f=f.prevZ,v!==t.prev&&v!==t.next&&H(s.x,s.y,r.x,r.y,o.x,o.y,v.x,v.y)&&0<=F(v.prev,v,v.next))return!1;v=v.nextZ}for(;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&H(s.x,s.y,r.x,r.y,o.x,o.y,f.x,f.y)&&0<=F(f.prev,f,f.next))return!1;f=f.prevZ}for(;v&&v.z<=d;){if(v!==t.prev&&v!==t.next&&H(s.x,s.y,r.x,r.y,o.x,o.y,v.x,v.y)&&0<=F(v.prev,v,v.next))return!1;v=v.nextZ}return!0}function D(t,e,i){var n=t;do{var s=n.prev,r=n.next.next;!V(s,r)&&X(s,n,n.next,r)&&W(s,r)&&W(r,s)&&(e.push(s.i/i),e.push(n.i/i),e.push(r.i/i),U(n),U(n.next),n=t=r),n=n.next}while(n!==t);return n}function z(t,e,i,n,s,r){var o,a,h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&(a=l,(o=h).next.i!==a.i&&o.prev.i!==a.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&X(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(o,a)&&W(o,a)&&W(a,o)&&function(t,e){var i=t,n=!1,s=(t.x+e.x)/2,r=(t.y+e.y)/2;for(;i.y>r!=i.next.y>r&&i.next.y!==i.y&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next,i!==t;);return n}(o,a))){var u=A(h,l);return h=O(h,h.next),u=O(u,u.next),T(h,e,i,n,s,r),void T(u,e,i,n,s,r)}l=l.next}h=h.next}while(h!==t)}function R(t,e){return t.x-e.x}function B(t,e){if(e=function(t,e){var i,n=e,s=t.x,r=t.y,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=s&&o<a){if((o=a)===s){if(r===n.y)return n;if(r===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(s===o)return i.prev;var h,l=i,u=i.x,c=i.y,d=1/0;n=i.next;for(;n!==l;)s>=n.x&&n.x>=u&&s!==n.x&&H(r<c?s:o,r,u,c,r<c?o:s,r,n.x,n.y)&&((h=Math.abs(r-n.y)/(s-n.x))<d||h===d&&n.x>i.x)&&W(n,t)&&(i=n,d=h),n=n.next;return i}(t,e)){var i=A(e,t);O(i,i.next)}}function Y(t,e,i,n,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function L(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!==t;);return i}function H(t,e,i,n,s,r,o,a){return 0<=(s-o)*(e-a)-(t-o)*(r-a)&&0<=(t-o)*(n-a)-(i-o)*(e-a)&&0<=(i-o)*(r-a)-(s-o)*(n-a)}function F(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function V(t,e){return t.x===e.x&&t.y===e.y}function X(t,e,i,n){return!!(V(t,e)&&V(i,n)||V(t,n)&&V(i,e))||0<F(t,e,i)!=0<F(t,e,n)&&0<F(i,n,t)!=0<F(i,n,e)}function W(t,e){return F(t.prev,t,t.next)<0?0<=F(t,e,t.next)&&0<=F(t,t.prev,e):F(t,e,t.prev)<0||F(t,t.next,e)<0}function A(t,e){var i=new N(t.i,t.x,t.y),n=new N(e.i,e.x,e.y),s=t.next,r=e.prev;return(t.next=e).prev=t,(i.next=s).prev=i,(n.next=i).prev=n,(r.next=n).prev=r,n}function G(t,e,i,n){var s=new N(t,e,i);return n?(s.next=n.next,(s.prev=n).next.prev=s,n.next=s):(s.prev=s).next=s,s}function U(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function N(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function J(t,e,i,n){for(var s=0,r=e,o=i-n;r<i;r+=n)s+=(t[o]-t[r])*(t[r+1]+t[o+1]),o=r;return s}t.deviation=function(t,e,i,n){var s=e&&e.length,r=s?e[0]*i:t.length,o=Math.abs(J(t,0,r,i));if(s)for(var a=0,h=e.length;a<h;a++){var l=e[a]*i,u=a<h-1?e[a+1]*i:t.length;o-=Math.abs(J(t,l,u,i))}var c=0;for(a=0;a<n.length;a+=3){var d=n[a]*i,f=n[a+1]*i,v=n[a+2]*i;c+=Math.abs((t[d]-t[v])*(t[1+f]-t[1+d])-(t[d]-t[f])*(t[1+v]-t[1+d]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},t.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,s=0;s<t.length;s++){for(var r=0;r<t[s].length;r++)for(var o=0;o<e;o++)i.vertices.push(t[s][r][o]);0<s&&(n+=t[s-1].length,i.holes.push(n))}return i};function Z(t,e,i,n,s){var r=this.pipeline,o=r._tempMatrix1,a=r._tempMatrix2,h=r._tempMatrix3;t.setPipeline(r),a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),o.copyFrom(n.matrix),s?(o.multiplyWithOffset(s,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),a.e=e.x,a.f=e.y):(a.e-=n.scrollX*e.scrollFactorX,a.f-=n.scrollY*e.scrollFactorY),o.multiply(a,h);var l=e._displayOriginX,u=e._displayOriginY,c=n.alpha*e.alpha;e.isFilled&&$(r,h,e,c,l,u),e.isStroked&&tt(r,e,c,l,u)}function K(){}var q=Phaser.Renderer.WebGL.Utils,$=function(t,e,i,n,s,r){for(var o=q.getTintAppendFloatAlphaAndSwap(i.fillColor,i.fillAlpha*n),a=i.pathData,h=i.pathIndexes,l=0;l<h.length;l+=3){var u=2*h[l],c=2*h[l+1],d=2*h[l+2],f=a[0+u]-s,v=a[1+u]-r,p=a[0+c]-s,g=a[1+c]-r,y=a[0+d]-s,m=a[1+d]-r,x=e.getX(f,v),k=e.getY(f,v),b=e.getX(p,g),w=e.getY(p,g),C=e.getX(y,m),S=e.getY(y,m);t.setTexture2D(),t.batchTri(x,k,b,w,C,S,0,0,1,1,o,o,o,t.tintEffect)}},Q=Phaser.Renderer.WebGL.Utils,tt=function(t,e,i,n,s){var r=t.strokeTint,o=Q.getTintAppendFloatAlphaAndSwap(e.strokeColor,e.strokeAlpha*i);r.TL=o,r.TR=o,r.BL=o,r.BR=o;var a=e.pathData,h=a.length-1,l=e.lineWidth,u=l/2,c=a[0]-n,d=a[1]-s;e.closePath||(h-=2);for(var f=2;f<h;f+=2){var v=a[f]-n,p=a[f+1]-s;t.setTexture2D(),t.batchLine(c,d,v,p,u,u,l,f-2,!!e.closePath&&f===h-1),c=v,d=p}},et=function(t,e,i,n){var s=i||e.fillColor,r=n||e.fillAlpha,o=(16711680&s)>>>16,a=(65280&s)>>>8,h=255&s;t.fillStyle="rgba("+o+","+a+","+h+","+r+")"},it=function(t,e,i,n){var s=i||e.strokeColor,r=n||e.strokeAlpha,o=(16711680&s)>>>16,a=(65280&s)>>>8,h=255&s;t.strokeStyle="rgba("+o+","+a+","+h+","+r+")",t.lineWidth=e.lineWidth},nt=Phaser.Renderer.Canvas.SetTransform,st=K,rt=K;WEBGL_RENDERER&&(st=Z),CANVAS_RENDERER&&(rt=function(t,e,i,n,s){var r=t.currentContext;if(nt(t,r,e,n,s)){var o=e._displayOriginX,a=e._displayOriginY,h=e.pathData,l=h.length-1,u=h[0]-o,c=h[1]-a;r.beginPath(),r.moveTo(u,c),e.closePath||(l-=2);for(var d=2;d<l;d+=2){var f=h[d]-o,v=h[d+1]-a;r.lineTo(f,v)}r.closePath(),e.isFilled&&(et(r,e),r.fill()),e.isStroked&&(it(r,e),r.stroke()),r.restore()}});var ot={renderWebGL:st,renderCanvas:rt},at=Phaser.Utils.Objects.GetValue,ht=function(){function c(t,e,i,n,s,r,o,a){var h;M(this,c),void 0===e&&(e=0),void 0===i&&(i=0);var l=at(r,"iteration",void 0);r=at(r,"radius",r);var u=new g(0,0,n,s,r);return(h=I(this,E(c).call(this,t,"RoundRectangle",u))).setIteration(l),h.setPosition(e,i),void 0!==o&&h.setFillStyle(o,a),h.updateDisplayOrigin(),h.updateData(),h}return e(c,Phaser.GameObjects.Shape),v(c,[{key:"updateData",value:function(){var t=this.geom,e=this.pathData;e.length=0;var i,n=t.cornerRadius,s=this.iteration+1;if(i=n.br,lt(i)){var r=t.width-i.x,o=t.height-i.y;l(r,o,i,0,90,!1,s,e)}else p(t.width,t.height,e);if(i=n.bl,lt(i)){r=i.x,o=t.height-i.y;l(r,o,i,90,180,!1,s,e)}else p(0,t.height,e);if(i=n.tl,lt(i)){r=i.x,o=i.y;l(r,o,i,180,270,!1,s,e)}else p(0,0,e);if(i=n.tr,lt(i)){r=t.width-i.x,o=i.y;l(r,o,i,270,360,!1,s,e)}else p(t.width,0,e);return e.push(e[0],e[1]),this.pathIndexes=C(e),this}},{key:"resize",value:function(t,e){if(void 0===e&&(e=t),this.geom.width===t&&this.geom.height===e)return this;this.geom.height=e,this.geom.width=t,this.updateDisplayOrigin(),this.updateData();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this}},{key:"setIteration",value:function(t){return void 0===t&&(t=6),this.iteration=t,this}},{key:"setRadius",value:function(t){return void 0===t&&(t=0),this.radius=t,this}},{key:"setCornerRadius",value:function(t){return this.setRadius(t)}},{key:"width",get:function(){return this.geom.width},set:function(t){this.resize(t,this.height)}},{key:"height",get:function(){return this.geom.height},set:function(t){this.resize(this.width,t)}},{key:"iteration",get:function(){return this._iteration},set:function(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.updateData()):this._iteration=t}},{key:"radius",get:function(){return this.geom.radius},set:function(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.updateData()}},{key:"cornerRadius",get:function(){return this.geom.cornerRadius},set:function(t){this.radius=t}}]),c}(),lt=function(t){return 0!==t.x&&0!==t.y};Object.assign(ht.prototype,ot);function ut(t){return null==t||""===t||0===t.length}function ct(t,e,i){if("object"===u(t))if(ut(e)){if(null==i)return;"object"===u(i)&&(t=i)}else{"string"==typeof e&&(e=e.split("."));var n=e.pop();(function(t,e,i){void 0===i&&(i={});var n=t;if(ut(e));else{var s;"string"==typeof e&&(e=e.split("."));for(var r=0,o=e.length;r<o;r++){var a;if(null==n[s=e[r]]||"object"!==u(n[s]))a=r===o-1?i:{},n[s]=a;n=n[s]}}return n})(t,e)[n]=i}}c.register("roundRectangle",function(t,e,i,n,s,r,o){var a=new ht(this.scene,t,e,i,n,s,r,o);return this.scene.add.existing(a),a}),ct(window,"RexPlugins.UI.RoundRectangle",ht);var dt=Phaser.Renderer.WebGL.Utils,ft=K,vt=K;WEBGL_RENDERER&&(ft=function(t,e,i,n,s){if(0!==e.width&&0!==e.height){var r=e.frame,o=r.width,a=r.height,h=dt.getTintAppendFloatAlpha;this.pipeline.batchTexture(e,r.glTexture,o,a,e.x,e.y,o/e.style.resolution,a/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,o,a,h(e._tintTL,n.alpha*e._alphaTL),h(e._tintTR,n.alpha*e._alphaTR),h(e._tintBL,n.alpha*e._alphaBL),h(e._tintBR,n.alpha*e._alphaBR),e._isTinted&&e.tintFill,0,0,n,s)}}),CANVAS_RENDERER&&(vt=function(t,e,i,n,s){0!==e.width&&0!==e.height&&t.batchSprite(e,e.frame,n,s)});function pt(t){var e=kt.create(this),i=e.getContext("2d");t.syncFont(e,i);var n=Math.ceil(i.measureText(t.testString).width*t.baselineX),s=n,r=2*s;s=s*t.baselineY|0,e.width=n,e.height=r,i.fillStyle="#f00",i.fillRect(0,0,n,r),i.font=t._font,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(t.testString,0,s);var o={ascent:0,descent:0,fontSize:0};if(!i.getImageData(0,0,n,r))return o.ascent=s,o.descent=s+6,o.fontSize=o.ascent+o.descent,kt.remove(e),o;var a,h,l=i.getImageData(0,0,n,r).data,u=l.length,c=4*n,d=0,f=!1;for(a=0;a<s;a++){for(h=0;h<c;h+=4)if(255!==l[d+h]){f=!0;break}if(f)break;d+=c}for(o.ascent=s-a,d=u-c,f=!1,a=r;s<a;a--){for(h=0;h<c;h+=4)if(255!==l[d+h]){f=!0;break}if(f)break;d-=c}return o.descent=a-s,o.fontSize=o.ascent+o.descent,kt.remove(e),o}function gt(t){if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e]}function yt(t,e){var i=Array.isArray(t);for(var n in void 0===e?e=i?[]:{}:gt(e),i&&(e.length=t.length),t)e[n]=t[n];return e}function mt(t,e,i,n,s){n<=0&&(i=Qt);var r=ie;if(ne.pushMultiple(r),!t||!t.length)return r;for(var o,a,h,l=t.split(ee),u=0,c=l.length;u<c;u++)if(o=l[u],h=u===c-1?Kt:qt,i!==Qt){var d,f;if(a=0===u?n-s:n,o.length<=100)if((k=e(o))<=a){r.push(ne.newline(o,k,h));continue}for(var v,p="",g="",y=0,m=0,x=(d=i===te?o.split(" "):o).length;m<x;m++)f=d[m],i===te?(p+=f,m<x-1&&(p+=" ")):p+=f,a<(v=e(p))&&(0===m?r.push(ne.newline("",0,$t)):(r.push(ne.newline(g,y,$t)),p=f,i===te&&m<x-1&&(p+=" "),v=e(p)),a=n),g=p,y=v;r.push(ne.newline(g,y,h))}else{var k=e(o);r.push(ne.newline(o,k,h))}return r}var xt={renderWebGL:ft,renderCanvas:vt},kt=Phaser.Display.Canvas.CanvasPool,bt=0,wt=1,Ct=2,St=0,Ot=1,Tt=2,Pt=/(?:\r\n|\r|\n)/,Mt=Phaser.Utils.Objects.GetAdvancedValue,Et=Phaser.Utils.Objects.GetValue,_t={backgroundColor:["backgroundColor",null],fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],underlineColor:["underline.color","#000"],underlineThickness:["underline.thickness",0],underlineOffset:["underline.offset",0],halign:["halign","left"],valign:["valign","top"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],lineSpacing:["lineSpacing",0],rtl:["rtl",!1],testString:["testString","|MÃ‰qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wrapMode:["wrap.mode",1],wrapWidth:["wrap.width",0]},It=function(){function n(t,e){M(this,n),this.parent=t,this.backgroundColor,this.fontFamily,this.fontSize,this.fontStyle,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.underlineColor,this.underlineThickness,this.underlineOffset,this.halign,this.valign,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.lineSpacing,this.rtl,this.testString,this.baselineX,this.baselineY,this._font,this.setStyle(e,!1);var i=Et(e,"metrics",!1);this.metrics=i?{ascent:Et(i,"ascent",0),descent:Et(i,"descent",0),fontSize:Et(i,"fontSize",0)}:pt(this)}return v(n,[{key:"setStyle",value:function(t,e){if(void 0===e&&(e=!0),t&&t.hasOwnProperty("wrap")){var i=t.wrap;if(i.hasOwnProperty("mode")){var n=i.mode;"string"==typeof n&&(i.mode=jt[n])}else i.hasOwnProperty("width")&&(i.mode=1)}for(var s in t&&t.hasOwnProperty("fontSize")&&"number"==typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),_t)this[s]="wrapCallback"===s||"wrapCallbackScope"===s?Et(t,_t[s][0],_t[s][1]):Mt(t,_t[s][0],_t[s][1]);var r=Et(t,"font",null);this._font=null===r?this.fontStyle+" "+this.fontSize+" "+this.fontFamily:r;var o=Et(t,"fill",null);return null!==o&&(this.color=o),e?this.update(!0):this.parent}},{key:"syncFont",value:function(t,e){e.font=this._font}},{key:"syncStyle",value:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"}},{key:"syncShadow",value:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)}},{key:"update",value:function(t){return t&&(this._font=this.fontStyle+" "+this.fontSize+" "+this.fontFamily,this.metrics=pt(this)),this.parent.updateText(t)}},{key:"buildFont",value:function(){var t=this.fontStyle+" "+this.fontSize+" "+this.fontFamily;return t!==this._font&&(this._font=t),this}},{key:"setFont",value:function(t){return"string"==typeof t?(this.fontFamily=t,this.fontSize="",this.fontStyle=""):(this.fontFamily=Et(t,"fontFamily","Courier"),this.fontSize=Et(t,"fontSize","16px"),this.fontStyle=Et(t,"fontStyle","")),this.update(!0)}},{key:"setFontFamily",value:function(t){return this.fontFamily=t,this.update(!0)}},{key:"setFontStyle",value:function(t){return this.fontStyle=t,this.update(!0)}},{key:"setFontSize",value:function(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize=t,this.update(!0)}},{key:"setTestString",value:function(t){return this.testString=t,this.update(!0)}},{key:"setFixedSize",value:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)}},{key:"setResolution",value:function(t){return this.resolution=t,this.update(!1)}},{key:"setLineSpacing",value:function(t){return this.lineSpacing=t,this.update(!1)}},{key:"setBackgroundColor",value:function(t){return this.backgroundColor=t,this.update(!1)}},{key:"setFill",value:function(t){return this.color=t,this.update(!1)}},{key:"setColor",value:function(t){return this.color=t,this.update(!1)}},{key:"setStroke",value:function(t,e){return void 0===t?this.strokeThickness=0:(void 0===e&&(e=this.strokeThickness),this.stroke=t,this.strokeThickness=e),this.update(!0)}},{key:"setShadow",value:function(t,e,i,n,s,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="#000"),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===r&&(r=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=i,this.shadowBlur=n,this.shadowStroke=s,this.shadowFill=r,this.update(!1)}},{key:"setShadowOffset",value:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)}},{key:"setShadowColor",value:function(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)}},{key:"setShadowBlur",value:function(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)}},{key:"setShadowStroke",value:function(t){return this.shadowStroke=t,this.update(!1)}},{key:"setShadowFill",value:function(t){return this.shadowFill=t,this.update(!1)}},{key:"setUnderline",value:function(t,e,i){return void 0===t&&(t="#000"),void 0===e&&(e=0),void 0===i&&(i=0),this.underlineColor=t,this.underlineThickness=e,this.underlineOffset=i,this.update(!1)}},{key:"setUnderlineColor",value:function(t){return void 0===t&&(t="#000"),this.underlineColor=t,this.update(!1)}},{key:"setUnderlineThickness",value:function(t){return void 0===t&&(t=0),this.underlineThickness=t,this.update(!1)}},{key:"setUnderlineOffset",value:function(t){return void 0===t&&(t=0),this.underlineOffset=t,this.update(!1)}},{key:"setWrapMode",value:function(t){return"string"==typeof t&&(t=jt[t.toLowerCase()]||0),this.wrapMode=t,this.update(!0)}},{key:"setWrapWidth",value:function(t){return this.wrapWidth=t,this.update(!1)}},{key:"setAlign",value:function(t,e){return void 0===t&&(t="left"),void 0===e&&(e="top"),this.halign=t,this.valign=e,this.update(!1)}},{key:"setHAlign",value:function(t){return void 0===t&&(t="left"),this.halign=t,this.update(!1)}},{key:"setVAlign",value:function(t){return void 0===t&&(t="top"),this.valign=t,this.update(!1)}},{key:"setMaxLines",value:function(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)}},{key:"getTextMetrics",value:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}}},{key:"toJSON",value:function(){var t={};for(var e in _t)t[e]=this[e];return t.metrics=this.getTextMetrics(),t}},{key:"destroy",value:function(){this.parent=void 0}},{key:"lineHeight",get:function(){return this.metrics.fontSize+this.strokeThickness+this.lineSpacing}}]),n}(),jt={none:St,word:Ot,char:Tt,character:Tt},Dt={draw:function(t,e,i,n){var s=this.penManager;this.hitAreaManager.clear();var r=this.context;r.save(),this.drawBackground(this.defatultStyle.backgroundColor);var o=this.defatultStyle;t+=this.startXOffset,e+=this.startYOffset;var a,h,l,u,c,d,f=o.halign,v=o.valign,p=o.lineHeight,g=s.lines,y=g.length,m=o.maxLines;u=(l=0<m&&m<y?(h=m,"center"===v?Math.floor((y-h)/2):"bottom"===v?y-h:0):(h=y,0))+h,d="center"===v?Math.max((n-h*p)/2,0):"bottom"===v?Math.max(n-h*p-2,0):0,d+=e;for(var x=l;x<u;x++)if(0!==(a=s.getLineWidth(x))){c="center"===f?(i-a)/2:"right"===f?i-a:0,c+=t;for(var k=g[x],b=0,w=k.length;b<w;b++)this.drawPen(k[b],c,d)}r.restore()},drawPen:function(t,e,i){e+=t.x,i+=t.y;var n=this.canvas,s=this.context;s.save();var r=this.parser.propToContextStyle(this.defatultStyle,t.prop);r.buildFont(),r.syncFont(n,s),r.syncStyle(n,s),0<r.underlineThickness&&0<t.width&&this.drawUnderline(e,i,t.width,r),t.isTextPen&&this.drawText(e,i,t.text,r),t.isImagePen&&this.drawImage(e,i,t.prop.img,r),s.restore(),t.hasAreaMarker&&0<t.width&&this.hitAreaManager.add(t.prop.area,e,i-this.startYOffset,t.width,this.defatultStyle.lineHeight)},clear:function(){var t=this.canvas;this.context.clearRect(0,0,t.width,t.height)},drawBackground:function(t){null!==t&&(this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height))},drawUnderline:function(t,e,i,n){e+=n.underlineOffset-n.underlineThickness/2,this.autoRound&&(t=Math.round(t),e=Math.round(e));var s=this.context,r=s.lineCap;s.lineCap="butt",s.beginPath(),s.strokeStyle=n.underlineColor,s.lineWidth=n.underlineThickness,s.moveTo(t,e),s.lineTo(t+i,e),s.stroke(),s.lineCap=r},drawText:function(t,e,i,n){this.autoRound&&(t=Math.round(t),e=Math.round(e));var s=this.context;n.strokeThickness&&(n.syncShadow(s,n.shadowStroke),s.strokeText(i,t,e)),n.color&&"none"!==n.color&&(n.syncShadow(s,n.shadowFill),s.fillText(i,t,e))},drawImage:function(t,e,i,n){var s=this.parent.imageManager,r=s.get(i),o=s.getFrame(i);t+=r.left,e+=-this.startYOffset+r.y,this.autoRound&&(t=Math.round(t),e=Math.round(e)),this.context.drawImage(o.source.image,o.cutX,o.cutY,o.cutWidth,o.cutHeight,t,e,r.width,r.height)}},zt=function(){function t(){M(this,t),this.items=[]}return v(t,[{key:"destroy",value:function(){this.items.length=0,this.items=void 0}},{key:"pop",value:function(){return 0<this.items.length?this.items.pop():null}},{key:"push",value:function(t){return this.items.push(t),this}},{key:"pushMultiple",value:function(t){return this.items.push.apply(this.items,t),t.length=0,this}}]),t}(),Rt=Phaser.Utils.Objects.GetValue,Bt=bt,Yt=wt,Lt=function(){function e(t){M(this,e),this.prop={},this.resetFromJSON(t)}return v(e,[{key:"resetFromJSON",value:function(t){this.text=Rt(t,"text",""),this.x=Rt(t,"x",0),this.y=Rt(t,"y",0),this.width=Rt(t,"width",0);var e=Rt(t,"prop",null);null===e&&(e={}),this.prop=e,this.newLineMode=Rt(t,"newLineMode",0),this.startIndex=Rt(t,"startIndex",0)}},{key:"plainText",get:function(){var t=this.text;return this.newLineMode===Yt&&(t+="\n"),t}},{key:"wrapText",get:function(){var t=this.text;return this.newLineMode!==Bt&&(t+="\n"),t}},{key:"rawTextLength",get:function(){var t=this.text.length;return this.newLineMode===Yt&&(t+=1),t}},{key:"endIndex",get:function(){return this.startIndex+this.rawTextLength}},{key:"lastX",get:function(){return this.x+this.width}},{key:"isTextPen",get:function(){return""!==this.text}},{key:"isImagePen",get:function(){return!!this.prop.img}},{key:"hasAreaMarker",get:function(){return!!this.prop.area}}]),e}(),Ht=Phaser.Utils.Objects.GetFastValue,Ft=bt,Vt=Ct,Xt=new zt,Wt=new zt,At=function(){function a(t){M(this,a),this.pens=[],this.lines=[],this.maxLinesWidth=void 0,this.PensPool=Ht(t,"pensPool",Xt),this.LinesPool=Ht(t,"linesPool",Wt),this.tagToText=Ht(t,"tagToText",K),this.tagToTextScope=Ht(t,"tagToTextScope",void 0)}return v(a,[{key:"destroy",value:function(){this.freePens(),this.tagToText=void 0,this.tagToTextScope=void 0}},{key:"freePens",value:function(){for(var t=0,e=this.lines.length;t<e;t++)this.lines[t].length=0;this.PensPool.pushMultiple(this.pens),this.LinesPool.pushMultiple(this.lines),this.maxLinesWidth=void 0}},{key:"addTextPen",value:function(t,e,i,n,s,r){var o=this.PensPool.pop();return null==o&&(o=new Lt),Gt.text=t,Gt.x=e,Gt.y=i,Gt.width=n,Gt.prop=s,Gt.newLineMode=r,o.resetFromJSON(Gt),this.addPen(o),this}},{key:"addImagePen",value:function(t,e,i,n){return this.addTextPen("",t,e,i,n,Ft),this}},{key:"addNewLinePen",value:function(){var t=this.lastPen,e=t?t.lastX:0,i=t?t.y:0,n=t?yt(t.prop):null;return this.addTextPen("",e,i,0,n,Vt),this}},{key:"addPen",value:function(t){var e=this.lastPen;t.startIndex=null==e?0:e.endIndex,this.pens.push(t);var i=this.lastLine;null==i&&(i=this.LinesPool.pop()||[],this.lines.push(i)),i.push(t),t.newLineMode!==Ft&&(i=this.LinesPool.pop()||[],this.lines.push(i)),this.maxLinesWidth=void 0}},{key:"clone",value:function(t){null==t&&(t=new a),t.freePens();for(var e=0,i=this.lines.length;e<i;e++)for(var n=this.lines[e],s=0,r=n.length;s<r;s++){var o=n[s];t.addPen(o.text,o.x,o.y,o.width,yt(o.prop),o.newLineMode)}return t}},{key:"getLineStartIndex",value:function(t){if(t>=this.lines.length)return this.getLineEndIndex(t);var e=this.lines[t];return e&&e[0]?e[0].startIndex:0}},{key:"getLineEndIndex",value:function(t){t>=this.lines.length&&(t=this.lines.length-1);var e,i,n=!1;for(e=t;0<=e&&!(n=null!=(i=this.lines[e])&&0<i.length);e--);return n?i[i.length-1].endIndex:0}},{key:"getLineWidth",value:function(t){var e=this.lines[t];if(!e)return 0;var i=e[e.length-1];return null==i?0:i.lastX}},{key:"getMaxLineWidth",value:function(){if(void 0!==this.maxLinesWidth)return this.maxLinesWidth;for(var t,e=0,i=0,n=this.lines.length;i<n;i++)e<(t=this.getLineWidth(i))&&(e=t);return this.maxLinesWidth=e}},{key:"getLineWidths",value:function(){for(var t=[],e=0,i=this.lines.length;e<i;e++)t.push(this.getLineWidth(e));return t}},{key:"getSliceTagText",value:function(t,e,i){if(void 0===t&&(t=0),void 0===e){var n=this.lastPen;if(null==n)return"";e=n.endIndex}void 0===i&&(i=!1);for(var s,r,o,a,h,l,u="",c=0,d=this.pens.length;c<d&&((a=(s=this.pens[c]).endIndex)<=t||(s=this.pens[c],r=i?s.wrapText:s.plainText,h=s.prop,t<=(o=s.startIndex)&&a<=e||(r=r.substring(t-o,e-o)),this.tagToTextScope?u+=this.tagToText.call(this.tagToTextScope,r,h,l):u+=this.tagToText(r,h,l),l=h,!(e<=a)));c++);return u}},{key:"lastPen",get:function(){return this.pens[this.pens.length-1]}},{key:"lastLine",get:function(){return this.lines[this.lines.length-1]}},{key:"linesCount",get:function(){return this.lines.length}},{key:"plainText",get:function(){for(var t="",e=this.pens,i=0,n=e.length;i<n;i++)t+=e[i].plainText;return t}},{key:"rawTextLength",get:function(){for(var t=0,e=this.pens,i=0,n=this.pens.length;i<n;i++)t+=e[i].rawTextLength;return t}}]),a}(),Gt={},Ut=Phaser.Geom.Rectangle,Nt=new zt,Jt=function(){function t(){M(this,t),this.hitAreas=[]}return v(t,[{key:"destroy",value:function(){this.clear()}},{key:"clear",value:function(){return Nt.pushMultiple(this.hitAreas),this}},{key:"add",value:function(t,e,i,n,s){var r=Nt.pop();return null===r?r=new Ut(e,i,n,s):r.setTo(e,i,n,s),r.key=t,this.hitAreas.push(r),this}},{key:"contains",value:function(t,e){for(var i,n=this.hitAreas,s=0,r=n.length;s<r;s++)if((i=n[s]).contains(t,e))return i.key;return!1}},{key:"drawBounds",value:function(t,e,i){void 0===e&&(e=16777215),i&&t.save().scaleCanvas(i.scaleX,i.scaleY).rotateCanvas(i.rotation).translateCanvas(i.x,i.y);for(var n,s=this.hitAreas,r=0,o=s.length;r<o;r++)n=s[r],t.lineStyle(1,e).strokeRect(n.x,n.y,n.width,n.height);return i&&t.restore(),this}}]),t}(),Zt=function(t,e,i,n){var s=this.hitAreaManager.contains(i,n);!1!==s&&(this.parent.emit("".concat(t,"-").concat(s),e,i,n),this.parent.emit(t,s,e,i,n))},Kt=bt,qt=wt,$t=Ct,Qt=St,te=Ot,ee=Pt,ie=[],ne=new zt;ne.newline=function(t,e,i){var n=this.pop();return null===n&&(n={}),n.text=t,n.width=e,n.newLineMode=i,n};var se=Phaser.Utils.Objects.GetValue,re=St,oe=bt,ae=function(){function i(t){M(this,i),this.parent=t.parent,this.context=se(t,"context",null),this.canvas=this.context.canvas,this.parser=se(t,"parser",null),this.defatultStyle=se(t,"style",null),this.autoRound=!0,this.pensPool=se(t,"pensPool",null),this.penManager=this.newPenManager(),this._tmpPenManager=null,this.hitAreaManager=new Jt;var e=this.context;this.getTextWidth=function(t){return e.measureText(t).width}}return v(i,[{key:"destroy",value:function(){this.context=void 0,this.canvas=void 0,this.parser=void 0,this.defatultStyle=void 0,this.penManager&&(this.penManager.destroy(),this.penManager=void 0),this._tmpPenManager&&(this._tmpPenManager.destroy(),this._tmpPenManager=void 0),this.hitAreaManager&&(this.hitAreaManager.destroy(),this.hitAreaManager=void 0)}},{key:"updatePenManager",value:function(t,e,i,n,s){if(void 0===s&&(s=this.penManager),s.freePens(),""===t)return s;for(var r,o,a,h,l,u=this.canvas,c=this.context,d=0,f=0,v=this.parser.splitText(t),p=0,g=v.length;p<g;p++)if(r=(h=this.parser.tagTextToProp(v[p],o)).plainText,(o=h.prop).img){var y=this.imageManager.getOuterWidth(o.img);0<i&&e!==re&&i<d+y&&(s.addNewLinePen(),f+=n,d=0),s.addImagePen(d,f,y,yt(o)),d+=y}else if(""!==r){var m;this.context.save(),(a=this.parser.propToContextStyle(this.defatultStyle,o)).buildFont(),a.syncFont(u,c),a.syncStyle(u,c);for(var x=0,k=(l=mt(r,this.getTextWidth,e,i,d)).length;x<k;x++)m=l[x],s.addTextPen(m.text,d,f,m.width,yt(o),m.newLineMode),m.newLineMode!==oe?(d=0,f+=n):d+=m.width;this.context.restore()}return s}},{key:"newPenManager",value:function(){return new At({pensPool:this.pensPool,tagToText:this.parser.propToTagText,tagToTextScope:this.parser})}},{key:"getPlainText",value:function(t,e,i){var n;if(null==t)n=this.penManager.plainText;else{var s=this.parser.splitText(t,1);n="";for(var r=0,o=s.length;r<o;r++)n+=s[r]}return null==e&&null==i||(null==e&&(e=0),null==i&&(i=n.length),n=n.substring(e,i)),n}},{key:"getPenManager",value:function(t,e){if(void 0===t)return this.copyPenManager(e,this.penManager);void 0===e&&(e=this.newPenManager());var i=this.defatultStyle;return this.updatePenManager(t,i.wrapMode,i.wrapWidth,i.lineHeight,e),e}},{key:"getText",value:function(t,e,i,n){if(null==t)return this.penManager.getSliceTagText(e,i,n);var s=this.tmpPenManager,r=this.defatultStyle;return this.updatePenManager(t,r.wrapMode,r.wrapWidth,r.lineHeight,s),s.getSliceTagText(e,i,n)}},{key:"copyPenManager",value:function(t,e){return void 0===e&&(e=this.penManager),e.copy(t)}},{key:"getTextWidth",value:function(t){return void 0===t&&(t=this.penManager),t.getMaxLineWidth()}},{key:"getLastPen",value:function(t){return void 0===t&&(t=this.penManager),t.lastPen}},{key:"startXOffset",get:function(){return this.defatultStyle.strokeThickness/2}},{key:"startYOffset",get:function(){var t=this.defatultStyle;return t.strokeThickness/2+t.metrics.ascent}},{key:"lines",get:function(){return this.penManager.lines}},{key:"desplayLinesCount",get:function(){var t=this.penManager.linesCount,e=this.defatultStyle.maxLines;return 0<e&&e<t&&(t=e),t}},{key:"linesWidth",get:function(){return this.penManager.getMaxLineWidth()}},{key:"linesHeight",get:function(){var t=this.desplayLinesCount,e=this.defatultStyle.lineHeight*t;return 0<t&&(e-=this.defatultStyle.lineSpacing),e}},{key:"imageManager",get:function(){return this.parent.imageManager}},{key:"tmpPenManager",get:function(){return null===this._tmpPenManager&&(this._tmpPenManager=this.newPenManager()),this._tmpPenManager}}]),i}(),he={setInteractive:function(){this.parent.on("pointerdown",function(t,e,i,n){Zt.call(this,"areadown",t,e,i)},this).on("pointerup",function(t,e,i,n){Zt.call(this,"areaup",t,e,i)},this)}};Object.assign(ae.prototype,Dt,he);var le,ue=Phaser.Utils.Objects.GetValue,ce=function(){function e(t){M(this,e),this.textureManager=t,this.images={}}return v(e,[{key:"add",value:function(t,e){if("string"==typeof t)this._add(t,e);else if(Array.isArray(t))for(var i=0,n=(s=t).length;i<n;i++)this._add(s[i]);else{var s=t;for(var t in s)this._add(t,s[t])}return this}},{key:"_add",value:function(t,e){void 0===e&&(e={key:t});var i=e.key,n=e.frame,s=e.width,r=e.height;if(void 0===s||void 0===r){var o=this.textureManager.getFrame(i,n),a=o?o.cutWidth:0,h=o?o.cutHeight:0;void 0===s&&void 0===r?(s=a,r=h):void 0===s?s=a*(r/h):void 0===r&&(r=h*(s/a))}this.images[t]={key:i,frame:n,width:s,height:r,y:ue(e,"y",0),left:ue(e,"left",0),right:ue(e,"right",0)}}},{key:"remove",value:function(t){return this.images.hasOwnProperty(t)&&delete this.images[t],this}},{key:"get",value:function(t){return this.images.hasOwnProperty(t)||this.textureManager.exists(t)&&this.add(t),this.images[t]}},{key:"getOuterWidth",value:function(t){var e=this.get(t);return e?e.width+e.left+e.right:0}},{key:"getFrame",value:function(t){var e=this.get(t);return e?this.textureManager.getFrame(e.key,e.frame):void 0}},{key:"hasTexture",value:function(t){return!!this.getFrame(t)}}]),e}();var de=Phaser.DOM.AddToDOM,fe=Phaser.Display.Canvas.CanvasPool,ve=Phaser.GameObjects.GameObject,pe=Phaser.Utils.Objects.GetValue,ge=Phaser.DOM.RemoveFromDOM,ye=Pt,me={},xe=function(){function l(t,e,i,n,s,r,o){var a;if(M(this,l),void 0===e&&(e=0),void 0===i&&(i=0),(a=I(this,E(l).call(this,t,r))).renderer=t.sys.game.renderer,a.setPosition(e,i),a.setOrigin(0,0),a.initPipeline(),a.canvas=fe.create(_(a)),a.context=a.canvas.getContext("2d"),s&&s.hasOwnProperty("align")){var h=s.align;delete s.align,s.halign=h}return a.style=new It(_(a),s),a.autoRound=!0,a._text=void 0,a.padding={left:0,right:0,top:0,bottom:0},a.width=1,a.height=1,a.dirty=!1,0===a.style.resolution&&(a.style.resolution=t.sys.game.config.resolution),a._crop=a.resetCropObject(),a.texture=t.sys.textures.addCanvas(null,a.canvas,!0),a.frame=a.texture.get(),a.frame.source.resolution=a.style.resolution,a.renderer&&a.renderer.gl&&(a.renderer.deleteTexture(a.frame.source.glTexture),a.frame.source.glTexture=null),me.hasOwnProperty(r)||(me[r]=new zt),a.canvasText=new ae({parent:_(a),context:a.context,parser:o,style:a.style,pensPool:me[r]}),s&&s.padding&&a.setPadding(s.padding),a.setText(n),t.sys.game.events.on("contextrestored",function(){this.dirty=!0},_(a)),a}return e(l,ve),v(l,[{key:"initRTL",value:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",de(this.canvas,this.scene.sys.canvas),this.originX=1)}},{key:"setText",value:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this}},{key:"setStyle",value:function(t){return this.style.setStyle(t)}},{key:"setFont",value:function(t){return this.style.setFont(t)}},{key:"setFontFamily",value:function(t){return this.style.setFontFamily(t)}},{key:"setFontSize",value:function(t){return this.style.setFontSize(t)}},{key:"setFontStyle",value:function(t){return this.style.setFontStyle(t)}},{key:"setFixedSize",value:function(t,e){return this.style.setFixedSize(t,e)}},{key:"setBackgroundColor",value:function(t){return this.style.setBackgroundColor(t)}},{key:"setFill",value:function(t){return this.style.setFill(t)}},{key:"setColor",value:function(t){return this.style.setColor(t)}},{key:"setStroke",value:function(t,e){return this.style.setStroke(t,e)}},{key:"setShadow",value:function(t,e,i,n,s,r){return this.style.setShadow(t,e,i,n,s,r)}},{key:"setShadowOffset",value:function(t,e){return this.style.setShadowOffset(t,e)}},{key:"setShadowColor",value:function(t){return this.style.setShadowColor(t)}},{key:"setShadowBlur",value:function(t){return this.style.setShadowBlur(t)}},{key:"setShadowStroke",value:function(t){return this.style.setShadowStroke(t)}},{key:"setShadowFill",value:function(t){return this.style.setShadowFill(t)}},{key:"setWrapMode",value:function(t){return this.style.setWrapMode(t)}},{key:"setWrapWidth",value:function(t){return this.style.setWrapWidth(t)}},{key:"setAlign",value:function(t){return this.style.setHAlign(t)}},{key:"setLineSpacing",value:function(t){return this.style.setLineSpacing(t)}},{key:"setPadding",value:function(t,e,i,n){if("object"===u(t)){var s=t,r=pe(s,"x",null);i=null!==r?t=r:(t=pe(s,"left",0),pe(s,"right",t));var o=pe(s,"y",null);n=null!==o?e=o:(e=pe(s,"top",0),pe(s,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=t),void 0===n&&(n=e);return this.padding.left=t,this.padding.top=e,this.padding.right=i,this.padding.bottom=n,this.updateText(!1)}},{key:"setResolution",value:function(t){return this.style.setResolution(t)}},{key:"setMaxLines",value:function(t){return this.style.setMaxLines(t)}},{key:"updateText",value:function(t){void 0===t&&(t=!0);var e=this.canvasText,i=this.style;t&&e.updatePenManager(this._text,i.wrapMode,i.wrapWidth,i.lineHeight);var n,s,r=this.padding;0===i.fixedWidth?(this.width=e.linesWidth+r.left+r.right,n=e.linesWidth):(this.width=i.fixedWidth,(n=this.width-r.left-r.right)<e.linesWidth&&(n=e.linesWidth)),0===i.fixedHeight?(this.height=e.linesHeight+r.top+r.bottom,s=e.linesHeight):(this.height=i.fixedHeight,(s=this.height-r.top-r.bottom)<e.linesHeight&&(s=e.linesHeight));var o=this.width,a=this.height;this.updateDisplayOrigin();var h=i.resolution;o*=h,a*=h,o=Math.max(Math.ceil(o),1),a=Math.max(Math.ceil(a),1);var l=this.canvas,u=this.context;l.width!==o||l.height!==a?(l.width=o,l.height=a,this.frame.setSize(o,a)):u.clearRect(0,0,o,a),u.save(),u.scale(h,h),e.draw(r.left,r.top,n,s),u.restore(),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(l,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0;var c=this.input;return c&&!c.customHitArea&&(c.hitArea.width=this.width,c.hitArea.height=this.height),this}},{key:"getTextMetrics",value:function(){return this.style.getTextMetrics()}},{key:"toJSON",value:function(){var t=ke.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),resolution:this.resolution,padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t}},{key:"preDestroy",value:function(){this.style.rtl&&ge(this.canvas),fe.remove(this.canvas),this.canvasText.destroy()}},{key:"setInteractive",value:function(t,e,i){return ve.prototype.setInteractive.call(this,t,e,i),this.canvasText.setInteractive(),this}},{key:"getWrappedText",value:function(t,e,i){return(t=this.canvasText.getText(t,e,i,!0)).split(ye)}},{key:"getPlainText",value:function(t,e,i){return this.canvasText.getPlainText(t,e,i)}},{key:"getText",value:function(t,e,i){return this.canvasText.getText(t,e,i,!1)}},{key:"getSubString",value:function(t,e,i){return this.getText(t,e,i)}},{key:"copyPenManager",value:function(t){return this.canvasText.copyPenManager(t)}},{key:"getPenManager",value:function(t,e){return this.canvasText.getPenManager(t,e)}},{key:"setSize",value:function(t,e){return this.setFixedSize(t,e)}},{key:"resize",value:function(t,e){return this.setFixedSize(t,e)}},{key:"addImage",value:function(t,e){return this.imageManager.add(t,e),this}},{key:"drawAreaBounds",value:function(t,e){return this.canvasText.hitAreaManager.drawBounds(t,e,this),this}},{key:"text",set:function(t){this.setText(t)},get:function(){return this._text}},{key:"lineSpacing",set:function(t){this.setLineSpacing(t)},get:function(){return this.style.lineSpacing}},{key:"imageManager",get:function(){return function(t){return void 0===le&&(le=new ce(t)),le}(this.scene.textures)}}]),l}(),ke=Phaser.GameObjects.Components;Phaser.Class.mixin(xe,[ke.Alpha,ke.BlendMode,ke.ComputedSize,ke.Crop,ke.Depth,ke.Flip,ke.GetBounds,ke.Mask,ke.Origin,ke.Pipeline,ke.ScrollFactor,ke.Tint,ke.Transform,ke.Visible,xt]);var be={plainText:null,prevProp:null},we=new It,Ce={},Se={splitText:function(t,e){for(var i,n,s=[],r=0,o=t.length,a=o;i=Pe.exec(t);)n=i[0],r<(a=Pe.lastIndex-n.length)&&s.push(t.substring(r,a)),void 0===e&&s.push(n),r=Pe.lastIndex;return r<o&&s.push(t.substring(r,o)),s},tagTextToProp:function(t,e){var i,n;null==e&&(e={}),e.img&&Oe(e,Je,"img"),i=Me.test(t)?(Oe(e,Ze,"b",!0),""):Ee.test(t)?(Oe(e,Je,"b"),""):_e.test(t)?(Oe(e,Ze,"i",!0),""):Ie.test(t)?(Oe(e,Je,"i"),""):je.test(t)?(n=t.match(je),Oe(e,Ze,"size",n[1]+"px"),""):De.test(t)?(Oe(e,Je,"size"),""):ze.test(t)?(n=t.match(ze),Oe(e,Ze,"color",n[1]),""):Re.test(t)?(Oe(e,Je,"color"),""):Be.test(t)?(n=t.match(Be),Oe(e,Ze,"u",!0),""):Ye.test(t)?(n=t.match(Ye),Oe(e,Ze,"u",n[1]),""):Le.test(t)?(Oe(e,Je,"u"),""):He.test(t)?(Oe(e,Ze,"shadow",!0),""):Fe.test(t)?(Oe(e,Je,"shadow"),""):Ve.test(t)?(Oe(e,Ze,"stroke",!0),""):Xe.test(t)?(n=t.match(Xe),Oe(e,Ze,"stroke",n[1]),""):We.test(t)?(Oe(e,Je,"stroke"),""):Ae.test(t)?(n=t.match(Ae),Oe(e,Ze,"img",n[1]),""):Ge.test(t)?(Oe(e,Je,"img"),""):Ue.test(t)?(n=t.match(Ue),Oe(e,Ze,"area",n[1]),""):Ne.test(t)?(Oe(e,Je,"area"),""):t;var s=be;return s.plainText=i,s.prop=e,s},propToContextStyle:function(t,e){var i=we;if(e.hasOwnProperty("img"))i.image=e.img;else{if(i.image=null,e.hasOwnProperty("family")?i.fontFamily=e.family:i.fontFamily=t.fontFamily,e.hasOwnProperty("size")){var n=e.size;"number"==typeof n&&(n=n.toString()+"px"),i.fontSize=n}else i.fontSize=t.fontSize;i.fontStyle=Te(e.b,e.i),e.hasOwnProperty("color")?i.color=e.color:i.color=t.color,e.hasOwnProperty("stroke")?(!0===e.stroke?i.stroke=t.stroke:i.stroke=e.stroke,i.strokeThickness=t.strokeThickness):(i.stroke=t.stroke,i.strokeThickness=0)}return e.hasOwnProperty("shadow")?(!0===e.shadow?i.shadowColor=t.shadowColor:i.shadowColor=e.shadow,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur,i.shadowStroke=!0,i.shadowFill=!0):(i.shadowColor="#000",i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,i.shadowStroke=!1,i.shadowFill=!1),e.hasOwnProperty("u")?(!0===e.u?i.underlineColor=t.underlineColor:i.underlineColor=e.u,i.underlineThickness=t.underlineThickness,i.underlineOffset=t.underlineOffset):(i.underlineColor="#000",i.underlineThickness=0,i.underlineOffset=0),i},propToTagText:function(t,e,i){for(var n in null==i&&(i=Ce),i)e.hasOwnProperty(n)||(t="[/"+n+"]"+t);var s="";for(var n in e)i[n]!==e[n]&&("size"===n?s+="[size="+e[n].replace("px","")+"]":"color"===n||"stroke"===n||"img"===n?s+="["+n+"="+e[n]+"]":"u"===n?!0===e[n]?s+="[u]":s+="[u="+e[n]+"]":s+="["+n+"]");return t=s+t}},Oe=function(t,e,i,n){return e===Ze?t[i]=n:t.hasOwnProperty(i)&&delete t[i],t},Te=function(t,e){return t&&e?"bold italic":t?"bold":e?"italic":""},Pe=/\[b\]|\[\/b\]|\[i\]|\[\/i\]|\[size=(\d+)\]|\[\/size\]|\[color=([a-z]+|#[0-9abcdef]+)\]|\[\/color\]|\[u\]|\[u=([a-z]+|#[0-9abcdef]+)\]|\[\/u\]|\[shadow\]|\[\/shadow\]|\[stroke\]|\[stroke=([a-z]+|#[0-9abcdef]+)\]|\[\/stroke\]|\[img=([^\]]+)\]|\[\/img\]|\[area=([^\]]+)\]|\[\/area\]/gi,Me=/\[b\]/i,Ee=/\[\/b\]/i,_e=/\[i\]/i,Ie=/\[\/i\]/i,je=/\[size=(\d+)\]/i,De=/\[\/size\]/i,ze=/\[color=([a-z]+|#[0-9abcdef]+)\]/i,Re=/\[\/color\]/i,Be=/\[u\]/i,Ye=/\[u=([a-z]+|#[0-9abcdef]+)\]/i,Le=/\[\/u\]/i,He=/\[shadow\]/i,Fe=/\[\/shadow\]/i,Ve=/\[stroke\]/i,Xe=/\[stroke=([a-z]+|#[0-9abcdef]+)\]/i,We=/\[\/stroke\]/i,Ae=/\[img=([^\]]+)\]/i,Ge=/\[\/img\]/i,Ue=/\[area=([^\]]+)\]/i,Ne=/\[\/area\]/i,Je=!1,Ze=!0,Ke=function(){function r(t,e,i,n,s){return M(this,r),I(this,E(r).call(this,t,e,i,n,s,"rexBBCodeText",Se))}return e(r,xe),r}();c.register("BBCodeText",function(t,e,i,n){var s=new Ke(this.scene,t,e,i,n);return this.scene.add.existing(s),s}),ct(window,"RexPlugins.UI.BBCodeText",Ke);var qe={plainText:null,prevProp:null},$e=new It,Qe=function(){function e(t){M(this,e),void 0===t&&(t={}),this.tags=t}return v(e,[{key:"addTag",value:function(t,e){this.tags[t]=e}},{key:"splitText",value:function(t,e){for(var i,n,s,r=[],o=0,a=t.length,h=a;i=ii.exec(t);)n=i[0],o<(h=ii.lastIndex-n.length)&&r.push(t.substring(o,h)),void 0===e?r.push(n):1===e&&(ni.test(n)?(s=n.match(si),r.push(s[2])):ri.test(n)&&(s=n.match(oi),r.push(s[2]))),o=ii.lastIndex;return o<a&&r.push(t.substring(o,a)),r}},{key:"tagTextToProp",value:function(t,e){var i,n;if(ni.test(t)){if(null!=(o=t.match(si))){var s=o[1],r=this.tags;(n=r.hasOwnProperty(s)?r[s]:{})._class=s,i=o[2]}}else if(ri.test(t)){var o;if(null!=(o=t.match(oi))){var a=o[1];(n=ti(a))._style=a,i=o[2]}}null==i&&(i=t),null==n&&(n={});var h=qe;return h.plainText=i,h.prop=n,h}},{key:"propToContextStyle",value:function(t,e){var i=$e;if(e.hasOwnProperty("img"))i.image=e.img;else{if(i.image=null,e.hasOwnProperty("family")||e.hasOwnProperty("fontFamily")||e.hasOwnProperty("font-family")){var n=e.hasOwnProperty("family")?e.family:e.hasOwnProperty("fontFamily")?e.fontFamily:e["font-family"];i.fontFamily=n}else i.fontFamily=t.fontFamily;if(e.hasOwnProperty("size")||e.hasOwnProperty("fontSize")||e.hasOwnProperty("font-size")){var s=e.hasOwnProperty("size")?e.size:e.hasOwnProperty("fontSize")?e.fontSize:e["font-size"];"number"==typeof s&&(s=s.toString()+"px"),i.fontSize=s}else i.fontSize=t.fontSize;if(e.hasOwnProperty("style")||e.hasOwnProperty("fontStyle")||e.hasOwnProperty("font-style")){var r=e.hasOwnProperty("style")?e.style:e.hasOwnProperty("fontStyle")?e.fontStyle:e["font-style"];i.fontStyle=r}else i.fontStyle=t.fontStyle;if(e.hasOwnProperty("color")||e.hasOwnProperty("font-color")){e.hasOwnProperty("color")?e.color:e["font-color"];i.color=e.color}else i.color=t.color;if(e.hasOwnProperty("stroke")){var o=e.stroke;i.stroke=o.hasOwnProperty("color")?o.color:t.stroke,i.strokeThickness=o.hasOwnProperty("thinkness")?o.thinkness:t.strokeThickness}else i.stroke=t.stroke,i.strokeThickness=t.strokeThickness}if(e.hasOwnProperty("shadow")){var a=e.shadow;i.shadowColor=a.hasOwnProperty("color")?a.color:t.shadowColor,i.shadowOffsetX=a.hasOwnProperty("offsetX")?a.offsetX:t.shadowOffsetX,i.shadowOffsetY=a.hasOwnProperty("offsetY")?a.offsetY:t.shadowOffsetY,i.shadowBlur=a.hasOwnProperty("blur")?a.blur:t.shadowBlur,i.shadowStroke=!0,i.shadowFill=!0}else i.shadowColor=t.shadowColor,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur,i.shadowStroke=t.shadowStroke,i.shadowFill=t.shadowFill;if(e.hasOwnProperty("u")||e.hasOwnProperty("underline")){var h=e.hasOwnProperty("u")?e.u:e.underline;i.underlineColor=h.hasOwnProperty("color")?h.color:t.underlineColor,i.underlineThickness=h.hasOwnProperty("thinkness")?h.thinkness:t.underlineThickness,i.underlineOffset=h.hasOwnProperty("offset")?h.offset:t.underlineOffset}else i.underlineColor=t.underlineColor,i.underlineThickness=t.underlineThickness,i.underlineOffset=t.underlineOffset;return i}},{key:"propToTagText",value:function(t,e,i){return e.hasOwnProperty("_class")?""===t&&this.isTextTag(e._class)?"":"<class='"+e._class+"'>"+t+"</class>":e.hasOwnProperty("_style")?"<style='"+e._style+"'>"+t+"</style>":void 0}},{key:"destroy",value:function(){this.tags=void 0}},{key:"isTextTag",value:function(t){var e=this.tags[t];return!!e&&null==e.img}}]),e}(),ti=function(t){for(var e,i,n,s={},r=0,o=(t=t.split(";")).length;r<o;r++)if(i=(e=t[r].split(":"))[0],n=e[1],!ei(i)&&!ei(n)){switch(i){case"stroke":var a=n.split(" ");n={},1<=(l=a.length)&&(n.color=a[0]),2<=l&&(n.thinkness=parseInt(a[1].replace("px","")));break;case"shadow":var h=n.split(" ");n={},1<=(l=h.length)&&(n.color=h[0]),2<=l&&(n.offsetX=parseInt(h[1].replace("px",""))),3<=l&&(n.offsetY=parseInt(h[2].replace("px",""))),4<=l&&(n.blur=parseInt(h[3].replace("px","")));break;case"u":case"underline":var l,u=n.split(" ");n={},1<=(l=u.length)&&(n.color=u[0]),2<=l&&(n.thinkness=parseInt(u[1].replace("px",""))),3<=l&&(n.offset=parseInt(u[2].replace("px","")))}s[i]=n}return s},ei=function(t){return 0===(t=t.replace(ai,"")).length},ii=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>|<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/g,ni=/<\s*class=/i,si=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>/,ri=/<\s*style=/i,oi=/<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/,ai=/^\s+|\s+$/,hi=Phaser.Utils.Objects.GetValue,li=function(){function h(t,e,i,n,s){var r;M(this,h);var o=hi(s,"tags",void 0),a=new Qe(o);return(r=I(this,E(h).call(this,t,e,i,n,s,"rexTagText",a))).parser=a,r}return e(h,xe),v(h,[{key:"addTag",value:function(t,e){return this.parser.addTag(t,e),this.updateText(!0)}},{key:"addTags",value:function(t){for(var e in t)this.parser.addTag(e,t[e]);return this.updateText(!0)}},{key:"preDestroy",value:function(){d(E(h.prototype),"preDestroy",this).call(this),this.parser.destroy(),this.parser=void 0}}]),h}();c.register("tagText",function(t,e,i,n){var s=new li(this.scene,t,e,i,n);return this.scene.add.existing(s),s}),ct(window,"RexPlugins.UI.TagText",li);function ui(t,e){return t===e?1:t/e}var ci={add:function(t){return Array.isArray(t)?this.addMultiple(t):this._add(t),this},addMultiple:function(t){return t.forEach(this._add,this),this},_add:function(t){return this.children.add(t),this.resetChildState(t).updateChildVisible(t).updateChildActive(t).updateChildScrollFactor(t).updateChildMask(t),this}},di=Phaser.Math.RotateAround,fi={worldToLocal:function(t){return t.x-=this.x,t.y-=this.y,di(t,0,0,-this.rotation),t.x/=this.scaleX,t.y/=this.scaleY,t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t},localToWorld:function(t){return t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t.x*=this.scaleX,t.y*=this.scaleY,di(t,0,0,this.rotation),t.x+=this.x,t.y+=this.y,t}},vi={updateChildPosition:function(t){t.isRexContainerLite&&(t.syncChildrenEnable=!1);var e=this.getLocalState(t);return t.x=e.x,t.y=e.y,this.localToWorld(t),t.scaleX=e.scaleX*this.scaleX,t.scaleY=e.scaleY*this.scaleY,void 0!==t.flipX&&(t.flipX=this.flipX?!e.flipX:e.flipX,t.flipY=this.flipY?!e.flipY:e.flipY),t.rotation=e.rotation+this.rotation,t.isRexContainerLite&&(t.syncChildrenEnable=!0,t.syncPosition()),this},syncPosition:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildPosition,this),this},resetChildPositionState:function(t){var e=this.getLocalState(t);return e.x=t.x,e.y=t.y,this.worldToLocal(e),e.scaleX=ui(t.scaleX,this.scaleX),e.scaleY=ui(t.scaleY,this.scaleY),void 0!==t.flipX&&(e.flipX=t.flipX,e.flipY=t.flipY),e.rotation=t.rotation-this.rotation,this},setChildPosition:function(t,e,i){return t.x=e,t.y=i,this.resetChildPositionState(t),this},setChildLocalPosition:function(t,e,i){var n=this.getLocalState(t);return n.x=e,n.y=i,this.updateChildPosition(t),this}},pi={updateChildVisible:function(t){return t.visible=this.visible&&this.getLocalState(t).visible,this},syncVisible:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildVisible,this),this},resetChildVisibleState:function(t){return this.getLocalState(t).visible=t.visible,this},setChildVisible:function(t,e){return t.visible=e,this.resetChildVisibleState(t),this},setChildLocalVisible:function(t,e){return void 0===e&&(e=!0),this.getLocalState(t).visible=e,this.updateChildVisible(t),this}},gi={updateChildAlpha:function(t){return t.alpha=this.alpha*this.getLocalState(t).alpha,this},syncAlpha:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildAlpha,this),this},resetChildAlphaState:function(t){return this.getLocalState(t).alpha=ui(t.alpha,this.alpha),this},setChildAlpha:function(t,e){return t.alpha=e,this.resetChildAlphaState(t),this._add},setChildLocalAlpha:function(t,e){return this.getLocalState(t).alpha=e,this.updateChildAlpha(t),this}},yi={updateChildActive:function(t){return t.active=this.active&&this.getLocalState(t).active,this},syncActive:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildActive,this),this},resetChildActiveState:function(t){return this.getLocalState(t).active=t.active,this},setChildActive:function(t,e){return t.active=e,this.resetChildActiveState(t),this},setChildLocalActive:function(t,e){return void 0===e&&(e=!0),this.getLocalState(t).active=e,this.updateChildActive(t),this}},mi={updateChildMask:function(t){return null==this.mask||(this.mask.hasOwnProperty("geometryMask")?this.mask.geometryMask:this.mask.bitmapMask)!==t&&(t.mask=this.mask),this},syncMask:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildMask,this),this},setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this}},xi=Phaser.Utils.Array,ki={getChildren:function(){return this.children.getChildren()},getAllChildren:function(t){void 0===t&&(t=[]);for(var e,i=this.children.getChildren(),n=0,s=i.length;n<s;n++){var r;if(e=i[n],t.push(e),e.hasOwnProperty("isRexContainerLite"))(r=t).push.apply(r,h(e.getAllChildren()))}return t},contains:function(t){if(this.children.contains(t))return!0;for(var e,i=this.children.getChildren(),n=0,s=i.length;n<s;n++)if((e=i[n]).isRexContainerLite&&e.contains(t))return!0;return!1},getByName:function(t){return xi.GetFirst(this.list,"name",t)},getRandom:function(t,e){return xi.GetRandom(this.list,t,e)},getFirst:function(t,e,i,n){return xi.GetFirstElement(this.list,t,e,i,n)},getAll:function(t,e,i,n){return xi.GetAll(this.list,t,e,i,n)},count:function(t,e,i,n){return xi.CountAllMatching(this.list,t,e,i,n)},swap:function(t,e){return xi.Swap(this.list,t,e),this},moveTo:function(t,e){return xi.MoveTo(this.list,t,e),this},setAll:function(t,e,i,n){return xi.SetAll(this.list,t,e,i,n),this}},bi=Phaser.GameObjects.Zone,wi=Phaser.GameObjects.Components,Ci=function(){function a(t,e,i,n,s,r){var o;return M(this,a),Array.isArray(n)&&(r=n,n=void 0),void 0===n&&(n=1),void 0===s&&(s=1),(o=I(this,E(a).call(this,t,e,i,n,s))).children=t.add.group(),o.type="rexContainerLite",o.isRexContainerLite=!0,o.syncChildrenEnable=!0,o._flipX=!1,o._flipY=!1,o._alpha=1,o._active=!0,o._mask=null,o._scrollFactorX=1,o._scrollFactorY=1,r&&o.add(r),o}return e(a,bi),v(a,[{key:"destroy",value:function(t){this.scene&&(this.children.destroy(!t),this.children=void 0,d(E(a.prototype),"destroy",this).call(this,t))}},{key:"resize",value:function(t,e){return this.setSize(t,e),this}},{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.syncPosition())}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.syncPosition())}},{key:"rotation",get:function(){return d(E(a.prototype),"rotation",this)},set:function(t){this.rotation!==t&&(s(E(a.prototype),"rotation",t,this,!0),this.syncPosition())}},{key:"scaleX",get:function(){return d(E(a.prototype),"scaleX",this)},set:function(t){this.scaleX!==t&&(s(E(a.prototype),"scaleX",t,this,!0),this.syncPosition())}},{key:"scaleY",get:function(){return d(E(a.prototype),"scaleY",this)},set:function(t){this.scaleY!==t&&(s(E(a.prototype),"scaleY",t,this,!0),this.syncPosition())}},{key:"flipX",get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t,this.syncPosition())}},{key:"flipY",get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t,this.syncPosition())}},{key:"visible",get:function(){return d(E(a.prototype),"visible",this)},set:function(t){this.visible!==t&&(s(E(a.prototype),"visible",t,this,!0),this.syncVisible())}},{key:"alpha",get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this.syncAlpha())}},{key:"active",get:function(){return this._active},set:function(t){this._active!==t&&(this._active=t,this.syncActive())}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask!==t&&(this._mask=t,this.syncMask())}},{key:"scrollFactorX",get:function(){return this._scrollFactorX},set:function(t){this._scrollFactorX!==t&&(this._scrollFactorX=t,this.syncScrollFactor())}},{key:"scrollFactorY",get:function(){return this._scrollFactorY},set:function(t){this._scrollFactorY!==t&&(this._scrollFactorY=t,this.syncScrollFactor())}},{key:"list",get:function(){return this.children.getChildren()}}]),a}();Object.assign(Ci.prototype,ci,{remove:function(t,e){return this.children.remove(t,!1,e),this},clear:function(t){return this.children.clear(!1,t),this}},{getLocalState:function(t){return t.hasOwnProperty("rexContainer")||(t.rexContainer={}),t.rexContainer},resetChildState:function(t){return this.resetChildPositionState(t).resetChildVisibleState(t).resetChildAlphaState(t).resetChildActiveState(t),this},resetChildrenState:function(t){for(var e=0,i=t.length;e<i;e++)this.resetChildState(t[e]);return this},syncProperties:function(){return this.syncPosition().syncVisible().syncAlpha().syncActive().syncScrollFactor().syncMask(),this}},fi,vi,pi,gi,{updateChildScrollFactor:function(t){return t.setScrollFactor(this.scrollFactorX,this.scrollFactorY),this},syncScrollFactor:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildScrollFactor,this),this}},yi,mi,{setDepth:function(t){if(this.depth=t,this.children)for(var e=this.getAllChildren(),i=0,n=e.length;i<n;i++)e[i].depth=t;return this},swapDepth:function(t){var e=this.depth,i=t.depth;return this.setDepth(i),t.setDepth(e),this},incDepth:function(t){if(this.depth+=t,this.children)for(var e=this.getAllChildren(),i=0,n=e.length;i<n;i++)e[i].depth+=t;return this}},ki,wi.Alpha,wi.Flip),c.register("container",function(t,e,i,n,s){var r=new Ci(this.scene,t,e,i,n,s);return this.scene.add.existing(r),r}),ct(window,"RexPlugins.UI.Container",Ci);var Si=Phaser.Renderer.WebGL.Utils,Oi=K,Ti=K;WEBGL_RENDERER&&(Oi=function(t,e,i,n,s){if(e.dirty&&(e.updateTexture(),e.dirty=!1),0!==e.width&&0!==e.height){var r=e.frame,o=r.width,a=r.height,h=Si.getTintAppendFloatAlpha;this.pipeline.batchTexture(e,r.glTexture,o,a,e.x,e.y,o/e.resolution,a/e.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,o,a,h(e._tintTL,n.alpha*e._alphaTL),h(e._tintTR,n.alpha*e._alphaTR),h(e._tintBL,n.alpha*e._alphaBL),h(e._tintBR,n.alpha*e._alphaBR),e._isTinted&&e.tintFill,0,0,n,s)}}),CANVAS_RENDERER&&(Ti=function(t,e,i,n,s){0!==e.width&&0!==e.height&&t.batchSprite(e,e.frame,n,s)});var Pi={renderWebGL:Oi,renderCanvas:Ti},Mi=Phaser.Display.Color,Ei={clear:function(){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},fill:function(t){return this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},getPixel:function(t,e,i){void 0===i&&(i=new Mi);var n=this.context.getImageData(t,e,1,1);return i.setTo(n.data[0],n.data[1],n.data[2],n.data[3]),i},setPixel:function(t,e,i,n,s,r){if("number"!=typeof i){var o=i;i=o.red,n=o.green,s=o.blue,r=o.alpha}void 0===r&&(r=0!==i||0!==n||0!==s?255:0);var a=this.context.createImageData(1,1);return a.data[0]=i,a.data[1]=n,a.data[2]=s,a.data[3]=r,this.context.putImageData(a,t,e),this.dirty=!0,this}},_i={updateTexture:function(t,e){t&&(e?t.call(e,this.canvas,this.context):t(this.canvas,this.context)),this.canvas.width===this.frame.width&&this.canvas.height===this.frame.height||this.frame.setSize(this.canvas.width,this.canvas.height),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(this.canvas,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!1;var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=this.width,i.hitArea.height=this.height),this},generateTexture:function(t,e,i,n,s){var r,o=this.canvas,a=this.scene.sys,h=a.game.renderer;void 0===e&&(e=0),void 0===i&&(i=0),void 0===n?n=o.width:n*=this.resolution,void 0===s?s=o.height:s*=this.resolution;var l=(r=a.textures.exists(t)?a.textures.get(t):a.textures.createCanvas(t,n,s)).getSourceImage();l.width!==n&&(l.width=n),l.height!==s&&(l.height=s);var u=l.getContext("2d");return u.clearRect(0,0,n,s),u.drawImage(o,e,i,n,s),h.gl&&r&&h.canvasToTexture(l,r.source[0].glTexture,!0,0),this},loadTexture:function(t,e){var i=this.scene.textures.getFrame(t,e);return i&&(this.width!==i.cutWidth||this.height!==i.cutHeight?this.resize(i.cutWidth,i.cutHeight):this.context.clearRect(0,0,i.cutWidth,i.cutHeight),this.context.drawImage(i.source.image,i.cutX,i.cutY,i.cutWidth,i.cutHeight,0,0,this.canvas.width,this.canvas.height),this.dirty=!0),this}},Ii=Phaser.Display.Canvas.CanvasPool,ji=Phaser.GameObjects.GameObject,Di=function(){function o(t,e,i,n,s){var r;return M(this,o),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=1),(r=I(this,E(o).call(this,t,"rexCanvas"))).renderer=t.sys.game.renderer,r.resolution=t.sys.game.config.resolution,r.canvas=Ii.create(_(r),r.resolution*n,r.resolution*s),r.context=r.canvas.getContext("2d"),r.dirty=!1,r.setPosition(e,i),r.setSize(n,s),r.setOrigin(.5,.5),r.initPipeline(),r._crop=r.resetCropObject(),r.texture=t.sys.textures.addCanvas(null,r.canvas,!0),r.frame=r.texture.get(),r.frame.source.resolution=r.resolution,r.renderer&&r.renderer.gl&&(r.renderer.deleteTexture(r.frame.source.glTexture),r.frame.source.glTexture=null),r.dirty=!0,t.sys.game.events.on("contextrestored",function(){this.dirty=!0},_(r)),r}return e(o,ji),v(o,[{key:"getCanvas",value:function(t){return t||(this.dirty=!0),this.canvas}},{key:"needRedraw",value:function(){return this.dirty=!0,this}},{key:"preDestroy",value:function(){Ii.remove(this.canvas)}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(this.setSize(t,e).updateDisplayOrigin(),t*=this.resolution,e*=this.resolution,t=Math.max(Math.ceil(t),1),e=Math.max(Math.ceil(e),1),this.canvas.width=t,this.canvas.height=e,this.dirty=!0),this}}]),o}(),zi=Phaser.GameObjects.Components;Phaser.Class.mixin(Di,[zi.Alpha,zi.BlendMode,zi.ComputedSize,zi.Crop,zi.Depth,zi.Flip,zi.GetBounds,zi.Mask,zi.Origin,zi.Pipeline,zi.ScrollFactor,zi.Tint,zi.Transform,zi.Visible,Pi,Ei,_i]);var Ri=function(e,t){void 0===t&&(t={}),void 0===t.options&&(t.options={});var i=t.options;i.responsive=!1,i.maintainAspectRatio=!1,i.hasOwnProperty("devicePixelRatio")||(i.devicePixelRatio=1);var n=!1;void 0===i.animation?i.animation={}:!1===i.animation&&(n=!0,i.animation={});var s=i.animation;n&&(s.duration=0);var r=s.onProgress;s.onProgress=function(t){r&&r(t),e.needRedraw()};var o=s.onComplete;return s.onComplete=function(t){o&&o(t),e.needRedraw()},t},Bi=function(){function a(t,e,i,n,s,r){var o;return M(this,a),(o=I(this,E(a).call(this,t,e,i,n,s))).type="rexChart",(o.chart=void 0)!==r&&o.setChart(r),o}return e(a,Di),v(a,[{key:"destroy",value:function(t){this.scene&&(this.chart&&(this.chart.destroy(),this.chart=void 0),d(E(a.prototype),"destroy",this).call(this,t))}},{key:"resize",value:function(t,e){if(t===this.width&&e===this.height)return this;if(d(E(a.prototype),"resize",this).call(this,t,e),this.chart){var i=this.chart;i.height=this.canvas.height,i.width=this.canvas.width,i.aspectRatio=i.height?i.width/i.height:null,i.update()}return this}}]),a}(),Yi={setChart:function(t){if(window.Chart)return this.chart&&this.chart.destroy(),this.chart=new Chart(this.context,Ri(this,t)),this;return console.error("Can not find chartjs! Load chartjs in preload stage.\nscene.load.script('chartjs', 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js');"),this},getChartDataset:function(t){if(void 0!==this.chart){if("string"!=typeof t)return this.chart.data.datasets[t];for(var e,i=this.chart.data.datasets,n=0,s=i.length;n<s;n++)if((e=i[n]).label===t)return e}},getChartData:function(t,e){var i=this.getChartDataset(t);if(void 0!==i){if("string"==typeof e)if(-1===(e=this.chart.data.labels.indexOf(e)))return;return i.data[e]}},setChartData:function(t,e,i){if(void 0===this.chart)return this;var n=this.getChartDataset(t);if("string"==typeof e&&-1===(e=this.chart.data.labels.indexOf(e)))return this;return n.data[e]=i,this},updateChart:function(){if(void 0===this.chart)return this;this.chart.update()}};Object.assign(Bi.prototype,Yi),c.register("chart",function(t,e,i,n,s){var r=new Bi(this.scene,t,e,i,n,s);return this.scene.add.existing(r),r}),ct(window,"RexPlugins.UI.Chart",Bi);var Li=Phaser.Utils.Objects.GetValue,Hi=function(){function h(t,e,i,n,s,r){var o;M(this,h),(o=I(this,E(h).call(this,t,e,i))).type="rexCircleMaskImage";var a=Li(r,"maskType",0);return o.setTexture(n,s,a),o}return e(h,Di),v(h,[{key:"setTexture",value:function(t,e,i){return void 0===i?i=0:"string"==typeof i&&(i=Fi[i]),this._textureKey=t,this._frameName=e,this.loadTexture(t,e),null!==i&&function(t,e){t.width===t.height&&(e=0);var i=Math.floor(t.width/2),n=Math.floor(t.height/2),s=t.getContext("2d");s.save(),s.globalCompositeOperation="destination-in",s.beginPath(),0===e?s.arc(i,n,Math.min(i,n),0,2*Math.PI):s.ellipse(i,n,i,n,0,0,2*Math.PI),s.fill(),s.restore()}(this.canvas,i),this.dirty=!0,this}}]),h}(),Fi={circle:0,ellipse:1};c.register("circleMaskImage",function(t,e,i,n,s){var r=new Hi(this.scene,t,e,i,n,s);return this.scene.add.existing(r),r}),ct(window,"RexPlugins.UI.CircleMaskImage",Hi);function Vi(t,e,i){return void 0===i&&(i="image"),t[e]||(t[e]=t.scene.make[i]({add:!1,origin:{x:0,y:0}}),t.once("destroy",function(){t[e]&&(t[e].destroy(),t[e]=void 0)})),t[e]}var Xi=Phaser.Utils.Objects.IsPlainObject,Wi=Phaser.Utils.Objects.GetValue,Ai=function(t){return"string"==typeof t&&(t=Gi[t]),t},Gi={scale:0,repeat:1},Ui={setTexture:function(t,e,i){this.textureKey=t,this.columns.data=e,this.columns.count=e?e.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.rows.data=i,this.rows.count=i?i.length:0,this.rows.stretch=0,this.rows.minHeight=0;var n=this.scene.textures.get(t);if(!n)return this.clear(),this;if(!e||!i)return this.clear(),this;for(var s=n.frames.__BASE,r=s.width,o=0,a=0,h=e.length;a<h;a++)void 0===e[a]?o++:"number"==typeof e[a]?r-=e[a]:r-=e[a].width;var l=r/o,u=s.height,c=0;for(a=0,h=i.length;a<h;a++)void 0===i[a]?c++:"number"==typeof i[a]?u-=i[a]:u-=i[a].width;for(var d,f,v,p,g,y=u/c,m=0,x=0,k=0,b=i.length;k<b;k++){void 0===i[k]&&(i[k]=y),"number"==typeof i[k]&&(i[k]={height:i[k],stretch:k%2}),v=(d=i[k]).height,this.rows.stretch+=0|d.stretch,this.rows.minHeight+=0<d.stretch?0:v;a=m=0;for(var w=e.length;a<w;a++)void 0===e[a]&&(e[a]=l),"number"==typeof e[a]&&(e[a]={width:e[a],stretch:a%2}),p=(f=e[a]).width,0===k&&(this.columns.stretch+=0|f.stretch,this.columns.minWidth+=0<f.stretch?0:p),1<=p&&1<=v?(g=this.getFrameNameCallback(a,k))&&n.add(g,0,m,x,p,v):console.warn("Size of Grid(".concat(a,",").concat(k,") = ").concat(p,"x").concat(v,", which is invalid")),m+=p;x+=v}return this.updateTexture(),this},updateTexture:function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.textures.get(this.textureKey);if(!t)return this;var e,i,n=this.width-this.columns.minWidth;i=0<=n?(e=0<this.columns.stretch?n/this.columns.stretch:0,1):(e=0,this.width/this.columns.minWidth);var s,r,o,a,h,l,u,c=this.height-this.rows.minHeight;r=0<=c?(s=0<this.rows.stretch?c/this.rows.stretch:0,1):(s=0,this.height/this.rows.minHeight);for(var d,f=0,v=0,p=0,g=this.rows.count;p<g;p++){u=0===(h=this.rows.data[p]).stretch?h.height*r:s*h.stretch;for(var y=f=0,m=this.columns.count;y<m;y++)l=0===(a=this.columns.data[y]).stretch?a.width*i:e*a.stretch,(o=this.getFrameNameCallback(y,p))&&0<l&&0<u&&t.has(o)&&(0===(0===h.stretch&&0===a.stretch?0:0===this.getStretchMode(y,p)?0:1)?(d=Vi(this,"_image","image")).setTexture(this.textureKey,o).setDisplaySize(l,u):(d=Vi(this,"_tileSprite","tileSprite")).setTexture(this.textureKey,o).setSize(l,u)),d&&(this.draw(d,f,v),d=void 0),f+=l;v+=u}},setStretchMode:function(t){return Xi(t)?(this.stretchMode.edge=Ai(Wi(t,"edge",0)),this.stretchMode.internal=Ai(Wi(t,"internal",0))):(t=Ai(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1}.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal}};function Ni(t,e){return"".concat(t,",").concat(e)}var Ji=Phaser.GameObjects.RenderTexture,Zi=Phaser.Utils.Objects.IsPlainObject,Ki=Phaser.Utils.Objects.GetValue,qi=function(){function u(t,e,i,n,s,r,o,a,h){var l;return M(this,u),Zi(e)?(e=Ki(h=e,"x",0),i=Ki(h,"y",0),n=Ki(h,"width",1),s=Ki(h,"height",1),r=Ki(h,"key",void 0),o=Ki(h,"columns",void 0),a=Ki(h,"rows",void 0)):Zi(n)?(n=Ki(h=n,"width",1),s=Ki(h,"height",1),r=Ki(h,"key",void 0),o=Ki(h,"columns",void 0),a=Ki(h,"rows",void 0)):Zi(r)&&(r=Ki(h=r,"key",void 0),o=Ki(h,"columns",void 0),a=Ki(h,"rows",void 0)),(l=I(this,E(u).call(this,t,e,i,n,s))).columns={},l.rows={},l.stretchMode={},l._tileSprite=void 0,l._image=void 0,l.setOrigin(.5,.5),l.setGetFrameNameCallback(Ki(h,"getFrameNameCallback",void 0)),l.setStretchMode(Ki(h,"stretchMode",0)),l.setTexture(r,o,a),l}return e(u,Ji),v(u,[{key:"setGetFrameNameCallback",value:function(t){return void 0===t&&(t=Ni),this.getFrameNameCallback=t,this}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(d(E(u.prototype),"resize",this).call(this,t,e),this.updateTexture()),this}},{key:"minWidth",get:function(){return this.columns.minWidth}},{key:"minHeight",get:function(){return this.rows.minHeight}}]),u}();Object.assign(qi.prototype,Ui),c.register("ninePatch",function(t,e,i,n,s,r,o,a){var h=new qi(this.scene,t,e,i,n,s,r,o,a);return this.scene.add.existing(h),h}),ct(window,"RexPlugins.UI.NinePatch",qi);function $i(t){return function(){function n(){return M(this,n),I(this,E(n).apply(this,arguments))}return e(n,t),v(n,[{key:"createVideoElement",value:function(t){return this.video||(void 0===t&&(t={}),(t.eventEmitter=this).video=function(t){var e,i,n=this,s=document.createElement("video");for(var r in tn)e=tn[r],void 0!==(i=Qi(t,r,e[1]))&&(s[e[0]]=i);var o=Qi(t,"eventEmitter",void 0);if(o){var a=function(t){s.addEventListener(en[t],function(){o.emit(t,this)}.bind(n))};for(var h in en)a(h)}return s}(t),this.playbackTimeChangeEventEnable=rn(t,"playbackTimeChangeEventEnable",!0)),this.video}},{key:"preDestroy",value:function(){this.scene&&(this.video&&(this.video.pause(),this.video.removeAttribute("src"),this.video.load(),this.video=void 0),d(E(n.prototype),"preDestroy",this)&&d(E(n.prototype),"preDestroy",this).call(this))}},{key:"preUpdate",value:function(t,e){if(this.playbackTimeChangeEventEnable){var i=this.playbackTime;i!==this.prevT&&this.emit("playbacktimechange",this),this.prevT=i}d(E(n.prototype),"preUpdate",this)&&d(E(n.prototype),"preUpdate",this).call(this,t,e)}},{key:"load",value:function(t){return this.video&&function(t,e,i){if(nn(e))for(var n,s=0,r=sn.length;s<r;s++)if(i[n=sn[s]]&&e.hasOwnProperty(n)){e=e[n];break}t.src=e,t.load()}(this.video,t,this.availableVideoTypes),this}},{key:"play",value:function(){return this.video&&this.video.play(),this}},{key:"pause",value:function(){return this.video&&this.video.pause(),this}},{key:"setPlaybackTime",value:function(t){return this.playbackTime=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"setVolume",value:function(t){return this.volume=t,this}},{key:"setMute",value:function(t){return void 0===t&&(t=!0),this.muted=t,this}},{key:"setLoop",value:function(t){return void 0===t&&(t=!0),this.loop=t,this}},{key:"availableVideoTypes",get:function(){return this.scene.sys.game.device.video}},{key:"isPlaying",get:function(){if(this.video){var t=this.video;return!t.paused&&!t.ended&&0<t.currentTime}return!1}},{key:"isPaused",get:function(){return!!this.video&&this.video.paused}},{key:"playbackTime",get:function(){return this.video&&this.video.currentTime||0},set:function(t){if(this.video)try{this.video.currentTime=t}catch(t){}}},{key:"duration",get:function(){return this.video&&this.video.duration||0}},{key:"t",get:function(){if(this.video){var t=this.duration;return 0===t?0:this.playbackTime/t}return 0},set:function(t){this.video&&(this.playbackTime=this.duration*on(t,0,1))}},{key:"hasEnded",get:function(){return!!this.video&&this.video.ended}},{key:"volume",get:function(){return this.video&&this.video.volume||0},set:function(t){this.video&&(this.video.volume=t)}},{key:"muted",get:function(){return this.video&&this.video.muted||!1},set:function(t){this.video&&(this.video.muted=t)}},{key:"loop",get:function(){return!!this.video&&this.video.loop},set:function(t){this.video&&(this.video.loop=t)}},{key:"readyState",get:function(){return this.video?this.video.readyState:void 0}}]),n}()}var Qi=Phaser.Utils.Objects.GetValue,tn={id:["id",void 0],width:["width",void 0],height:["height",void 0],autoPlay:["autoplay",!0],controls:["controls",!1],loop:["loop",!1],poster:["poster",void 0],preload:["preload",void 0],muted:["muted",!1],playsInline:["playsInline",!0],crossOrigin:["crossOrigin","anonymous"]},en={canplay:"canplay",canplaythrough:"canplaythrough",ended:"ended",error:"error",loadstart:"loadstart",playing:"playing",pause:"pause",stalled:"stalled"},nn=Phaser.Utils.Objects.IsPlainObject,sn=["webm","ogg","mp4","h264","vp9","hls"],rn=Phaser.Utils.Objects.GetValue,on=Phaser.Math.Clamp,an=Phaser.GameObjects.DOMElement,hn=Phaser.Utils.Objects.IsPlainObject,ln=Phaser.Utils.Objects.GetValue,un=function(){function h(t,e,i,n,s,r){var o;M(this,h),hn(e)?(e=ln(r=e,"x",0),i=ln(r,"y",0),n=ln(r,"width",void 0),s=ln(r,"height",void 0)):hn(n)&&(n=ln(r=n,"width",void 0),s=ln(r,"height",void 0)),void 0===r&&(r={});var a=t.scale.autoRound;return void 0!==n&&(a&&(n=Math.floor(n)),r.width=n),void 0!==s&&(a&&(s=Math.floor(s)),r.height=s),(o=I(this,E(h).call(this,t,e,i))).type="rexVideo",o.setElement(o.createVideoElement(r)).load(ln(r,"src","")),o}return e(h,$i(an)),v(h,[{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(this.node.width=t,this.node.height=e,this.updateSize()),this}}]),h}();c.register("video",function(t,e,i,n,s){var r=new un(this.scene,t,e,i,n,s);return this.scene.add.existing(r),r}),ct(window,"RexPlugins.UI.Video",un);function cn(t){dn?t():(window.onYouTubeIframeAPIReady||(window.onYouTubeIframeAPIReady=function(){dn=!0;for(var t=0,e=fn.length;t<e;t++)fn[t]();fn=void 0},function(t,e){for(var i=document.getElementsByTagName("script"),n=0,s=i.length;n<s;n++)if(-1!=i[n].src.indexOf(t))return e&&e();var r=document.createElement("script");r.setAttribute("src",t),e&&(r.onload=e),document.head.appendChild(r)}("https://www.youtube.com/iframe_api")),fn.push(t))}var dn=!1,fn=[],vn=Phaser.GameObjects.DOMElement,pn=Phaser.Utils.Objects.IsPlainObject,gn=Phaser.Utils.Objects.GetValue,yn=Phaser.Math.Clamp,mn=function(){function d(t,e,i,n,s,r){var o;M(this,d),pn(e)?(e=gn(r=e,"x",0),i=gn(r,"y",0),n=gn(r,"width",void 0),s=gn(r,"height",void 0)):pn(n)&&(n=gn(r=n,"width",void 0),s=gn(r,"height",void 0)),void 0===r&&(r={});var a=t.scale.autoRound;void 0!==n&&(a&&(n=Math.floor(n)),r.width=n+"px"),void 0!==s&&(a&&(s=Math.floor(s)),r.height=s+"px"),(o=I(this,E(d).call(this,t,e,i))).type="rexYoutubePlayer",o.youtubePlayer=void 0,o.videoState=void 0,o.videoId=gn(r,"videoId",""),o.loop=gn(r,"loop",!1),o.paddingCallbacks=[];var h="YT"+Date.now(),l=document.createElement("div");l.id=h,l.style.width=r.width,l.style.height=r.height,o.setElement(l);var u={autoplay:gn(r,"autoPlay",!0)?1:0,controls:gn(r,"controls",!0)?1:0,disablekb:gn(r,"keyboardControl",!0)?0:1,modestbranding:gn(r,"modestBranding",!1)?1:0},c=function(){var n=new YT.Player(h,{videoId:this.videoId,playerVars:u,events:{onStateChange:function(t){this.videoState=t.data,this.emit("statechange",this),this.emit(this.videoStateString,this),this.videoState===YT.PlayerState.ENDED&&this.loop&&this.youtubePlayer.playVideo()}.bind(this),onReady:function(t){this.youtubePlayer=n;for(var e=0,i=this.paddingCallbacks.length;e<i;e++)this.paddingCallbacks[e]();this.paddingCallbacks=void 0,this.emit("ready",this)}.bind(this),onError:function(t){this.lastError=t.data,this.emit("error",this,this.lastError)}.bind(this)}});this.setElement(document.getElementById(h))}.bind(_(o));return cn(c),o}return e(d,vn),v(d,[{key:"_runCallback",value:function(t){void 0===this.youtubePlayer?this.paddingCallbacks.push(t):t()}},{key:"load",value:function(t,e){void 0===e&&(e=!0);var i=function(){this.youtubePlayer.loadVideoById(t),e?this.youtubePlayer.playVideo():this.youtubePlayer.pauseVideo()}.bind(this);return this._runCallback(i),this}},{key:"play",value:function(){var t=function(){this.youtubePlayer.playVideo()}.bind(this);return this._runCallback(t),this}},{key:"pause",value:function(){var t=function(){this.youtubePlayer.pauseVideo()}.bind(this);return this._runCallback(t),this}},{key:"setPlaybackTime",value:function(t){return this.playbackTime=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"setVolume",value:function(t){return this.volume=t,this}},{key:"setMute",value:function(t){return void 0===t&&(t=!0),this.muted=t,this}},{key:"setLoop",value:function(t){return void 0===t&&(t=!0),this.loop=t,this}},{key:"resize",value:function(t,e){if(this.width===t&&this.height===e)return this;var i=this.node.style;return i.width=t+"px",i.height=e+"px",this.updateSize(),this}},{key:"videoStateString",get:function(){if(void 0===this.videoState||!YT)return"";switch(this.videoState){case-1:return"unstarted";case YT.PlayerState.ENDED:return"ended";case YT.PlayerState.PLAYING:return"playing";case YT.PlayerState.PAUSED:return"pause";case YT.PlayerState.BUFFERING:return"buffering";case YT.PlayerState.CUED:return"cued"}}},{key:"isPlaying",get:function(){return 1===this.videoState}},{key:"isPaused",get:function(){return 2===this.videoState}},{key:"playbackTime",get:function(){return this.youtubePlayer?this.youtubePlayer.getCurrentTime():0},set:function(t){var e=function(){this.youtubePlayer.seekTo(t)}.bind(this);this._runCallback(e)}},{key:"duration",get:function(){return this.youtubePlayer?this.youtubePlayer.getDuration():0}},{key:"t",get:function(){var t=this.duration;return 0===t?0:this.playbackTime/t},set:function(t){var e=function(){t=yn(t,0,1),this.playbackTime=this.duration*yn(t,0,1)}.bind(this);this._runCallback(e)}},{key:"hasEnded",get:function(){return 0===this.videoState}},{key:"volume",get:function(){return this.youtubePlayer?this.youtubePlayer.getVolume()/100:0},set:function(t){var e=function(){this.youtubePlayer.setVolume(yn(100*t,0,100))}.bind(this);this._runCallback(e)}},{key:"muted",get:function(){return!!this.youtubePlayer&&this.youtubePlayer.isMuted()},set:function(t){var e=function(){t?this.youtubePlayer.mute():this.youtubePlayer.unMute()}.bind(this);this._runCallback(e)}}]),d}();c.register("youtubePlayer",function(t,e,i,n,s){var r=new mn(this.scene,t,e,i,n,s);return this.scene.add.existing(r),r}),ct(window,"RexPlugins.UI.YoutubePlayer",mn);function xn(t){return t.hasOwnProperty("rexSizer")||(t.rexSizer={}),t.rexSizer}function kn(t,e){void 0===e&&(void 0===bn&&(bn=new Phaser.Geom.Rectangle),e=bn);var i=t.game.config;return e.setTo(0,0,i.width,i.height),e}var bn,wn=Phaser.Display.Align,Cn={center:wn.CENTER,left:wn.LEFT_CENTER,right:wn.RIGHT_CENTER,top:wn.TOP_CENTER,bottom:wn.BOTTOM_CENTER,"left-top":wn.TOP_LEFT,"left-center":wn.LEFT_CENTER,"left-bottom":wn.BOTTOM_LEFT,"center-top":wn.TOP_CENTER,"center-center":wn.CENTER,"center-bottom":wn.BOTTOM_CENTER,"right-top":wn.TOP_RIGHT,"right-center":wn.RIGHT_CENTER,"right-bottom":wn.BOTTOM_RIGHT},Sn=new Phaser.GameObjects.Zone({sys:{queueDepthSort:K,events:{once:K}}},0,0,1,1);Sn.setOrigin(0);function On(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Ln(t,Bn(e)+i),Yn(t,Rn(e)+n),t}function Tn(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Fn(t,Hn(e)-i),Yn(t,Rn(e)+n),t}function Pn(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Xn(t,Vn(e)+i),Yn(t,Rn(e)+n),t}function Mn(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),An(t,Bn(e)+i,Gn(e)+n),t}function En(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Fn(t,Hn(e)-i),Wn(t,Gn(e)+n),t}function _n(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Xn(t,Vn(e)+i),Wn(t,Gn(e)+n),t}function In(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Ln(t,Bn(e)+i),Nn(t,Un(e)-n),t}function jn(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Fn(t,Hn(e)-i),Nn(t,Un(e)-n),t}function Dn(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),Xn(t,Vn(e)+i),Nn(t,Un(e)-n),t}var zn={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12},Rn=function(t){return t.y+t.displayHeight-t.displayHeight*t.originY},Bn=function(t){return t.x-t.displayWidth*t.originX+.5*t.displayWidth},Yn=function(t,e){return t.y=e-t.displayHeight+t.displayHeight*t.originY,t},Ln=function(t,e){var i=t.displayWidth*t.originX;return t.x=e+i-.5*t.displayWidth,t},Hn=function(t){return t.x-t.displayWidth*t.originX},Fn=function(t,e){return t.x=e+t.displayWidth*t.originX,t},Vn=function(t){return t.x+t.displayWidth-t.displayWidth*t.originX},Xn=function(t,e){return t.x=e-t.displayWidth+t.displayWidth*t.originX,t},Wn=function(t,e){var i=t.displayHeight*t.originY;return t.y=e+i-.5*t.displayHeight,t},An=function(t,e,i){return Ln(t,e),Wn(t,i)},Gn=function(t){return t.y-t.displayHeight*t.originY+.5*t.displayHeight},Un=function(t){return t.y-t.displayHeight*t.originY},Nn=function(t,e){return t.y=e+t.displayHeight*t.originY,t},Jn=[];Jn[zn.BOTTOM_CENTER]=On,Jn[zn.BOTTOM_LEFT]=Tn,Jn[zn.BOTTOM_RIGHT]=Pn,Jn[zn.CENTER]=Mn,Jn[zn.LEFT_CENTER]=En,Jn[zn.RIGHT_CENTER]=_n,Jn[zn.TOP_CENTER]=In,Jn[zn.TOP_LEFT]=jn,Jn[zn.TOP_RIGHT]=Dn;function Zn(t,e){return void 0===this.childrenMap&&(this.childrenMap={}),this.childrenMap[t]=e,this}function Kn(t){return t instanceof ls}function qn(t){return Kn(t)?t:t.scene&&Kn(t.scene)?t.scene:t.parent&&t.parent.scene&&Kn(t.parent.scene)?t.parent.scene:void 0}var $n=function(t,e,i,n,s){return Jn[i](t,e,n,s)},Qn=Phaser.Utils.Objects.GetValue,ts=function(t,e,i){return t.add.text(0,0,"")},es=new Phaser.Geom.Rectangle,is=function t(e,i){var n;for(var s in void 0===i&&(i=[]),e)void 0!==(n=e[s]).name?i.push(n):t(n,i);return i},ns=/(\S+)\[(\d+)\]/i,ss=[],rs=Phaser.Geom.Rectangle,os=Phaser.Geom.Rectangle,as=function(){function i(t,e){M(this,i),this.gameObject=t,this.viewport=new os,this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){var e,i,n,s,r,o,a,h;return void 0!==t.x?(e=null,i=t.x):void 0!==t.left?(e=0,i=t.left):void 0!==t.right?(e=1,i=t.right):void 0!==t.centerX&&(e=.5,i=t.centerX),void 0!==t.y?(n=null,s=t.y):void 0!==t.top?(n=0,s=t.top):void 0!==t.bottom?(n=1,s=t.bottom):void 0!==t.centerY&&(n=.5,s=t.centerY),void 0!==i&&(i=i.replace("left","0%").replace("right","100%").replace("center","50%").split("%"),r=parseFloat(i[0])/100,o=""===i[1]?0:parseFloat(i[1])),void 0!==s&&(s=s.replace("top","0%").replace("bottom","100%").replace("center","50%").split("%"),a=parseFloat(s[0])/100,h=""===s[1]?0:parseFloat(s[1])),this.setAlign(e,n),this.setPercentage(r,a),this.setOffset(o,h),this}},{key:"boot",value:function(){this.scaleManamger.on("resize",this.anchor,this),this.gameObject.once("destroy",this.destroy,this),this.anchor()}},{key:"shutdown",value:function(){this.scaleManamger.off("resize",this.anchor,this),this.gameObject=void 0}},{key:"destroy",value:function(){this.shutdown()}},{key:"setAlign",value:function(t,e){return this.alignX=t,this.alignY=e,this}},{key:"setPercentage",value:function(t,e){return this.percentageX=t,this.percentageY=e,this}},{key:"setOffset",value:function(t,e){return this.offsetX=t,this.offsetY=e,this}},{key:"anchor",value:function(){return function(t,e){void 0===e&&(e=new rs);var i=t.canvasBounds,n=t.displayScale,s=t.autoCenter;e.x=0<=i.x?0:-i.x*n.x,e.y=0<=i.y?0:-i.y*n.y,e.width=i.width*n.x-e.x,e.height=i.height*n.y-e.y,1!==s&&2!==s||(e.width-=e.x),1!==s&&3!==s||(e.height-=e.y)}(this.scaleManamger,this.viewport),this.updatePosition(),this}},{key:"updatePosition",value:function(){var t=this.gameObject;return null===this.alignX?t.x=this.anchorX:void 0!==this.alignX&&(t.x=this.anchorX+t.displayWidth*(t.originX-this.alignX)),null===this.alignY?this.gameObject.y=this.anchorY:void 0!==this.alignY&&(t.y=this.anchorY+t.displayHeight*(t.originY-this.alignY)),this}},{key:"scaleManamger",get:function(){return this.gameObject.scene.scale}},{key:"anchorX",get:function(){return this.viewport.x+this.viewport.width*this.percentageX+this.offsetX}},{key:"anchorY",get:function(){return this.viewport.y+this.viewport.height*this.percentageY+this.offsetY}}]),i}(),hs={setEventEmitter:function(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown()},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(){return this._eventEmitter&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]}},ls=Phaser.Scene,us=Phaser.Utils.Objects.GetValue,cs=Phaser.Utils.Objects.GetAdvancedValue,ds=function(){function i(t,e){M(this,i),this.gameObject=t,this.scene=qn(t),this.scaleStart={},this.scaleEnd={},this.tween=void 0,this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){return this.setMode(us(t,"mode",0)),this.setScaleRange(cs(t,"start",void 0),cs(t,"end",0)),this.setDelay(cs(t,"delay",0)),this.setDuration(cs(t,"duration",1e3)),this.setEase(us(t,"ease",void 0)),this}},{key:"toJSON",value:function(){return{mode:this.mode,start:this.scaleStart,end:this.scaleEnd,delay:this.delay,duration:this.duration}}},{key:"boot",value:function(){this.gameObject.once&&this.gameObject.once("destroy",this.destroy,this)}},{key:"shutdown",value:function(){return this.stop(),this.gameObject=void 0,this.scene=void 0,this}},{key:"destroy",value:function(){return this.shutdown(),this}},{key:"setMode",value:function(t){return"string"==typeof t&&(t=fs[t]),this.mode=t,this}},{key:"setScaleRange",value:function(t,e){return"number"==typeof t?(this.scaleStart.x=t,this.scaleStart.y=t):(this.scaleStart.x=us(t,"x",this.gameObject.scaleX),this.scaleStart.y=us(t,"y",this.gameObject.scaleY)),"number"==typeof e?(this.scaleEnd.x=e,this.scaleEnd.y=e):(this.scaleEnd.x=us(e,"x",this.scaleStart.x),this.scaleEnd.y=us(e,"y",this.scaleStart.y)),this}},{key:"setDelay",value:function(t){return this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setEase",value:function(t){return void 0===t&&(t="Linear"),this.ease=t,this}},{key:"start",value:function(){return this.tween||(0===this.duration?(this.gameObject.setScale(this.scaleEnd.x,this.scaleEnd.y),this.complete()):(this.gameObject.setScale(this.scaleStart.x,this.scaleStart.y),this.tween=this.scene.tweens.add({targets:this.gameObject,scaleX:this.scaleEnd.x,scaleY:this.scaleEnd.y,duration:this.duration,ease:this.ease,yoyo:2==this.mode,repeat:2==this.mode?-1:0,onComplete:this.complete,onCompleteScope:this}),this.setEventEmitter(this.tween))),this}},{key:"restart",value:function(){return this.stop().start(),this}},{key:"stop",value:function(){return this.tween&&(this.setEventEmitter(!1),this.tween.remove(),this.tween=void 0),this}},{key:"complete",value:function(){return this.stop(),1===this.mode&&this.gameObject.destroy(),this}}]),i}();Object.assign(ds.prototype,hs);var fs={stop:0,destroy:1,yoyo:2},vs={},ps=Phaser.Utils.Objects.IsPlainObject,gs=Phaser.Utils.Objects.GetValue;var ys={},ms=Phaser.Utils.Objects.IsPlainObject,xs=Phaser.Utils.Objects.GetValue;var ks=Phaser.Utils.Objects.GetValue,bs=Phaser.Utils.Objects.GetAdvancedValue,ws=function(){function i(t,e){M(this,i),this.gameObject=t,this.scene=qn(t),this.alphaStart=void 0,this.alphaEnd=void 0,this.tween=void 0,this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){return this.setMode(ks(t,"mode",0)),this.setAlphaRange(bs(t,"start",this.gameObject.alpha),bs(t,"end",0)),this.setDelay(bs(t,"delay",0)),this.setDuration(bs(t,"duration",1e3)),this}},{key:"toJSON",value:function(){return{mode:this.mode,start:this.alphaStart,end:this.alphaEnd,delay:this.delay,duration:this.duration}}},{key:"boot",value:function(){this.gameObject.once&&this.gameObject.once("destroy",this.destroy,this)}},{key:"shutdown",value:function(){return this.stop(),this.gameObject=void 0,this.scene=void 0,this}},{key:"destroy",value:function(){return this.shutdown(),this}},{key:"setMode",value:function(t){return"string"==typeof t&&(t=Cs[t]),this.mode=t,this}},{key:"setAlphaRange",value:function(t,e){return this.alphaStart=t,this.alphaEnd=e,this}},{key:"setDelay",value:function(t){return this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"start",value:function(){return this.tween||(0===this.duration?(this.gameObject.setAlpha(this.alphaEnd),this.complete()):(this.gameObject.setAlpha(this.alphaStart),this.tween=this.scene.tweens.add({targets:this.gameObject,alpha:this.alphaEnd,delay:this.delay,duration:this.duration,ease:"Linear",yoyo:2==this.mode,repeat:2==this.mode?-1:0,onComplete:this.complete,onCompleteScope:this}),this.setEventEmitter(this.tween))),this}},{key:"restart",value:function(){return this.stop().start(),this}},{key:"stop",value:function(){return this.tween&&(this.setEventEmitter(!1),this.tween.remove(),this.tween=void 0),this}},{key:"complete",value:function(){return this.stop(),1===this.mode&&this.gameObject.destroy(),this}}]),i}();Object.assign(ws.prototype,hs);var Cs={stop:0,destroy:1,yoyo:2},Ss={},Os=Phaser.Utils.Objects.IsPlainObject,Ts=Phaser.Utils.Objects.GetValue;var Ps={},Ms=Phaser.Utils.Objects.IsPlainObject,Es=Phaser.Utils.Objects.GetValue;function _s(t,e,i,n){if(void 0===Is&&(Is=new Phaser.Geom.Rectangle),t.getBounds(Is),e)return!(i&&!i(t,e))&&(!!Is.contains(e.x,e.y)&&!(n&&!n(t,e)));for(var s=t.scene.input.manager,r=s.pointersTotal,o=s.pointers,a=0;a<r;a++)if(e=o[a],(!i||i(t,e))&&Is.contains(e.x,e.y)&&(!n||n(t,e)))return!0;return!1}var Is=void 0;function js(t){return xn(t).parent}function Ds(t){for(var e=js(t);e;)e=js(t=e);return t}function zs(t,e,i){!t||void 0===e&&void 0===i||(t.resize?(void 0===e&&(e=t.width),void 0===i&&(i=t.height),t.resize(e,i)):(void 0!==e&&(t.displayWidth=e),void 0!==i&&(t.displayHeight=i)))}var Rs=Phaser.Display.Align.CENTER,Bs=function(t,e,i){var n=this.getTopmostSizer();n.x+=e-this.x,n.y+=i-this.y},Ys={getSizerConfig:xn,pushIntoBounds:function(t){return void 0===t&&(t=kn(this.scene)),this.left=Math.max(this.left,t.left),this.right=Math.min(this.right,t.right),this.top=Math.max(this.top,t.top),this.bottom=Math.min(this.bottom,t.bottom),this},drawBounds:function(t,e){var i,n,s,r,o=t.scene;if("number"==typeof e)i=e;else{i=Qn(e,"color",16777215);var a=Qn(e,"name",!1);a&&(n=Qn(a,"createTextCallback",ts),s=Qn(a,"createTextCallbackScope",void 0),"string"==typeof(r=Qn(a,"align","left-top"))&&(r=Cn[r]))}if(n&&!t.children){t.children=o.add.group(),t.once("destroy",function(){t.children.destroy(),t.children=void 0});var h=t.clear.bind(t);t.clear=function(){h(),t.children.clear(!1,!0)}}for(var l,u,c=this.getAllChildren([this]),d=0,f=c.length;d<f;d++)(l=c[d]).getBounds&&(i&&t.lineStyle(1,i).strokeRectShape(l.getBounds(es)),l.name&&n&&(u=s?n.call(s,o):n(o))&&(u.setText(l.name),t.children.add(u),Sn.setPosition(es.x,es.y).setSize(es.width,es.height),$n(u,Sn,r)));return this},getChildrenWidth:function(){return 0},getChildrenHeight:function(){return 0},addChildrenMap:Zn,addElement:Zn,getElement:function(t){if(void 0!==this.childrenMap&&("string"==typeof t&&(t=t.split(".")),0!==t.length)){var e,i=t.shift();if("#"===i.charAt(0)){i=i.substring(1);for(var n=0,s=(r=is(this.childrenMap,ss)).length;n<s;n++)if(r[n].name===i){e=r[n];break}ss.length=0}else if(-1===i.indexOf("["))e=this.childrenMap[i];else{var r,o=i.match(ns);if(null!=o)(r=this.childrenMap[o[1]])&&(e=r[o[2]])}return 0===t.length?e:e&&e.childrenMap?e.getElement(t):null}},getAllChildrenSizers:function(t){void 0===t&&(t=[]);for(var e=t.length,i=this.getChildrenSizers(t),n=t.length,s=e;s<n;s++)i[s].getAllChildrenSizers(t);return t},getChildrenSizers:function(t){return void 0===t&&(t=[]),t},preLayout:function(t){if(!t)for(var e,i=this.getAllChildrenSizers([this]),n=0,s=i.length;n<s;n++)(e=i[n]).rexSizer&&e._layoutInit()},_layoutInit:function(){},layout:function(t,e,i){return this.rexSizer.hidden?this:(this.preLayout(),this.postLayout())},layoutBackgrounds:function(){if(void 0!==this.backgroundChildren)for(var t,e=this.backgroundChildren,i=this.left,n=this.top,s=this.width,r=this.height,o=0,a=e.length;o<a;o++)(t=e[o]).rexSizer.hidden||(zs(t,s,r),Sn.setPosition(i,n).setSize(s,r),$n(t,Sn,Rs),this.resetChildPositionState(t))},postLayout:function(t,e,i){return this._anchor&&this._anchor.updatePosition(),this},setAnchor:function(t){return void 0===this._anchor?this._anchor=new as(this,t):this._anchor.resetFromJSON(t),this},popUp:function(t,e,i){if(ps(t)){var n=t;t=gs(n,"duration",void 0),e=gs(n,"orientation",void 0),i=gs(n,"ease",void 0)}return this._scale=function(t,e,i,n,s){switch(vs.mode=0,i){case 0:case"x":vs.start={x:0};break;case 1:case"y":vs.start={y:0};break;default:vs.start=0}return vs.end=1,vs.duration=e,vs.ease=void 0===n?"Cubic":n,void 0===s?s=new ds(t,vs):s.resetFromJSON(vs),s.restart(),s}(this,t,e,i,this._scale),this},scaleDownDestroy:function(t,e,i,n){if(ms(t)){var s=t;t=xs(s,"duration",void 0),e=xs(s,"orientation",void 0),i=xs(s,"ease",void 0),n=xs(s,"destroy",void 0)}return this._scale=function(t,e,i,n,s,r){switch(s instanceof ds&&(r=s,s=void 0),void 0===s&&(s=!0),ys.mode=s?1:0,i){case 0:case"x":ys.end={x:0};break;case 1:case"y":ys.end={y:0};break;default:ys.end=0}return ys.duration=e,ys.ease=void 0===n?"Linear":n,void 0===r?r=new ds(t,ys):r.resetFromJSON(ys),r.restart(),r}(this,t,e,i,n,this._scale),this},fadeIn:function(t){return Os(t)&&(t=Ts(t,"duration",void 0)),this._fade=function(t,e,i,n){return void 0===i&&(i=t.alpha),Ss.mode=0,Ss.start=0,Ss.end=i,Ss.duration=e,void 0===n?n=new ws(t,Ss):n.resetFromJSON(Ss),n.restart(),n}(this,t,this._fade),this},fadeOutDestroy:function(t,e){if(Ms(t)){var i=t;t=Es(i,"duration",void 0),e=Es(i,"destroy",void 0)}return this._fade=function(t,e,i,n){return i instanceof ws&&(n=i,i=void 0),void 0===i&&(i=!0),Ps.mode=i?1:0,Ps.end=0,Ps.duration=e,void 0===n?n=new ws(t,Ps):n.resetFromJSON(Ps),n.restart(),n}(this,t,e,this._fade),this},isInTouching:function(t){return _s(this,t)},getParentSizer:function(){return js(this)},getTopmostSizer:function(){return Ds(this)},setDraggable:function(t,e){var i=u(t);return"string"===i?t=this.getElement(t):void 0!==t&&"object"==i||(e=t,t=this),void 0===e&&(e=!0),t.input&&t.input.hasOwnProperty("draggable")?t.input.draggable=e:e&&(t.setInteractive(),t.scene.input.setDraggable(t),t.on("drag",Bs,this)),this}},Ls=Phaser.Utils.Objects.GetValue,Hs=function(){function h(t,e,i,n,s,r){var o;M(this,h),(o=I(this,E(h).call(this,t,e,i,2,2))).isRexSizer=!0,o.setMinSize(n,s),o.setName(Ls(r,"name","")),o.rexSizer={},o.backgroundChildren=void 0;var a=Ls(r,"anchor",void 0);return a&&o.setAnchor(a),o.setDraggable(Ls(r,"draggable",!1)),o}return e(h,Ci),v(h,[{key:"destroy",value:function(t){this.scene&&(void 0!==this.backgroundChildren&&(this.backgroundChildren.length=0),d(E(h.prototype),"destroy",this).call(this,t))}},{key:"setMinSize",value:function(t,e){return this.setMinWidth(t).setMinHeight(e),this}},{key:"setMinWidth",value:function(t){return null==t&&(t=0),this.minWidth=t,this}},{key:"setMinHeight",value:function(t){return null==t&&(t=0),this.minHeight=t,this}},{key:"alignLeft",value:function(t){return this.left=t,this}},{key:"alignRight",value:function(t){return this.right=t,this}},{key:"alignCenterX",value:function(t){return this.centerX=t,this}},{key:"alignTop",value:function(t){return this.top=t,this}},{key:"alignBottom",value:function(t){return this.bottom=t,this}},{key:"alignCenterY",value:function(t){return this.centerY=t,this}},{key:"pin",value:function(t){return d(E(h.prototype),"add",this).call(this,t),this}},{key:"addBackground",value:function(t,e){return void 0===this.backgroundChildren&&(this.backgroundChildren=[]),d(E(h.prototype),"add",this).call(this,t),(this.getSizerConfig(t).parent=this).backgroundChildren.push(t),void 0!==e&&this.addChildrenMap(e,t),this}},{key:"childrenWidth",get:function(){return void 0===this._childrenWidth&&(this._childrenWidth=this.getChildrenWidth()),this._childrenWidth}},{key:"childrenHeight",get:function(){return void 0===this._childrenHeight&&(this._childrenHeight=this.getChildrenHeight()),this._childrenHeight}},{key:"left",get:function(){return this.x-this.displayWidth*this.originX},set:function(t){this.x+=t-this.left}},{key:"right",get:function(){return this.left+this.displayWidth},set:function(t){this.x+=t-this.right}},{key:"centerX",get:function(){return this.left+this.displayWidth/2},set:function(t){this.x+=t-this.centerX}},{key:"top",get:function(){return this.y-this.displayHeight*this.originY},set:function(t){this.y+=t-this.top}},{key:"bottom",get:function(){return this.top+this.displayHeight},set:function(t){this.y+=t-this.bottom}},{key:"centerY",get:function(){return this.top+this.displayHeight/2},set:function(t){this.y+=t-this.centerY}}]),h}();Object.assign(Hs.prototype,Ys);function Fs(t,e){return void 0===e&&(e={}),"number"==typeof t?(e.left=t,e.right=t,e.top=t,e.bottom=t):(e.left=Xs(t,"left",0),e.right=Xs(t,"right",0),e.top=Xs(t,"top",0),e.bottom=Xs(t,"bottom",0)),e}var Vs={getChildrenWidth:function(t){if(this.rexSizer.hidden)return 0;void 0===t&&(t=!0);var e,i,n,s=0,r=this.sizerChildren;if(0===this.orientation)for(var o=0,a=r.length;o<a;o++)(e=r[o]).rexSizer.hidden||(n=0===e.rexSizer.proportion||t&&!e.isRexSpace&&0<e.rexSizer.proportion?e.isRexSizer?Math.max(e.minWidth,e.childrenWidth):e.displayWidth:0,s+=n+=(i=e.rexSizer.padding).left+i.right);else for(o=0,a=r.length;o<a;o++)(e=r[o]).hasOwnProperty("rexSizer")&&(e.rexSizer.hidden||(n=e.isRexSizer?Math.max(e.minWidth,e.childrenWidth):e.displayWidth,n+=(i=e.rexSizer.padding).left+i.right,s=Math.max(n,s)));return s},getChildrenHeight:function(t){if(this.rexSizer.hidden)return 0;void 0===t&&(t=!0);var e,i,n,s=0,r=this.sizerChildren;if(0===this.orientation)for(var o=0,a=r.length;o<a;o++)(e=r[o]).rexSizer.hidden||(n=e.isRexSizer?Math.max(e.minHeight,e.childrenHeight):e.displayHeight,n+=(i=e.rexSizer.padding).top+i.bottom,s=Math.max(n,s));else for(o=0,a=r.length;o<a;o++)(e=r[o]).hasOwnProperty("rexSizer")&&(e.rexSizer.hidden||(n=0===e.rexSizer.proportion||t&&!e.isRexSpace&&0<e.rexSizer.proportion?e.isRexSizer?Math.max(e.minHeight,e.childrenHeight):e.displayHeight:0,s+=n+=(i=e.rexSizer.padding).top+i.bottom));return s},getChildrenProportion:function(){for(var t,e,i=0,n=this.sizerChildren,s=0,r=n.length;s<r;s++)(t=n[s]).rexSizer.hidden||0<(e=t.rexSizer.proportion)&&(i+=e);return i},getChildrenSizers:function(t){void 0===t&&(t=[]);for(var e,i=this.sizerChildren,n=0,s=i.length;n<s;n++)(e=i[n]).isRexSizer&&t.push(e);return t},layout:function(t,e,i){if(this.rexSizer.hidden)return this;var n;if(this.preLayout(t),void 0===e&&(e=Math.max(this.childrenWidth,this.minWidth)),void 0===i&&(i=Math.max(this.childrenHeight,this.minHeight)),this.resize(e,i),0<this.childrenProportion){var s=0===this.orientation?this.width-this.childrenWidth:this.height-this.childrenHeight;n=0<s?(s=0===this.orientation?this.width-this.getChildrenWidth(!1):this.height-this.getChildrenHeight(!1))/this.childrenProportion:0}else n=0;this.proportionLength=n;for(var r,o,a,h,l,u,c,d,f,v,p,g,y,m,x,k,b,w=this.sizerChildren,C=this.left,S=this.top,O=0,T=w.length;O<T;O++)(r=w[O]).rexSizer.hidden||(a=(o=r.rexSizer).padding,m=this,x=void 0,k=r.rexSizer,b=k.padding,0===m.orientation?0<k.proportion&&0<m.proportionLength&&(x=k.proportion*m.proportionLength):k.expand&&(x=m.width-b.left-b.right),d=x,v=this,p=void 0,g=r.rexSizer,y=g.padding,0===v.orientation?g.expand&&(p=v.height-y.top-y.bottom):0<g.proportion&&0<v.proportionLength&&(p=g.proportion*v.proportionLength),f=p,r.isRexSizer?r.layout(this,d,f):zs(r,d,f),void 0===d&&(d=r.displayWidth),void 0===f&&(f=r.displayHeight),c=0===this.orientation?(h=C+a.left,u=0===o.proportion||0===n?d:o.proportion*n,l=S+a.top,this.height-a.top-a.bottom):(h=C+a.left,u=this.width-a.left-a.right,l=S+a.top,0===o.proportion||0===n?f:o.proportion*n),Sn.setPosition(h,l).setSize(u,c),$n(r,Sn,o.align),this.resetChildPositionState(r),0===this.orientation?C+=u+a.left+a.right:S+=c+a.top+a.bottom);return this.layoutBackgrounds(),this.postLayout()},_layoutInit:function(){this._childrenWidth=void 0,this._childrenHeight=void 0,this._childrenProportion=void 0}},Xs=Phaser.Utils.Objects.GetValue,Ws={x:0,h:0,horizontal:0,"left-to-right":0,y:1,v:1,vertical:1,"top-to-bottom":1},As=Phaser.Utils.Objects.IsPlainObject,Gs=Phaser.Utils.Objects.GetValue,Us=Phaser.Utils.Array.Remove,Ns=Phaser.Display.Align.CENTER,Js=function(){function h(t,e,i,n,s,r,o){var a;return M(this,h),As(e)?(e=Gs(o=e,"x",0),i=Gs(o,"y",0),n=Gs(o,"width",void 0),s=Gs(o,"height",void 0)):As(n)?(n=Gs(o=n,"width",void 0),s=Gs(o,"height",void 0)):As(r)&&(o=r),void 0!==o&&(r=Gs(o,"orientation",0)),void 0===r&&(r=0),(a=I(this,E(h).call(this,t,e,i,n,s,o))).type="rexSizer",a.sizerChildren=[],a.setOrientation(r),a}return e(h,Hs),v(h,[{key:"destroy",value:function(t){this.scene&&(this.sizerChildren.length=0,d(E(h.prototype),"destroy",this).call(this,t))}},{key:"setOrientation",value:function(t){return"string"==typeof t&&(t=Ws[t]),this.orientation=t,this}},{key:"add",value:function(t,e,i,n,s,r){d(E(h.prototype),"add",this).call(this,t);var o=u(e);if(null===e)return this;if("number"===o);else if("string"===o)e=Zs[e];else if(As(e)){var a;e=Gs(a=e,"proportion",0),i=Gs(a,"align",Ns),n=Gs(a,"padding",0),s=Gs(a,"expand",!1),r=Gs(a,"key",void 0)}return"string"==typeof i&&(i=Cn[i]),void 0===e&&(e=0),void 0===i&&(i=Ns),void 0===n&&(n=0),void 0===s&&(s=!1),(a=this.getSizerConfig(t)).parent=this,a.proportion=e,a.align=i,a.padding=Fs(n),a.expand=s,this.sizerChildren.push(t),void 0!==r&&this.addChildrenMap(r,t),this}},{key:"addSpace",value:function(t){return void 0===t&&(t=1),this.add(function(t){var e=t.add.zone(0,0,1,1);return e.isRexSpace=!0,e}(this.scene),t),this}},{key:"insert",value:function(t,e,i,n,s,r){return this.add(e,i,n,s,r),this.moveTo(e,t),this}},{key:"remove",value:function(t){var e=this.getSizerConfig(t);return e.parent!==this||(e.parent=void 0,Us(this.sizerChildren,t),d(E(h.prototype),"remove",this).call(this,t)),this}},{key:"clear",value:function(t){for(var e=0,i=this.sizerChildren.length;e<i;e++)this.getSizerConfig(this.sizerChildren[e]).parent=void 0;return this.sizerChildren.length=0,d(E(h.prototype),"clear",this).call(this,t),this}},{key:"childrenProportion",get:function(){return void 0===this._childrenProportion&&(this._childrenProportion=this.getChildrenProportion()),this._childrenProportion}}]),h}();Object.assign(Js.prototype,Vs);var Zs={min:0,full:-1};c.register("sizer",function(t,e,i,n,s,r){var o=new Js(this.scene,t,e,i,n,s,r);return this.scene.add.existing(o),o}),ct(window,"RexPlugins.UI.Sizer",Js);function Ks(t,e){var i,n=t.rexSizer;if(n.expand){var s=n.padding;i=e-s.left-s.right}return i}function qs(t,e){var i,n=t.rexSizer;if(n.expand){var s=n.padding;i=e-s.top-s.bottom}return i}var $s={getChildrenWidth:function(){if(this.rexSizer.hidden)return 0;for(var t,e,i,n,s,r=0,o=this.gridChildren,a=0;a<this.columnCount;a++){if(void(t=0)===(s=this.columnProportions[a])||0===s){for(var h=0;h<this.rowCount;h++)(e=o[h*this.columnCount+a])&&(e.rexSizer.hidden||(n=e.isRexSizer?Math.max(e.minWidth,e.childrenWidth):e.displayWidth,n+=(i=e.rexSizer.padding).left+i.right,t=Math.max(t,n)));r+=t}this.columnWidth[a]=t}return r},getChildrenHeight:function(){if(this.rexSizer.hidden)return 0;for(var t,e,i,n,s,r=0,o=this.gridChildren,a=0;a<this.rowCount;a++){if(void(t=0)===(s=this.rowProportions[a])||0===s){for(var h=0;h<this.columnCount;h++)(e=o[a*this.columnCount+h])&&(e.rexSizer.hidden||(n=e.isRexSizer?Math.max(e.minHeight,e.childrenHeight):e.displayHeight,n+=(i=e.rexSizer.padding).top+i.bottom,t=Math.max(t,n)));r+=t}this.rowHeight[a]=t}return r},getChildrenSizers:function(t){void 0===t&&(t=[]);for(var e,i=this.gridChildren,n=0,s=i.length;n<s;n++)(e=i[n])&&e.isRexSizer&&t.push(e);return t},layout:function(t,e,i){if(this.rexSizer.hidden)return this;this.preLayout(t);var n,s,r,o,a=this.totalColumnProportions,h=this.totalRowProportions;if(void 0===e)if(t&&0<a){var l=this.rexSizer.padding;e=t.width-l.left-l.right}else e=Math.max(this.childrenWidth,this.minWidth);if(void 0===i)if(t&&0<h){var l=this.rexSizer.padding;i=t.height-l.top-l.bottom}else i=Math.max(this.childrenHeight,this.minHeight);this.resize(e,i),n=0<a?(this.width-this.childrenWidth)/a:0,s=0<h?(this.height-this.childrenHeight)/h:0;for(var u,c,d,f,v,p,g,y,m,x,k=this.left,b=k,w=this.top,C=0;C<this.rowCount;C++){x=0===(y=this.rowProportions[C]||0)?this.rowHeight[C]:y*s,b=k;for(var S=0;S<this.columnCount;S++)m=0===(g=this.columnProportions[S]||0)?this.columnWidth[S]:g*n,(r=this.gridChildren[C*this.columnCount+S])&&!r.rexSizer.hidden&&(v=Ks(r,m),p=qs(r,x),r.isRexSizer?r.layout(this,v,p):zs(r,v,p),u=b+(l=(o=r.rexSizer).padding).left,d=m-l.left-l.right,c=w+l.top,f=x-l.top-l.bottom,Sn.setPosition(u,c).setSize(d,f),$n(r,Sn,o.align),this.resetChildPositionState(r)),b+=m;w+=x}return this.layoutBackgrounds(),this.postLayout()},_layoutInit:function(){this._childrenWidth=void 0,this._childrenHeight=void 0}},Qs=Phaser.Utils.Objects.IsPlainObject,tr=Phaser.Utils.Objects.GetValue,er=Phaser.Utils.Array.Remove,ir=Phaser.Display.Align.CENTER,nr=function(){function c(t,e,i,n,s,r,o,a,h){var l,u;return M(this,c),Qs(e)?(e=tr(u=e,"x",0),i=tr(u,"y",0),n=tr(u,"width",void 0),s=tr(u,"height",void 0),r=tr(u,"column",0),o=tr(u,"row",0),a=tr(u,"columnProportions",void 0),h=tr(u,"rowProportions",void 0)):Qs(n)?(n=tr(u=n,"width",void 0),s=tr(u,"height",void 0),r=tr(u,"column",0),o=tr(u,"row",0),a=tr(u,"columnProportions",void 0),h=tr(u,"rowProportions",void 0)):Qs(r)?(r=tr(u=r,"column",0),o=tr(u,"row",0),a=tr(u,"columnProportions",void 0),h=tr(u,"rowProportions",void 0)):Qs(a)&&(a=tr(u=a,"columnProportions",void 0),h=tr(u,"rowProportions",void 0)),(l=I(this,E(c).call(this,t,e,i,n,s,u))).type="rexGridSizer",l.initialGrid(r,o,a,h),l}return e(c,Hs),v(c,[{key:"destroy",value:function(t){this.scene&&(this.gridChildren.length=0,d(E(c.prototype),"destroy",this).call(this,t))}},{key:"setColumnProportion",value:function(t,e){return t>=this.columnProportions.length||(this.columnProportions[t]=e),this}},{key:"setRowProportion",value:function(t,e){return t>=this.rowProportions.length||(this.rowProportions[t]=e),this}},{key:"add",value:function(t,e,i,n,s,r,o){var a;d(E(c.prototype),"add",this).call(this,t),Qs(e)&&(e=tr(a=e,"column",0),i=tr(a,"row",0),n=tr(a,"align",ir),s=tr(a,"padding",0),r=tr(a,"expand",!1),o=tr(a,"key",void 0));return"string"==typeof n&&(n=Cn[n]),void 0===n&&(n=ir),void 0===s&&(s=0),void 0===r&&(r=!0),(a=this.getSizerConfig(t)).parent=this,a.align=n,a.padding=Fs(s),a.expand=r,this.gridChildren[i*this.columnCount+e]=t,void 0!==o&&this.addChildrenMap(o,t),this}},{key:"remove",value:function(t){var e=this.getSizerConfig(t);return e.parent!==this||(e.parent=void 0,er(this.gridChildren,t),void 0!==this.backgroundChildren&&er(this.backgroundChildren,t),d(E(c.prototype),"remove",this).call(this,t)),this}},{key:"initialGrid",value:function(t,e,i,n){if(this.columnCount=t,this.rowCount=e,this.gridChildren=[],this.gridChildren.length=t*e,this.columnProportions=[],this.columnProportions.length=t,this.columnWidth=[],this.columnWidth.length=t,this.rowProportions=[],this.rowProportions.length=e,this.rowHeight=[],this.rowHeight.length=e,i)for(var s="number"==typeof i,r=0;r<t;r++)if(s)this.setColumnProportion(r,i);else{var o=i[r];0<o&&this.setColumnProportion(r,o)}if(n){var a="number"==typeof n;for(r=0;r<e;r++)if(a)this.setRowProportion(r,n);else{var h=n[r];0<h&&this.setRowProportion(r,h)}}return this}},{key:"totalColumnProportions",get:function(){for(var t,e=0,i=0;i<this.columnCount;i++)0<(t=this.columnProportions[i])&&(e+=t);return e}},{key:"totalRowProportions",get:function(){for(var t,e=0,i=0;i<this.rowCount;i++)0<(t=this.rowProportions[i])&&(e+=t);return e}}]),c}();Object.assign(nr.prototype,$s),c.register("gridSizer",function(t,e,i,n,s,r,o,a){var h=new nr(this.scene,t,e,i,n,s,r,o,a);return this.scene.add.existing(h),h}),ct(window,"RexPlugins.UI.GridSizer",nr);function sr(t){var e=t.rexSizer.padding;return t.displayWidth+e.left+e.right}function rr(t){var e=t.rexSizer.padding;return t.displayHeight+e.top+e.bottom}var or=function(t,e){return 0===e?sr(t):rr(t)},ar=function(t,e){return 0===e?rr(t):sr(t)},hr={getChildrenWidth:function(){return this.rexSizer.hidden?0:(t=0===this.orientation?this.maxChildWidth:0,t=Math.max(t,this.minWidth));var t},getChildrenHeight:function(){return this.rexSizer.hidden?0:(t=0===this.orientation?0:this.maxChildHeight,t=Math.max(t,this.minHeight));var t},getChildrenSizers:function(t){void 0===t&&(t=[]);for(var e,i=this.sizerChildren,n=0,s=i.length;n<s;n++)"\n"!==(e=i[n])&&e.isRexSizer&&t.push(e);return t},layout:function(t,e,i){if(this.rexSizer.hidden)return this;if(this.preLayout(t),void 0===e){var n=this.padding;e=Math.max(this.maxChildWidth+n.left+n.right,this.minWidth)}if(void 0===i){n=this.padding;i=Math.max(this.maxChildHeight+n.top+n.bottom,this.minHeight)}var s;n=this.padding;s=0===this.orientation?e-n.left-n.right:i-n.top-n.bottom;var r,o,a=function(t){for(var e,i,n,s,r={lines:[],width:0,height:0},o=this.sizerChildren,a=0,h=r.lines,l=0,u=o.length;l<u;l++){if("\n"===(e=o[l]))e=void 0,s=!(i=0);else{if(e.rexSizer.hidden)continue;e.isRexSizer&&e.layout(),s=a<(i=or(e,this.orientation))}if(s){if(n){var c=t-(a+this.itemSpacing);r.width=Math.max(r.width,c),r.height+=n.height+this.lineSpacing}n={children:[],remainder:0,height:0},h.push(n),a=t}a-=i+this.itemSpacing,n.remainder=a,e&&(n.children.push(e),n.height=Math.max(n.height,ar(e,this.orientation)))}return n&&(r.height+=n.height),r}.call(this,s);0===this.orientation?i=Math.max(i,a.height+n.top+n.bottom):e=Math.max(e,a.height+left+n.right),this.resize(e,i);var h,l,u,c,d,f,v,p,g=this.left,y=this.top,m=a.lines;l=0===this.orientation?(h=g,y+this.padding.top):(h=g+this.padding.left,y);for(var x=0,k=m.length;x<k;x++){for(var b=0,w=(p=(v=m[x]).children).length;b<w;b++)n=(o=(r=p[b]).rexSizer).padding,0===this.orientation?(u=h+n.left,u+=0===b?this.padding.left:this.itemSpacing,c=l+n.top,d=r.displayWidth,f=r.displayHeight,h=u+r.displayWidth+n.right):(u=h+n.left,c=l+n.top,c+=0===b?this.padding.top:this.itemSpacing,d=r.displayWidth,f=r.displayHeight,l=c+r.displayHeight+n.bottom),Sn.setPosition(u,c).setSize(d,f),$n(r,Sn,o.align),this.resetChildPositionState(r);0===this.orientation?(h=g,l+=v.height+this.lineSpacing):(h+=v.height+this.lineSpacing,l=y)}return this.layoutBackgrounds(),this.postLayout()}},lr=Phaser.Utils.Objects.IsPlainObject,ur=Phaser.Utils.Objects.GetValue,cr=Phaser.Utils.Array.Remove,dr=Phaser.Display.Align.CENTER,fr=function(){function l(t,e,i,n,s,r,o){var a,h;return M(this,l),lr(e)?(e=ur(h=e,"x",0),i=ur(h,"y",0),n=ur(h,"width",void 0),s=ur(h,"height",void 0)):lr(n)?(n=ur(h=n,"width",void 0),s=ur(h,"height",void 0)):lr(r)?h=r:lr(o)&&(h=o),void 0!==h&&(r=ur(h,"orientation",0),o=ur(h,"space",h)),void 0===r&&(r=0),void 0===o&&(o=0),(a=I(this,E(l).call(this,t,e,i,n,s,h))).type="rexFixWidthSizer",a.sizerChildren=[],a.setOrientation(r),a.setPadding(o),a.setItemSpacing(ur(o,"item",0)),a.setLineSpacing(ur(o,"line",0)),a.addChildrenMap("items",a.sizerChildren),a}return e(l,Hs),v(l,[{key:"destroy",value:function(t){this.scene&&(this.sizerChildren.length=0,d(E(l.prototype),"destroy",this).call(this,t))}},{key:"setOrientation",value:function(t){return"string"==typeof t&&(t=Ws[t]),this.orientation=t,this}},{key:"setPadding",value:function(t){return this.padding=Fs(t,this.padding),this}},{key:"setItemSpacing",value:function(t){return this.itemSpacing=t,this}},{key:"setLineSpacing",value:function(t){return this.lineSpacing=t,this}},{key:"add",value:function(t,e,i){if("\n"===t)return this.addNewLine(),this;var n;d(E(l.prototype),"add",this).call(this,t),lr(e)&&(e=ur(n=e,"padding",0),i=ur(n,"key",void 0));return void 0===e&&(e=0),(n=this.getSizerConfig(t)).parent=this,n.align=dr,n.padding=Fs(e),this.sizerChildren.push(t),void 0!==i&&this.addChildrenMap(i,t),this}},{key:"addNewLine",value:function(){return this.sizerChildren.push("\n"),this}},{key:"insert",value:function(t,e,i,n){return this.add(e,i,n),this.moveTo(e,t),this}},{key:"remove",value:function(t){var e=this.getSizerConfig(t);return e.parent!==this||(e.parent=void 0,cr(this.sizerChildren,t),d(E(l.prototype),"remove",this).call(this,t)),this}},{key:"clear",value:function(t){for(var e,i=this.sizerChildren,n=0,s=i.length;n<s;n++)"\n"!==(e=i[n])&&(this.getSizerConfig(e).parent=void 0);return i.length=0,d(E(l.prototype),"clear",this).call(this,t),this}},{key:"maxChildWidth",get:function(){return void 0===this._maxChildWidth&&(this._maxChildWidth=function(t){void 0===t&&(t=this.sizerChildren);for(var e,i=0,n=0,s=t.length;n<s;n++)"\n"!==(e=t[n])&&(i=Math.max(i,sr(e)));return i}.call(this)),this._maxChildWidth}},{key:"maxChildHeight",get:function(){return void 0===this._maxChildHeight&&(this._maxChildHeight=function(t){void 0===t&&(t=this.sizerChildren);for(var e,i=0,n=0,s=t.length;n<s;n++)"\n"!==(e=t[n])&&(i=Math.max(i,rr(e)));return i}.call(this)),this._maxChildHeight}}]),l}();Object.assign(fr.prototype,hr),c.register("fixWidthSizer",function(t,e,i,n,s,r){var o=new fr(this.scene,t,e,i,n,s,r);return this.scene.add.existing(o),o}),ct(window,"RexPlugins.UI.FixWidthSizer",fr);var vr=Phaser.GameObjects.Graphics,pr=function(){function s(t,e,i){var n;return M(this,s),void 0===e&&(e=0),"string"==typeof e&&(shaep=gr[e]),void 0===i&&(i=0),(n=I(this,E(s).call(this,t.scene))).parent=t,n.shape=e,n.padding=i,n.setPosition().resize(),n}return e(s,vr),v(s,[{key:"destroy",value:function(){return this.parent=void 0,d(E(s.prototype),"destroy",this).call(this),this}},{key:"setPosition",value:function(t,e){var i=this.parent;return void 0===t&&(t=i.x),void 0===e&&(e=i.y),d(E(s.prototype),"setPosition",this).call(this,t,e),this}},{key:"resize",value:function(t,e,i){var n=this.parent;if(void 0===t&&(t=n.width),void 0===e&&(e=n.height),void 0===i&&(i=this.padding),this.widthSave===t&&this.heightSave===e&&this.paddingSave===i)return this;switch(this.clear().fillStyle(16777215),this.shape){case 1:var s=Math.min(t,e)/2;this.fillCircle(0,0,s+i);break;default:this.fillRect(-t*n.originX-i,-e*n.originY-i,t+2*i,e+2*i)}return this.widthSave=t,this.heightSave=e,this.paddingSave=i,this}}]),s}(),gr={rectangle:0,circle:1},yr=Phaser.Utils.Objects.GetValue,mr=function(){function k(t,e){var i;M(this,k),(i=I(this,E(k).call(this,t,e))).type="rexLabel";var n=yr(e,"background",void 0),s=yr(e,"icon",void 0),r=yr(e,"iconMask",void 0),o=yr(e,"text",void 0),a=yr(e,"action",void 0),h=yr(e,"actionMask",void 0),l=yr(e,"space.left",0),u=yr(e,"space.right",0),c=yr(e,"space.top",0),d=yr(e,"space.bottom",0),f=yr(e,"space.icon",0),v=yr(e,"space.text",0);n&&i.addBackground(n),s&&(g=0===i.orientation?{left:l,right:o||a?f:u,top:c,bottom:d}:{left:l,right:u,top:c,bottom:o||a?f:d},i.add(s,0,"center",g),r&&(r=new pr(s,1),s.setMask(r.createGeometryMask()),i.pin(r)));if(o){var p,g,y,m=yr(e,"expandTextWidth",!1),x=yr(e,"expandTextHeight",!1);y=0===i.orientation?(p=m?1:0,g={left:s?0:l,right:a?v:u,top:c,bottom:d},x):(p=x?1:0,g={left:l,right:u,top:s?0:c,bottom:a?v:d},m),i.add(o,p,"center",g,y)}a&&(g=0===i.orientation?{left:s||o?0:l,right:u,top:c,bottom:d}:{left:l,right:u,top:s||o?0:c,bottom:d},i.add(a,0,"center",g),h&&(h=new pr(a,1),s.setMask(h.createGeometryMask()),i.pin(h)));return i.addChildrenMap("background",n),i.addChildrenMap("icon",s),i.addChildrenMap("iconMask",r),i.addChildrenMap("text",o),i.addChildrenMap("action",a),i.addChildrenMap("actionMask",h),i}return e(k,Js),v(k,[{key:"setText",value:function(t){return this.text=t,this}},{key:"appendText",value:function(t){this.text+=t}},{key:"layout",value:function(t,e,i){d(E(k.prototype),"layout",this).call(this,t,e,i);var n=this.childrenMap.iconMask;n&&(n.setPosition(),this.resetChildPositionState(n));var s=this.childrenMap.actionMask;return s&&(s.setPosition(),this.resetChildPositionState(s)),this}},{key:"resize",value:function(t,e){d(E(k.prototype),"resize",this).call(this,t,e);var i=this.childrenMap.iconMask;i&&i.resize();var n=this.childrenMap.actionMask;return n&&n.resize(),this}},{key:"text",get:function(){var t=this.childrenMap.text;return void 0===t?"":t.text?t.text:t.getData("text")},set:function(t){var e=this.childrenMap.text;void 0!==e&&(e.setText?e.setText(t):e.setData("text",t))}}]),k}();c.register("label",function(t){var e=new mr(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.Label",mr);var xr=Phaser.Utils.Objects.GetValue,kr=function(){function i(t,e){M(this,i),this.gameObject=t,this.scene=qn(t),this.setEventEmitter(xr(e,"eventEmitter",void 0)),t.setInteractive(xr(e,"inputConfig",void 0)),this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){return this.pointer=void 0,this.lastClickTime=void 0,this.setEnable(xr(t,"enable",!0)),this.setMode(xr(t,"mode",1)),this.setClickInterval(xr(t,"clickInterval",100)),this.setDragThreshold(xr(t,"threshold",void 0)),this}},{key:"boot",value:function(){this.gameObject.on("pointerdown",this.onPress,this),this.gameObject.on("pointerup",this.onRelease,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onMove,this),this.gameObject.once("destroy",this.destroy,this)}},{key:"shutdown",value:function(){this.destroyEventEmitter(),this.pointer=void 0,this.gameObject=void 0,this.scene=void 0}},{key:"destroy",value:function(){this.shutdown()}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable===t||(t||this.cancel(),this.enable=t,this.gameObject.input.enabled=t),this}},{key:"setMode",value:function(t){return"string"==typeof t&&(t=Tr[t]),this.mode=t,this}},{key:"setClickInterval",value:function(t){return this.clickInterval=t,this}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"onPress",value:function(t,e,i,n){void 0===this.pointer&&(this.pointer=t,0===this.mode&&this.click(t.downTime,t,n))}},{key:"onRelease",value:function(t,e,i,n){this.pointer===t&&(1===this.mode&&this.click(t.upTime,t,n),this.pointer=void 0)}},{key:"onPointOut",value:function(t,e){this.pointer===t&&this.cancel()}},{key:"onMove",value:function(t,e,i,n){this.pointer===t&&void 0!==this.dragThreshold&&t.getDistance()>=this.dragThreshold&&this.cancel()}},{key:"click",value:function(t,e,i){if(void 0===t)return this.emit("click",this,this.gameObject,e,i),this;this.pointer=void 0;var n=this.lastClickTime;return void 0!==n&&t-n<=this.clickInterval||(this.lastClickTime=t,this.emit("click",this,this.gameObject,e,i)),this}},{key:"cancel",value:function(){return this.pointer=void 0,this}}]),i}();Object.assign(kr.prototype,hs);function br(s,t){s._buttonBehavior=new kr(s,t),s._buttonBehavior.on("click",function(t,e,i,n){Pr.call(this,"button.click",s,i,n)},this),s.on("pointerover",function(t,e,i,n){Pr.call(this,"button.over",s,t,n)},this).on("pointerout",function(t,e){Pr.call(this,"button.out",s,t,e)},this)}function wr(t){Mr(t,!1)}function Cr(t){Mr(t,!0)}function Sr(t){return!!t&&!xn(t).hidden}var Or,Tr={press:0,pointerdown:0,release:1,pointerup:1},Pr=function(t,e,i,n){var s;if("number"==typeof e){if(s=e,!(e=this.childrenMap.buttons[s]))return}else if(-1===(s=this.childrenMap.buttons.indexOf(e)))return;void 0!==this.groupName?this.eventEmitter.emit(t,e,this.groupName,s,i,n):this.eventEmitter.emit(t,e,s,i,n)},Mr=function(t,e){t&&(xn(t).hidden=e,t.setVisible(!e))},Er={getButton:function(t){var e;return"number"==typeof t?e=this.childrenMap.buttons[t]:(e=t,-1===this.childrenMap.buttons.indexOf(e)&&(e=void 0)),e},emitButtonClick:function(t){return Pr.call(this,"button.click",t),this},showButton:function(t){return wr(this.getButton(t)),this},hideButton:function(t){return Cr(this.getButton(t)),this},isButtonShown:function(t){return Sr(this.getButton(t)),this},forEachButtton:function(t,e){for(var i=this.childrenMap.buttons,n=0,s=i.length;n<s;n++)e?t.call(e,i[n],n,i):t(i[n],n,i);return this}},_r=Phaser.Utils.Objects.GetValue,Ir=function(){function d(t,e){var i;M(this,d),void 0===e&&(e={}),(i=I(this,E(d).call(this,t,e))).type="rexButtons",i.eventEmitter=_r(e,"eventEmitter",_(i)),i.groupName=_r(e,"groupName",void 0);var n=_r(e,"background",void 0),s=_r(e,"buttons",void 0);s&&0===s.length&&(s=void 0);var r=_r(e,"space",0);if(n&&i.addBackground(n),s){var o,a,h=_r(e,"align",void 0),l=_r(e,"click",void 0);"right"!==h&&"bottom"!==h&&"center"!==h||i.addSpace();for(var u=0,c=s.length;u<c;u++)o=s[u],a=0===i.orientation?{left:1<=u?r:0,right:0,top:0,bottom:0}:{left:0,right:0,top:1<=u?r:0,bottom:0},i.add(o,0,"center",a,!0),br.call(_(i),o,l);"center"===h&&i.addSpace()}return i.addChildrenMap("background",n),i.addChildrenMap("buttons",s||[]),i}return e(d,Js),d}();Object.assign(Ir.prototype,Er),c.register("buttons",function(t){var e=new Ir(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.Buttons",Ir);var jr=(o(Or={getChoice:function(t){return this.childrenMap.choicesSizer.getButton(t)},getAction:function(t){return this.childrenMap.actionsSizer.getButton(t)},emitChoiceClick:function(t){return this.childrenMap.choicesSizer.emitButtonClick(t),this},emitActionClick:function(t){return this.childrenMap.actionsSizer.emitButtonClick(t),this},showChoice:function(t){return this.childrenMap.choicesSizer.showButton(t),this},showAction:function(t){return this.childrenMap.actionsSizer.showButton(t),this},hideChoice:function(t){return this.childrenMap.choicesSizer.hideButton(t),this},hideAction:function(t){return this.childrenMap.actionsSizer.hideButton(t),this},forEachChoice:function(t,e){return this.childrenMap.choicesSizer.forEachButtton(t,e),this}},"forEachChoice",function(t,e){return this.childrenMap.choicesSizer.forEachButtton(t,e),this}),o(Or,"forEachAction",function(t,e){return this.childrenMap.actionsSizer.forEachButtton(t,e),this}),Or),Dr=Phaser.Utils.Objects.GetValue,zr=function(){function T(t,e){var i;M(this,T),void 0===e&&(e={}),e.orientation=1,(i=I(this,E(T).call(this,t,e))).type="rexDialog",i.eventEmitter=Dr(e,"eventEmitter",_(i));var n=Dr(e,"background",void 0),s=Dr(e,"title",void 0),r=Dr(e,"toolbar",void 0);r&&0===r.length&&(r=void 0);var o,a,h=Dr(e,"content",void 0),l=Dr(e,"description",void 0),u=Dr(e,"choices",void 0);u&&0===u.length&&(u=void 0);var c=Dr(e,"actions",void 0);c&&0===c.length&&(c=void 0);var d,f=Dr(e,"click",void 0),v=Dr(e,"space.left",0),p=Dr(e,"space.right",0),g=Dr(e,"space.top",0),y=Dr(e,"space.bottom",0);if(n&&i.addBackground(n),s&&!r){var m=Dr(e,"align.title","center"),x=Dr(e,"space.title",0),k={left:v,right:p,top:g,bottom:h||l||u||c?x:y},b=Dr(e,"expand.title",!0);i.add(s,0,m,k,b)}if(r&&(d=new Ir(t,{groupName:"toolbar",buttons:r,orientation:0,space:Dr(e,"space.toolbarItem",0),click:f,eventEmitter:i.eventEmitter})),r&&!s){x=Dr(e,"space.title",0),k={left:v,right:p,top:g,bottom:h||l||u||c?x:y},b=Dr(e,"expand.toolbar",!0);i.add(d,0,"center",k,b)}if(s&&r){var w=new Js(t,{orientation:0});m=Dr(e,"align.title","left");(b=Dr(e,"expand.title",!0))||"right"!==m&&"center"!==m||w.addSpace();k={left:Dr(e,"space.titleLeft",0),right:Dr(e,"space.titleRight",0),top:0,bottom:0};w.add(s,b?1:0,"center",k,b),b||"left"!==m&&"center"!==m||w.addSpace(),w.add(d,0,"right",0,!1);x=Dr(e,"space.title",0),k={left:v,right:p,top:g,bottom:h||l||u||c?x:y};i.add(w,0,"center",k,!0)}if(h){m=Dr(e,"align.content","center");var C=Dr(e,"space.content",0);k={left:v+Dr(e,"space.contentLeft",0),right:p+Dr(e,"space.contentRight",0),top:s||r?0:g,bottom:l||u||c?C:y},b=Dr(e,"expand.content",!0);i.add(h,0,m,k,b)}if(l){m=Dr(e,"align.description","center");var S=Dr(e,"space.description",0);k={left:v+Dr(e,"space.descriptionLeft",0),right:p+Dr(e,"space.descriptionRight",0),top:s||r||h?0:g,bottom:u||c?S:y},b=Dr(e,"expand.description",!0);i.add(l,0,m,k,b)}if(u){m=Dr(e,"align.choices","center");o=new Ir(t,{groupName:"choices",buttons:u,orientation:1,space:Dr(e,"space.choice",0),click:f,eventEmitter:i.eventEmitter});var O=Dr(e,"space.choices",0);k={left:v+Dr(e,"space.choicesLeft",0),right:p+Dr(e,"space.choicesRight",0),top:s||r||h||l?0:g,bottom:c?O:y},b=Dr(e,"expand.choices",!0);i.add(o,0,m,k,b)}if(c){a=new Ir(t,{groupName:"actions",buttons:c,orientation:0,space:Dr(e,"space.action",0),align:Dr(e,"align.actions","center"),click:f,eventEmitter:i.eventEmitter});k={left:v+Dr(e,"space.actionsLeft",0),right:p+Dr(e,"space.actionsRight",0),top:s||r||h||l||u?0:g,bottom:y},b=Dr(e,"expand.actions",!0);i.add(a,0,"center",k,b)}return i.addChildrenMap("background",n),i.addChildrenMap("title",s),i.addChildrenMap("toolbar",r),i.addChildrenMap("content",h),i.addChildrenMap("choices",u),i.addChildrenMap("actions",c),i.addChildrenMap("choicesSizer",o),i.addChildrenMap("actionsSizer",a),i}return e(T,Js),T}();Object.assign(zr.prototype,jr),c.register("dialog",function(t){var e=new zr(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.Dialog",zr);var Rr={getButtonsSizer:function(t){return this.childrenMap[t+"ButtonsSizer"]},getButton:function(t,e){var i=this.getButtonsSizer(t);return i?i.getButton(e):void 0},emitButtonClick:function(t,e){var i=this.getButtonsSizer(t);return i&&i.emitButtonClick(e),this},emitLeftButtonClick:function(t){return this.childrenMap.leftButtonsSizer.emitButtonClick(t),this},emitRightButtonClick:function(t){return this.childrenMap.rightButtonsSizer.emitButtonClick(t),this},emitTopButtonClick:function(t){return this.childrenMap.topButtonsSizer.emitButtonClick(t),this},emitBottomButtonClick:function(t){return this.childrenMap.bottomButtonsSizer.emitButtonClick(t),this},getLeftButton:function(t){return this.childrenMap.leftButtonsSizer.getButton(t)},getRightButton:function(t){return this.childrenMap.rightButtonsSizer.getButton(t)},getTopButton:function(t){return this.childrenMap.topButtonsSizer.getButton(t)},getBottomButton:function(t){return this.childrenMap.bottomButtonsSizer.getButton(t)},showButton:function(t,e){return wr(this.getButton(t,e)),this},showLeftButton:function(t){return wr(this.getLeftButton(t)),this},showRightButton:function(t){return wr(this.getRightButton(t)),this},showTopButton:function(t){return wr(this.getTopButton(t)),this},showBottomButton:function(t){return wr(this.getBottomButton(t)),this},hideButton:function(t,e){return Cr(this.getButton(t,e)),this},hideLeftButton:function(t){return Cr(this.getLeftButton(t)),this},hideRightButton:function(t){return Cr(this.getRightButton(t)),this},hideTopButton:function(t){return Cr(this.getTopButton(t)),this},hideBottomButton:function(t){return Cr(this.getBottomButton(t)),this},forEachLeftButton:function(t,e){return this.childrenMap.leftButtonsSizer.forEachButtton(t,e),this},forEachRightButton:function(t,e){return this.childrenMap.rightButtonsSizer.forEachButtton(t,e),this},forEachTopButton:function(t,e){return this.childrenMap.topButtonsSizer.forEachButtton(t,e),this},forEachBottomButton:function(t,e){return this.childrenMap.bottomButtonsSizer.forEachButtton(t,e),this}},Br=Phaser.Utils.Objects.GetValue,Yr=function(){function P(t,e){var i;M(this,P),void 0===e&&(e={}),e.column=3,e.row=3,(i=I(this,E(P).call(this,t,e))).type="rexTabs",i.eventEmitter=Br(e,"eventEmitter",_(i));var n,s=Br(e,"background",void 0),r=Br(e,"panel",void 0),o=Br(e,"leftButtons",void 0);o&&0===o.length&&(o=void 0);var a,h=Br(e,"rightButtons",void 0);h&&0===h.length&&(h=void 0);var l,u=Br(e,"topButtons",void 0);u&&0===u.length&&(u=void 0);var c,d=Br(e,"bottomButtons",void 0);d&&0===d.length&&(d=void 0);var f=Br(e,"click",void 0),v=Br(e,"space.left",0),p=Br(e,"space.right",0),g=Br(e,"space.top",0),y=Br(e,"space.bottom",0),m=Br(e,"space.leftButtonsOffset",0),x=Br(e,"space.rightButtonsOffset",0),k=Br(e,"space.topButtonsOffset",0),b=Br(e,"space.bottomButtonsOffset",0),w=Br(e,"space.leftButton",0),C=Br(e,"space.rightButton",0),S=Br(e,"space.topButton",0),O=Br(e,"space.bottomButton",0);if(s&&i.addBackground(s),r){var T={left:o?0:v,right:h?0:p,top:u?0:g,bottom:d?0:y};i.add(r,1,1,"center",T,!0)}if(o){n=new Ir(t,{groupName:"left",buttons:o,orientation:1,space:w,align:Br(e,"align.leftButtons",void 0),click:f,eventEmitter:i.eventEmitter});T={left:v,top:m};i.add(n,0,1,"top",T,!1)}if(h){a=new Ir(t,{groupName:"right",buttons:h,orientation:1,space:C,align:Br(e,"align.rightButtons",void 0),click:f,eventEmitter:i.eventEmitter});T={right:p,top:x};i.add(a,2,1,"top",T,!1)}if(u){l=new Ir(t,{groupName:"top",buttons:u,orientation:0,space:S,align:Br(e,"align.topButtons",void 0),click:f,eventEmitter:i.eventEmitter});T={top:g,left:k};i.add(l,1,0,"left",T,!1)}if(d){c=new Ir(t,{groupName:"bottom",buttons:d,orientation:0,space:O,align:Br(e,"align.bottomButtons",void 0),click:f,eventEmitter:i.eventEmitter});T={bottom:y,left:b};i.add(c,1,2,"left",T,!1)}return i.addChildrenMap("background",s),i.addChildrenMap("panel",r),i.addChildrenMap("leftButtons",o),i.addChildrenMap("rightButtons",h),i.addChildrenMap("topButtons",u),i.addChildrenMap("bottomButtons",d),i.addChildrenMap("leftButtonsSizer",n),i.addChildrenMap("rightButtonsSizer",a),i.addChildrenMap("topButtonsSizer",l),i.addChildrenMap("bottomButtonsSizer",c),i}return e(P,nr),P}();Object.assign(Yr.prototype,Rr),c.register("tabs",function(t){var e=new Yr(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.Tabs",Yr);function Lr(t,e,i){var n,s,r;return t.y===e.y?(n=Math.min(t.x,e.x),s=Math.max(t.x,e.x),r=Xr(i.x,n,s)):t.x===e.x&&(n=Math.min(t.y,e.y),s=Math.max(t.y,e.y),r=Xr(i.y,n,s)),r}function Hr(t,e,i){this.enable&&(Wr.x=e,Wr.y=i,this.value=Lr(this.getStartPoint(),this.getEndPoint(),Wr))}function Fr(t,e,i){this.enable&&t.isDown&&(Ar.x=t.worldX,Ar.y=t.worldY,this.value=Lr(this.getStartPoint(),this.getEndPoint(),Ar))}function Vr(t,e){void 0===e&&(e=Gr);var i=this.childrenMap.thumb,n=i.x,s=i.y;return $n(i,this,t),e.x=i.x,e.y=i.y,i.x=n,i.y=s,e}var Xr=Phaser.Math.Percent,Wr={},Ar={},Gr={},Ur=Phaser.Display.Align.LEFT_CENTER,Nr=Phaser.Display.Align.TOP_CENTER,Jr={},Zr=Phaser.Display.Align.RIGHT_CENTER,Kr=Phaser.Display.Align.BOTTOM_CENTER,qr={},$r=Phaser.Math.Linear,Qr={},to=Phaser.Display.Align.LEFT_CENTER,eo=Phaser.Display.Align.TOP_CENTER,io=Phaser.Utils.Objects.GetValue,no=Phaser.Math.Clamp,so=Phaser.Math.Linear,ro=Phaser.Math.Percent,oo=Phaser.Math.Snap.To,ao=function(){function p(t,e){var i;M(this,p),(i=I(this,E(p).call(this,t,e))).type="rexSlider",i.eventEmitter=io(e,"eventEmitter",_(i));var n=io(e,"background",void 0),s=io(e,"track",void 0),r=io(e,"indicator",void 0),o=io(e,"thumb",void 0),a=io(e,"space.left",0),h=io(e,"space.right",0),l=io(e,"space.top",0),u=io(e,"space.bottom",0);if(n&&i.addBackground(n),s){var c={left:a,right:h,top:l,bottom:u};i.add(s,0,void 0,c,!0)}r&&i.add(r,null),o&&i.add(o,null);var d=io(e,"input",0);switch("string"==typeof d&&(d=ho[d]),d){case 0:o&&(o.setInteractive(),i.scene.input.setDraggable(o),o.on("drag",Hr,_(i)));break;case 1:i.setInteractive().on("pointerdown",Fr,_(i)).on("pointermove",Fr,_(i))}i.addChildrenMap("background",n),i.addChildrenMap("track",s),i.addChildrenMap("indicator",r),i.addChildrenMap("thumb",o);var f=io(e,"valuechangeCallback",null);if(null!==f){var v=io(e,"valuechangeCallbackScope",void 0);i.eventEmitter.on("valuechange",f,v)}return i.setEnable(io(e,"enable",void 0)),i.setGap(io(e,"gap",void 0)),i.setValue(io(e,"value",0)),i}return e(p,Js),v(p,[{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable=t,this}},{key:"setGap",value:function(t){return this.gap=t,this}},{key:"setValue",value:function(t,e,i){return null==t||(void 0!==e&&(t=ro(t,e,i)),this.value=t),this}},{key:"addValue",value:function(t,e,i){return void 0!==e&&(t=ro(t,e,i)),this.value+=t,this}},{key:"getValue",value:function(t,e){var i=this.value;return void 0!==t&&(i=so(t,e,i)),i}},{key:"layout",value:function(t,e,i){return d(E(p.prototype),"layout",this).call(this,t,e,i),this.updateThumb(),this.updateIndicator(),this}},{key:"value",get:function(){return this._value},set:function(t){void 0!==this.gap&&(t=oo(t,this.gap));var e=this._value;this._value=no(t,0,1),e!==this._value&&(this.updateThumb(this._value),this.updateIndicator(this._value),this.eventEmitter.emit("valuechange",this._value,e,this.eventEmitter))}}]),p}(),ho={drag:0,click:1,none:-1},lo={getStartPoint:function(t){if(void 0===t&&(t=Jr),this.childrenMap.thumb){var e=0===this.orientation?Nr:Ur;Vr.call(this,e,t)}else 0===this.orientation?(t.x=this.centerX,t.y=this.top+1):(t.x=this.left+1,t.y=this.centerY);return t},getEndPoint:function(t){if(void 0===t&&(t=qr),this.childrenMap.thumb){var e=1===this.orientation?Zr:Kr;Vr.call(this,e,t)}else 0===this.orientation?(t.x=this.centerX,t.y=this.bottom-1):(t.x=this.right-1,t.y=this.centerY);return t},updateThumb:function(t){var e=this.childrenMap.thumb;return void 0===e||(void 0===t&&(t=this.value),function(t,e,i,n){void 0===n&&(n=Qr),n.x=$r(e.x,i.x,t),n.y=$r(e.y,i.y,t)}(t,this.getStartPoint(),this.getEndPoint(),e),this.resetChildPositionState(e)),this},updateIndicator:function(t){var e,i,n=this.childrenMap.indicator;if(void 0===n)return this;void 0===t&&(t=this.value);var s=this.childrenMap.thumb;s?0===this.orientation?i=s.y-s.displayHeight*s.originY+s.displayHeight-this.top:e=s.x-s.displayWidth*s.originX+s.displayWidth-this.left:0===this.orientation?i=this.height*t:e=this.width*t;zs(n,e,i);var r=1===this.orientation?to:eo;$n(n,this,r),this.resetChildPositionState(n)}};Object.assign(ao.prototype,lo),c.register("slider",function(t){var e=new ao(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.Slider",ao);function uo(t,e){var i=fo(t,"scrollMode",0);return"string"==typeof i&&(i=co[i]),i}var co={v:0,vertical:0,h:1,horizontal:1},fo=Phaser.Utils.Objects.GetValue,vo=function(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1===e.indexOf("."))return i;for(var n=e.split("."),s=t,r=i,o=0;o<n.length;o++){if(!s.hasOwnProperty(n[o])){r=i;break}r=s[n[o]],s=s[n[o]]}return r}return i},po=function(){function o(t){M(this,o);var e=vo(t,"states",void 0);e&&this.addStates(e);var i=vo(t,"extend",void 0);if(i)for(var n in i)this.hasOwnProperty(n)&&void 0!==this[n]||(this[n]=i[n]);var s=vo(t,"eventEmitter",void 0),r=vo(t,"EventEmitterClass",void 0);this.setEventEmitter(s,r),this._stateLock=!1,this.resetFromJSON(t)}return v(o,[{key:"shutdown",value:function(){this.destroyEventEmitter()}},{key:"destroy",value:function(){this.shutdown()}},{key:"resetFromJSON",value:function(t){this.setEnable(vo(t,"enable",!0)),this.start(vo(t,"start",void 0));var e=vo(t,"init",void 0);return e&&e.call(this),this}},{key:"toJSON",value:function(){return{curState:this.state,prevState:this.prevState,enable:this.enable,start:this._start}}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable=t,this}},{key:"start",value:function(t){return this._start=t,this._prevState=void 0,this._state=t,this}},{key:"goto",value:function(t){return null!=t&&(this.state=t),this}},{key:"next",value:function(){var t,e=this["next_"+this.state];return e&&(t="string"==typeof e?e:e.call(this)),this.goto(t),this}},{key:"addState",value:function(t,e){var i=vo(e,"next",void 0);i&&(this["next_"+t]=i);var n=vo(e,"exit",void 0);n&&(this["exit_"+t]=n);var s=vo(e,"enter",void 0);return s&&(this["enter_"+t]=s),this}},{key:"addStates",value:function(t){for(var e in t)this.addState(e,t[e]);return this}},{key:"update",value:function(t,e,i){void 0===i&&(i="update");var n=this[i+"_"+this.state];n&&n.call(this,t,e)}},{key:"preupdate",value:function(t,e){this.update(t,e,"preupdate")}},{key:"postupdate",value:function(t,e){this.update(t,e,"postupdate")}},{key:"state",set:function(t){if(this.enable&&!this._stateLock&&this._state!==t){if(this._prevState=this._state,this._state=t,this._stateLock=!0,this.emit("statechange",this),null!=this._prevState){var e="exit_"+this._prevState,i=this[e];i&&i.call(this),this.emit(e,this)}if(this._stateLock=!1,null!=this._state){var n="enter_"+this._state,s=this[n];s&&s.call(this),this.emit(n,this)}}},get:function(){return this._state}},{key:"prevState",get:function(){return this._prevState}}]),o}();Object.assign(po.prototype,hs);var go=function(){function n(t,e){var i;return M(this,n),(i=I(this,E(n).call(this,e))).parent=t,i.init(),i}return e(n,po),v(n,[{key:"init",value:function(){this.start("IDLE")}},{key:"next_IDLE",value:function(){var t,e=this.parent;return e.dragState.isDown&&(t=0===e.dragThreshold?"DRAG":"DRAGBEGIN"),t}},{key:"update_IDLE",value:function(t,e){this.next()}},{key:"next_DRAGBEGIN",value:function(){var t=this.parent,e=t.dragState;return e.isDown?e.pointer.getDistance()>=t.dragThreshold?"DRAG":"DRAGBEGIN":"IDLE"}},{key:"update_DRAGBEGIN",value:function(t,e){this.next()}},{key:"next_DRAG",value:function(){var t,e=this.parent;return e.dragState.isUp&&(t=e.outOfBounds?"BACK":e.slidingEnable?"SLIDE":"IDLE"),t}},{key:"update_DRAG",value:function(t,e){var i=this.parent;i.dragState.justMoved&&i.dragging(),this.next()}},{key:"next_SLIDE",value:function(){var t,e=this.parent;return e.dragState.isDown?t="DRAG":e.isSliding||(t="IDLE"),t}},{key:"enter_SLIDE",value:function(){this.parent.onSliding()}},{key:"exit_SLIDE",value:function(){this.parent.stop()}},{key:"update_SLIDE",value:function(t,e){this.parent.sliding(t,e),this.next()}},{key:"next_BACK",value:function(){var t,e=this.parent;return e.dragState.isDown?t="DRAG":e.isPullBack||(t="IDLE"),t}},{key:"enter_BACK",value:function(){this.parent.onPullBack()}},{key:"exit_BACK",value:function(){this.parent.stop()}},{key:"update_BACK",value:function(t,e){this.parent.pullBack(t,e),this.next()}}]),n}(),yo=Phaser.Utils.Objects.GetValue,mo=Phaser.Math.Distance.Between,xo=function(){function i(t,e){M(this,i),this.gameObject=t,this.scene=qn(t),this.setEventEmitter(yo(e,"eventEmitter",void 0)),t.setInteractive(yo(e,"inputConfig",void 0)),this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){return this.pointer=void 0,this.isInTouched=!1,this.holdStartTime=void 0,this.x=void 0,this.y=void 0,this.preX=void 0,this.preY=void 0,this.localX=void 0,this.localY=void 0,this.justMoved=!1,this.setEnable(yo(t,"enable",!0)),this.holdThreshold=yo(t,"holdThreshold",50),this}},{key:"boot",value:function(){this.gameObject.on("pointerdown",this.onPointIn,this),this.gameObject.on("pointerover",this.onPointIn,this),this.gameObject.on("pointerup",this.onPointOut,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onPointerMove,this),this.gameObject.once("destroy",this.destroy,this),this.scene.events.on("preupdate",this.preupdate,this)}},{key:"shutdown",value:function(){this.scene&&this.scene.events.off("preupdate",this.preupdate,this),this.pointer=void 0,this.gameObject=void 0,this.scene=void 0,this.destroyEventEmitter()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable===t||(t||(this.isInTouched=!1,this.pointer=void 0),this.enable=t,this.gameObject.input.enabled=t),this}},{key:"onPointIn",value:function(t,e,i){t.isDown&&void 0===this.pointer&&(this.pointer=t,this.localX=e,this.localY=i)}},{key:"onPointOut",value:function(t){this.pointer===t&&(this.pointer=void 0)}},{key:"onPointerMove",value:function(t,e,i){t.isDown&&this.pointer===t&&(this.localX=e,this.localY=i)}},{key:"preupdate",value:function(t,e){var i=this.pointer;this.justMoved=!1,i&&!this.isInTouched?(this.x=i.x,this.y=i.y,this.preX=i.x,this.preY=i.y,this.isInTouched=!0,this.holdStartTime=void 0,this.emit("touchstart",i,this.localX,this.localY)):i&&this.isInTouched?this.x===i.x&&this.y===i.y?void 0===this.holdStartTime?this.holdStartTime=t:t-this.holdStartTime>this.holdThreshold&&(this.preX=this.x,this.preY=this.y):(this.preX=this.x,this.preY=this.y,this.x=i.x,this.y=i.y,this.holdStartTime=void 0,this.justMoved=!0,this.emit("touchmove",i,this.localX,this.localY)):!i&&this.isInTouched&&(this.isInTouched=!1,this.holdStartTime=void 0,this.emit("touchend",i))}},{key:"isDown",get:function(){return this.pointer&&this.pointer.isDown}},{key:"isUp",get:function(){return!this.isDown}},{key:"dx",get:function(){return this.x-this.preX}},{key:"dy",get:function(){return this.y-this.preY}},{key:"dt",get:function(){return this.scene.sys.game.loop.delta}},{key:"speed",get:function(){return this.x===this.preX&&this.y===this.preY?0:mo(this.preX,this.preY,this.x,this.y)/(.001*this.dt)}},{key:"speedX",get:function(){return this.dx/(.001*this.dt)}},{key:"speedY",get:function(){return this.dy/(.001*this.dt)}}]),i}();Object.assign(xo.prototype,hs);var ko=Phaser.Utils.Objects.GetValue,bo=function(){function e(t){M(this,e),this.resetFromJSON(t)}return v(e,[{key:"resetFromJSON",value:function(t){return this.setValue(ko(t,"value",0)),this.setSpeed(ko(t,"speed",0)),this.setAcceleration(ko(t,"acceleration",0)),this}},{key:"reset",value:function(){this.setValue(0),this.setSpeed(0),this.setAcceleration(0)}},{key:"setValue",value:function(t){return this.value=t,this}},{key:"setSpeed",value:function(t){return this.speed=t,this}},{key:"setAcceleration",value:function(t){return this.acceleration=t,this}},{key:"updateSpeed",value:function(t){return 0!==this.acceleration&&(this.speed+=this.acceleration*t,this.speed<0&&(this.speed=0)),this}},{key:"getDeltaValue",value:function(t){return this.updateSpeed(t),this.speed<=0?0:this.speed*t}},{key:"update",value:function(t){return this.updateSpeed(t),0<this.speed&&(this.value+=this.getDeltaValue(t)),this}},{key:"isMoving",get:function(){return 0<this.speed}}]),e}(),wo=function(){function t(){M(this,t),this.value,this.dir,this.movement=new bo}return v(t,[{key:"init",value:function(t,e,i,n,s){return this.value=t,this.end=s,this.dir=void 0!==s?t<s:e,this.movement.setSpeed(i).setAcceleration(-n),this}},{key:"stop",value:function(){this.movement.reset()}},{key:"update",value:function(t){var e=this.movement.getDeltaValue(t);return this.dir||(e=-e),void 0===this.end?this.value+=e:0===e?this.value=this.end:(this.value+=e,this.dir?this.value>this.end&&(this.value=this.end):this.value<this.end&&(this.value=this.end)),this}},{key:"isMoving",get:function(){return this.movement.isMoving}}]),t}(),Co=Phaser.Utils.Objects.GetValue,So=function(){function a(t,e){M(this,a),this.gameObject=t,this.scene=qn(t),this.setEventEmitter(Co(e,"eventEmitter",void 0));var i=Co(e,"enable",!0),n={enable:i,eventEmitter:!1};this._state=new go(this,n);var s={inputConfig:Co(e,"inputConfig",void 0),enable:i,eventEmitter:!1};this.dragState=new xo(t,s),this._value=void 0,this._slowDown=new wo;var r=Co(e,"valuechangeCallback",null);if(null!==r){var o=Co(e,"valuechangeCallbackScope",void 0);this.on("valuechange",r,o)}if(null!==(r=Co(e,"overmaxCallback",null))){o=Co(e,"overmaxCallbackScope",void 0);this.on("overmax",r,o)}if(null!==(r=Co(e,"overminCallback",null))){o=Co(e,"overminCallbackScope",void 0);this.on("overmin",r,o)}this.resetFromJSON(e),this.boot()}return v(a,[{key:"resetFromJSON",value:function(t){this.setOrientationMode(Co(t,"orientation",0)),this.setDragThreshold(Co(t,"threshold",10)),this.setSlidingDeceleration(Co(t,"slidingDeceleration",5e3)),this.setBackDeceleration(Co(t,"backDeceleration",2e3));var e=Co(t,"bounds",void 0);return e?this.setBounds(e):this.setBounds(Co(t,"max",0),Co(t,"min",0)),this.setValue(Co(t,"value",this.maxValue||0)),this.setEnable(Co(t,"enable",!0)),this}},{key:"boot",value:function(){this.scene.events.on("update",this._state.update,this._state),this.gameObject.once("destroy",this.destroy,this)}},{key:"shutdown",value:function(){this.destroyEventEmitter(),this.scene&&this.scene.events.off("update",this._state.update,this._state),this.gameObject=void 0,this.scene=void 0,this._state.destroy(),this.dragState.destroy()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setOrientationMode",value:function(t){return"string"==typeof t&&(t=Oo[t]),this.orientationMode=t,this}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"setSlidingDeceleration",value:function(t){return this.slidingDeceleration=t,this}},{key:"setBackDeceleration",value:function(t){return this.backDeceleration=t,this}},{key:"setBounds",value:function(t,e){if(Array.isArray(t)){var i=t;t=i[0],e=i[1]}return t<e?(this.minValue=t,this.maxValue=e):(this.minValue=e,this.maxValue=t),this}},{key:"setValue",value:function(t){this.value=t}},{key:"setEnable",value:function(t){return this._state.setEnable(t),this.dragState.setEnable(t),this}},{key:"overMax",value:function(t){return null!=this.maxValue&&t>this.maxValue}},{key:"overMin",value:function(t){return null!=this.minValue&&t<this.minValue}},{key:"dragging",value:function(){this.value+=this.dragDelta}},{key:"onSliding",value:function(){var t=this.value,e=this.dragSpeed;if(0===e)return this._slowDown.stop(),void this._state.next();var i=this.slidingDeceleration;this._slowDown.init(t,0<e,Math.abs(e),i)}},{key:"sliding",value:function(t,e){e*=.001;var i=this._slowDown.update(e).value;this.overMax(i)?(this.value=this.maxValue,this._slowDown.stop()):this.overMin(i)?(this.value=this.minValue,this._slowDown.stop()):this.value=i}},{key:"onPullBack",value:function(){var t=this.value,e=this.outOfMinBound?this.minValue:this.maxValue,i=Math.abs(e-t),n=this.backDeceleration,s=Math.sqrt(2*n*i);this._slowDown.init(t,void 0,s,n,e)}},{key:"pullBack",value:function(t,e){e*=.001,this.value=this._slowDown.update(e).value,this._slowDown.isMoving||this._state.next()}},{key:"stop",value:function(){this._slowDown.stop()}},{key:"value",get:function(){return this._value},set:function(t){if(t!==this._value){var e=this._value,i=this.overMax(t),n=this.overMin(t);i&&this.emit("overmax",t,e),n&&this.emit("overmin",t,e),this.backEnable||(i&&(t=this.maxValue),n&&(t=this.minValue)),this._value=t,this.emit("valuechange",t,e)}}},{key:"state",get:function(){return this._state.state}},{key:"isDragging",get:function(){return this.dragState.isInTouched}},{key:"outOfMaxBound",get:function(){return this.overMax(this.value)}},{key:"outOfMinBound",get:function(){return this.overMin(this.value)}},{key:"outOfBounds",get:function(){return this.outOfMinBound||this.outOfMaxBound}},{key:"backEnable",get:function(){return"number"==typeof this.backDeceleration}},{key:"isPullBack",get:function(){return this._slowDown.isMoving}},{key:"slidingEnable",get:function(){return"number"==typeof this.slidingDeceleration}},{key:"isSliding",get:function(){return this._slowDown.isMoving}},{key:"dragDelta",get:function(){return 0===this.orientationMode?this.dragState.dy:1===this.orientationMode?this.dragState.dx:0}},{key:"dragSpeed",get:function(){return 0===this.orientationMode?this.dragState.speedY:1===this.orientationMode?this.dragState.speedX:0}}]),a}();Object.assign(So.prototype,hs);var Oo={y:0,v:0,vertical:0,x:1,h:1,horizontal:1},To=Phaser.Utils.Objects.GetValue,Po=Phaser.Utils.Objects.GetValue,Mo=function(){function y(t,e){var i;M(this,y),void 0===e&&(e={});var n=uo(e);e.orientation=0===n?1:0,(i=I(this,E(y).call(this,t,e))).type=Po(e,"type","rexScrollable");var s=Po(e,"background",void 0),r=function(t){var e,i,n=this.scene,s=uo(t),r=new Js(n,{orientation:s}),o=To(t,"child.gameObject",void 0),a=To(t,"slider",void 0),h=To(t,"scroller",!0);if(o){var l=To(t,"space.child",0);if(this.childPadding={},"number"!=typeof l){var u=l;0===s?(l=To(u,"right",0),this.childPadding.top=To(u,"top",0),this.childPadding.bottom=To(u,"bottom",0)):(l=To(u,"bottom",0),this.childPadding.top=To(u,"left",0),this.childPadding.bottom=To(u,"right",0))}else this.childPadding.top=0,this.childPadding.bottom=0;var c,d=To(t,"child.proportion",1),f=To(t,"child.expand",!0);c=0===s?{right:a?l:0}:{bottom:a?l:0},r.add(o,d,"center",c,f),a&&(!0===a&&(a={}),a.orientation=r.orientation,e=new ao(n,a),r.add(e,0,"center",0,!0)),h&&(!0===h&&(h={}),h.orientation=s,i=new So(o,h))}return e&&e.on("valuechange",function(t){this.t=t},this),i&&i.on("valuechange",function(t){this.childOY=t},this),this.addChildrenMap("child",o),this.addChildrenMap("slider",e),this.addChildrenMap("scroller",i),r}.call(_(i),e),o=Po(e,"header",void 0),a=Po(e,"footer",void 0),h=Po(e,"space.left",0),l=Po(e,"space.right",0),u=Po(e,"space.top",0),c=Po(e,"space.bottom",0);if(s&&i.addBackground(s),o){var d=Po(e,"align.header","center"),f=Po(e,"space.header",0);p=0===n?{left:h,right:l,top:u,bottom:f}:{left:h,right:f,top:u,bottom:c};var v=Po(e,"expand.header",!0);i.add(o,0,d,p,v)}r&&(p=0===n?{left:h,right:l,top:o?0:u,bottom:a?0:c}:{left:o?0:h,right:a?0:l,top:u,bottom:c},i.add(r,1,"center",p,!0));if(a){d=Po(e,"align.footer","center");var p,g=Po(e,"space.footer",0);p=0===n?{left:h,right:l,top:g,bottom:c}:{left:g,right:l,top:u,bottom:c};v=Po(e,"expand.footer",!0);i.add(a,0,d,p,v)}return i.addChildrenMap("background",s),i.addChildrenMap("header",o),i.addChildrenMap("footer",a),i}return e(y,Js),v(y,[{key:"layout",value:function(t,e,i){return d(E(y.prototype),"layout",this).call(this,t,e,i),this.resizeController(),this}},{key:"resizeController",value:function(){var t=this.topChildOY,e=this.bottomChildOY,i=this.childrenMap.scroller,n=this.childrenMap.slider;return i&&i.setBounds(e,t),n&&n.setEnable(e!==t),this.updateController(),this}},{key:"updateController",value:function(){var t=this.childrenMap.scroller,e=this.childrenMap.slider;t&&t.setValue(this.childOY),e&&e.setValue(this.t)}},{key:"setChildOY",value:function(t){return this.childOY=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"scrollToTop",value:function(){return this.t=0,this}},{key:"scrollToBottom",value:function(){return this.t=1,this}},{key:"setSliderEnable",value:function(t){return void 0===t&&(t=!0),this.sliderEnable=t,this}},{key:"setScrollerEnable",value:function(t){return void 0===t&&(t=!0),this.scrollerEnable=t,this}},{key:"t",set:function(t){var e=this.childPadding;if(0!==e.top||0!==e.bottom){var i=this.childrenMap.child,n=i.topChildOY-i.bottomChildOY;t=((n+e.top+e.bottom)*t-e.top)/n}this.childrenMap.child.t=t,this.updateController()},get:function(){var t=this.childrenMap.child.t,e=this.childPadding;if(0!==e.top||0!==e.bottom){var i=this.childrenMap.child,n=i.topChildOY-i.bottomChildOY,s=n+e.top+e.bottom;t=(n*t+e.top)/s}return t}},{key:"childOY",set:function(t){this.childrenMap.child.childOY=t,this.updateController()},get:function(){return this.childrenMap.child.childOY}},{key:"topChildOY",get:function(){return this.childrenMap.child.topChildOY+this.childPadding.top}},{key:"bottomChildOY",get:function(){return this.childrenMap.child.bottomChildOY-this.childPadding.bottom}},{key:"sliderEnable",get:function(){var t=this.childrenMap.slider;if(t)return t.enable},set:function(t){var e=this.childrenMap.slider;e&&e.setEnable(t)}},{key:"scrollerEnable",get:function(){var t=this.childrenMap.scroller;if(t)return t.enable},set:function(t){var e=this.childrenMap.scroller;e&&e.setEnable(t)}}]),y}(),Eo={enableData:function(){return void 0===this.data&&(this.data={}),this},getData:function(t,e){return this.enableData(),void 0===t?this.data:vo(this.data,t,e)},setData:function(t,e){return this.enableData(),this.data[t]=e,this},incData:function(t,e,i){return void 0===i&&(i=0),this.enableData(),this.setData(t,this.getData(t,i)+e),this},mulData:function(t,e,i){return void 0===i&&(i=0),this.enableData(),this.setData(t,this.getData(t,i)*e),this},clearData:function(){return this.data&&gt(this.data),this}},_o=function(){function i(t,e){M(this,i),this.container=null,this.setParent(t),this._deltaHeight=0}return v(i,[{key:"setParent",value:function(t){this.parent=t,this.parentContainer=t.getParentContainer()}},{key:"destroy",value:function(t){if(void 0===t&&(t=!1),!t){var e=this.parent;0!==this.deltaHeight&&e.nonZeroDeltaHeightCount--,this.destroyContainer()}this.data=void 0,this.container=null,this.parent=void 0,this.parentContainer=void 0}},{key:"getContainer",value:function(){return this.container}},{key:"setContainer",value:function(t){return this.container&&this.container.destroy(),this.container=t,this.parentContainer.add(t),this}},{key:"destroyContainer",value:function(){return this.container&&(this.container.destroy(),this.container=null),this}},{key:"popContainer",value:function(){if(this.container){var t=this.container;return this.container=null,this.parentContainer.remove(t),t}return null}},{key:"setXY",value:function(t,e){return this.container&&this.parentContainer.setChildLocalPosition(this.container,t,e),this}},{key:"setDeltaHeight",value:function(t){return this.deltaHeight=t,this}},{key:"setHeight",value:function(t){return this.height=t,this}},{key:"setWidth",value:function(t){return this.width=t,this}},{key:"table",get:function(){return this.parent}},{key:"scrollMode",get:function(){return this.parentContainer.scrollMode}},{key:"colIndx",get:function(){return this.parent.cellIndxeToColIndex(this.index)}},{key:"rowIndx",get:function(){return this.parent.cellIndxeToRowIndex(this.index)}},{key:"deltaHeight",get:function(){return this._deltaHeight},set:function(t){null==t&&(t=0);var e=this.parent;0===this._deltaHeight&&0!==t?e.nonZeroDeltaHeightCount++:0!==this._deltaHeight&&0===t&&e.nonZeroDeltaHeightCount--,this._deltaHeight=t}},{key:"height",get:function(){return 0===this.scrollMode?this.deltaHeight+this.parent.defaultCellHeight:this.parent.defaultCellWidth},set:function(t){1!==this.scrollMode&&this.setDeltaHeight(t-this.parent.defaultCellHeight)}},{key:"width",get:function(){return 0===this.scrollMode?this.parent.defaultCellWidth:this.deltaHeight+this.parent.defaultCellHeight},set:function(t){0!==this.scrollMode&&this.setDeltaHeight(t-this.parent.defaultCellHeight)}},{key:"scene",get:function(){return this.parentContainer.scene}}]),i}();Object.assign(_o.prototype,Eo);function Io(t){return t.hasOwnProperty("geometryMask")?t.geometryMask:t.bitmapMask}function jo(t,e,i){if(e){void 0===i&&(i=t.getAllChildren());for(var n,s,r=t.getBounds(),o=Io(e),a=0,h=i.length;a<h;a++)if(!(n=i[a]).hasOwnProperty("isRexContainerLite")&&n!==o){if(n.getBounds)switch(s=n.getBounds(s),Ho(r,s)){case 4:Fo(n);break;case 0:Yo(r,s)||Lo(r,s)?Vo(n,e):Xo(n);break;default:Vo(n,e)}else Vo(n,e);t.resetChildVisibleState(n).updateChildVisible(n)}}}var Do=Phaser.Utils.Objects.GetValue,zo=Phaser.Utils.Array.SpliceOne,Ro=new zt,Bo=function(){function i(t,e){M(this,i),this.parent=t,this.cells=[],this.resetFromJSON(e)}return v(i,[{key:"resetFromJSON",value:function(t){return this.colCount=void 0,this._nonZeroDeltaHeightCount=0,this.resetTotalRowsHeight(),this.setDefaultCellHeight(Do(t,"cellHeight",30)),this.setDefaultCellWidth(Do(t,"cellWidth",30)),this.initCells(Do(t,"cellsCount",0)),this.setColumnCount(Do(t,"columns",1)),this}},{key:"destroy",value:function(t){for(var e=0,i=this.cells.length;e<i;e++)this.freeCell(this.cells[e],t);this.cells=void 0,this.parent=void 0}},{key:"setDefaultCellHeight",value:function(t){return this.defaultCellHeight=t,this}},{key:"setDefaultCellWidth",value:function(t){return this.defaultCellWidth=t,this}},{key:"initCells",value:function(t){var e=this.cells;e.length=t;for(var i=0;i<t;i++)e[i]=null;return this}},{key:"insertNewCell",value:function(t,e){var i=this.cells;if(t===i.length){var n=t+e;i.legth=n;for(var s=t;s<n;s++)i[s]=null}else{var r,o=[];o.length=e;for(s=0;s<e;s++)o[s]=null;(r=this.cells).splice.apply(r,[t,0].concat(o))}return this.resetTotalRowsHeight(),this}},{key:"removeCell",value:function(t,e){for(var i=t+e,n=t;n<i;n++)this.freeCell(n);return i===this.cells.length?this.cells.length=t:(1===e?zo(this.cells,t):this.cells.splice(t,e),this.buildCellIndex(t)),this.resetTotalRowsHeight(),this}},{key:"setColumnCount",value:function(t){return this.colCount=t,this.resetTotalRowsHeight(),this}},{key:"isValidCellIdx",value:function(t){return 0<=t&&t<this.cells.length}},{key:"heightToRowIndex",value:function(t,e){if(this.defaultCellHeightMode){var i=t/this.defaultCellHeight;return i=e?Math.ceil(i):Math.floor(i)}var n,s=this.rowCount,r=t;for(i=0;;){if(n=0<=i&&i<s,!(0<(r-=this.getRowHeight(i))&&n)){if(0===r)return i;if(e){var o=i;(n=0<=(i+=1)&&i<s)||(i=o)}return i}i+=1}}},{key:"widthToColIndex",value:function(t,e){var i=t/this.defaultCellWidth;return i=e?Math.ceil(i):Math.floor(i)}},{key:"colRowToCellIndex",value:function(t,e){return t>=this.colCount?null:e*this.colCount+t}},{key:"rowIndexToHeight",value:function(t,e){if(this.defaultCellHeightMode)return(e-t+1)*this.defaultCellHeight;for(var i=0,n=t;n<=e;n++)i+=this.getRowHeight(n);return i}},{key:"colIndexToWidth",value:function(t,e){return(e-t+1)*this.defaultCellWidth}},{key:"getRowHeight",value:function(t){var e=this.colCount;if(e<=1)return this.getCellHeight(this.colRowToCellIndex(0,t));for(var i,n=0,s=0;s<e;s++)n<(i=this.getCellHeight(this.colRowToCellIndex(s,t)))&&(n=i);return n}},{key:"getColWidth",value:function(t){return this.defaultCellWidth}},{key:"getCellHeight",value:function(t){if(!this.isValidCellIdx(t))return 0;var e;if(this.defaultCellHeightMode)e=this.defaultCellHeight;else{var i=this.getCell(t,!1),n=i?i.deltaHeight:0;e=this.defaultCellHeight+n}return e}},{key:"resetTotalRowsHeight",value:function(){this._totalRowsHeight=null}},{key:"cellIndxeToColIndex",value:function(t){return t%this.colCount}},{key:"cellIndxeToRowIndex",value:function(t){return Math.floor(t/this.colCount)}},{key:"getCell",value:function(t,e){if(!this.isValidCellIdx(t))return null;if(void 0===e&&(e=!0),null===this.cells[t]&&e){var i=this.newCell(t);this.cells[t]=i}return this.cells[t]}},{key:"newCell",value:function(t){var e=Ro.pop();return null===e?e=new _o(this):e.setParent(this),e.index=t,e}},{key:"buildCellIndex",value:function(t){void 0===t&&(t=0);for(var e,i=this.cells,n=t,s=i.length;n<s;n++)(e=i[n])&&(e.index=n);return this}},{key:"getParentContainer",value:function(){return this.parent}},{key:"freeCell",value:function(t,e){return"number"==typeof t&&(t=this.cells[t]),t&&(t.destroy(e),Ro.push(t)),this}},{key:"nonZeroDeltaHeightCount",get:function(){return this._nonZeroDeltaHeightCount},set:function(t){this._nonZeroDeltaHeightCount!==t&&(this._nonZeroDeltaHeightCount=t,this.resetTotalRowsHeight())}},{key:"defaultCellHeightMode",get:function(){return 0===this.nonZeroDeltaHeightCount}},{key:"rowCount",get:function(){return Math.ceil(this.cells.length/this.colCount)}},{key:"cellsCount",get:function(){return this.cells.length}},{key:"totalRowsHeight",get:function(){return null===this._totalRowsHeight&&(this._totalRowsHeight=this.rowIndexToHeight(0,this.rowCount-1)),this._totalRowsHeight}},{key:"totalColumnWidth",get:function(){return this.colCount*this.defaultCellWidth}}]),i}(),Yo=Phaser.Geom.Intersects.RectangleToRectangle,Lo=Phaser.Geom.Rectangle.Overlaps,Ho=function(t,e){var i=0,n=e.top,s=e.bottom,r=e.left,o=e.right;return i+=t.contains(r,n)?1:0,i+=t.contains(r,s)?1:0,i+=t.contains(o,n)?1:0,i+=t.contains(o,s)?1:0},Fo=function(t,e){t.setVisible(!0),t.clearMask&&t.clearMask()},Vo=function(t,e){t.setVisible(!0),t.setMask&&t.setMask(e)},Xo=function(t,e){t.setVisible(!1),t.clearMask&&t.clearMask()},Wo=Ci,Ao=Phaser.GameObjects.Components,Go=Phaser.Structs.Set,Uo=Phaser.Utils.Objects.GetValue,No=Phaser.Math.Clamp,Jo=function(){function f(t,e,i,n,s,r){var o;M(this,f),void 0===r&&(r={}),(o=I(this,E(f).call(this,t,e,i,n,s))).type="rexGridTable",o._tableOX=0,o._tableOY=0,o.visibleCells=new Go,o.preVisibleCells=new Go,o.visibleStartX=null,o.visibleEndX=null,o.visibleStartY=null,o.visibleEndY=null,o.lastVisibleCellIdx=null,o.execeedTopState=!1,o.execeedBottomState=!1,o.execeedLeftState=!1,o.execeedRightState=!1;var a=Uo(r,"reuseCellContainer",!1);o.cellContainersPool=a?t.add.group():void 0;var h=Uo(r,"cellVisibleCallback",null);if(null!==h){var l=Uo(r,"cellVisibleCallbackScope",void 0);o.on("cellvisible",h,l)}if(null!==(h=Uo(r,"cellInvisibleCallback",null))){l=Uo(r,"cellInvisibleCallbackScope",void 0);o.on("cellinvisible",h,l)}if(o.cellsMask=void 0,o.setCellsMask(Uo(r,"mask",!0)),o.setScrollMode(Uo(r,"scrollMode",0)),o.setClampMode(Uo(r,"clamplTableOXY",!0)),0===o.scrollMode){var u=Uo(r,"cellWidth",void 0);if(o.expandCellSize=void 0===u,void 0===u){var c=Uo(r,"columns",1);r.cellWidth=o.width/c}}else{u=Uo(r,"cellHeight",void 0);var d=Uo(r,"cellWidth",void 0);o.expandCellSize=void 0===u,r.cellWidth=u,r.cellHeight=d}return o.table=new Bo(_(o),r),o.updateTable(),o}return e(f,Wo),v(f,[{key:"destroy",value:function(t){this.scene&&(t||this.setCellsCount(0),this.table.destroy(t),this.table=void 0,this.cellContainersPool&&(this.cellContainersPool.destroy(!0),this.cellContainersPool=void 0),d(E(f.prototype),"destroy",this).call(this,t))}},{key:"setScrollMode",value:function(t){return"string"==typeof t&&(t=Ko[t.toLowerCase()]),this.scrollMode=t,this}},{key:"setClampMode",value:function(t){return this.clampTableOXYMode=t,this}},{key:"setCellsCount",value:function(t){var e=this.cellsCount;return e===t||(t<e?this.removeCell(t,e-t):this.insertNewCell(e,t-e)),this}},{key:"setColumnCount",value:function(t){return this.table.colCount===t||this.table.setColumnCount(t),this}},{key:"setGridSize",value:function(t,e){return this.setCellsCount(t*e),this.table.setColumnCount(t),this}},{key:"insertNewCell",value:function(t,e){return"object"===u(t)&&(t=t.index),void 0===e&&(e=1),e<=0||(t=No(t,0,this.cellsCount),this.table.insertNewCell(t,e)),this}},{key:"removeCell",value:function(t,e){if("object"===u(t)&&(t=t.index),void 0===e&&(e=1),t<0&&(e+=t,t=0),e<=0)return this;if(t>this.cellsCount)return this;if(t<=this.lastVisibleCellIdx)for(var i,n=this.preVisibleCells,s=this.visibleCells,r=t,o=t+e;r<o;r++)(i=this.getCell(r,!1))&&(s.contains(i)&&(this.hideCell(i),s.delete(i)),n.delete(i));return this.table.removeCell(t,e),this}},{key:"setTableOY",value:function(t){var e=this.table,i=this.topTableOY,n=this.bottomTableOY,s=this.tableOYExceedTop(t),r=this.tableOYExeceedBottom(t);this.clampTableOXYMode&&(e.rowCount<e.heightToRowIndex(this.instHeight,!0)?t=0:s?t=i:r&&(t=n));return this._tableOY!==t&&(this._tableOY=t),s&&(this.execeedTopState||this.emit("execeedtop",this,t,i)),this.execeedTopState=s,r&&(this.execeedBottomState||this.emit("execeedbottom",this,t,n)),this.execeedBottomState=r,this}},{key:"setTableOX",value:function(t){var e=this.table,i=this.leftTableOX,n=this.rightTableOX,s=this.tableOXExeceedLeft(t),r=this.tableOXExeceedRight(t);this.clampTableOXYMode&&(e.colCount<e.widthToColIndex(this.instWidth,!0)?t=0:s?t=i:r&&(t=n));return this._tableOX!==t&&(this._tableOX=t),s&&(this.execeedLeftState||this.emit("execeedleft",this,t,i)),this.execeedLeftState=s,r&&(this.execeedRightState||this.emit("execeedright",this,t,n)),this.execeedRightState=r,this}},{key:"setTableOXY",value:function(t,e){return this.setTableOY(e).setTableOX(t),this}},{key:"addTableOY",value:function(t){return this.setTableOY(this.tableOY+t),this}},{key:"addTableOX",value:function(t){return this.setTableOX(this.tableOX+t),this}},{key:"addTableOXY",value:function(t,e){return this.addTableOY(e).addTableOX(t),this}},{key:"setTableOYByPercentage",value:function(t){return this.setTableOY(-this.tableVisibleHeight*t),this}},{key:"getTableOYPercentage",value:function(){var t=this.tableVisibleHeight;return 0===t?0:this.tableOY/-t}},{key:"updateTable",value:function(t){return void 0===t&&(t=!1),t&&(this.clearVisibleCellIndexes(),this.hideCells()),this.clearVisibleCellIndexes(),this.showCells(),this.hideCells(),this.maskCells(),this}},{key:"getCell",value:function(t){return this.table.getCell(t,!0)}},{key:"getCellContainer",value:function(t){var e,i=this.table.getCell(t,!1);return i&&(e=i.getContainer()),e}},{key:"setCellHeight",value:function(t,e){return("number"==typeof t?this.table.getCell(t,!0):t).height=e,this}},{key:"setCellWidth",value:function(t,e){return("number"==typeof t?this.table.getCell(t,!0):t).width=e,this}},{key:"pointerToCellIndex",value:function(t,e){e-=this.y+this.topLeftY,t-=this.x+this.topLeftX;var i=this.tableOY-(0===this.scrollMode?e:t),n=this.tableOX-(0===this.scrollMode?t:e),s=this.table,r=s.heightToRowIndex(-i),o=s.widthToColIndex(-n),a=s.colRowToCellIndex(o,r);return null===a?null:this.cellIsVisible(a)?a:null}},{key:"pointerToCellContainer",value:function(t,e){var i=this.pointerToCellIndex(t,e);if(null!==i)return this.getCellContainer(i)}},{key:"cellIsVisible",value:function(t){var e=this.table.getCell(t,!1);return e&&this.visibleCells.contains(e)}},{key:"eachVisibleCell",value:function(t,e){return this.visibleCells.each(t,e),this}},{key:"iterateVisibleCell",value:function(t,e){return this.visibleCells.iterate(t,e),this}},{key:"setCellsMask",value:function(t){var e,i;if(!0===t?(e=!0,i=0):!1===t?e=!1:(e=Uo(t,"mask",!0),i=Uo(t,"padding",0)),e){var n=new pr(this,0,i);this.cellsMask=n.createGeometryMask(),this.add(n)}return this}},{key:"maskCells",value:function(){for(var t,e=[],i=this.visibleCells.entries,n=0,s=i.length;n<s;n++)(t=i[n].getContainer())&&(t.isRexContainerLite?t.getAllChildren(e):e.push(t));jo(this,this.cellsMask,e)}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(d(E(f.prototype),"resize",this).call(this,t,e),this.cellsMask&&zs(Io(this.cellsMask),t,e),this.expandCellSize&&this.table.setDefaultCellWidth(this.instWidth/this.table.colCount),this.updateTable(!0)),this}},{key:"clearVisibleCellIndexes",value:function(){var t=this.preVisibleCells;this.preVisibleCells=this.visibleCells,this.visibleCells=t,this.visibleCells.clear()}},{key:"showCells",value:function(){if(0!==this.cellsCount){var t=this.table,e=t.heightToRowIndex(-this.tableOY);e<0&&(e=0);var i=t.widthToColIndex(-this.tableOX);i<0&&(i=0);var n=t.colRowToCellIndex(i,e),s=this.bottomBound,r=this.rightBound,o=t.cellsCount-1,a=t.colCount-1,h=this.getTLX(i),l=h,u=this.getTLY(e);for(this.visibleStartY=null,this.visibleEndY=null,this.visibleStartX=null,this.visibleEndX=null,this.lastVisibleCellIdx=null;u<s&&n<=o;){if(this.table.isValidCellIdx(n)){null===this.visibleStartY&&(this.visibleStartY=e,this.visibleEndY=e),null===this.visibleStartX&&(this.visibleStartX=i,this.visibleEndX=i),null===this.lastVisibleCellIdx&&(this.lastVisibleCellIdx=n),this.visibleEndY<e&&(this.visibleEndY=e),this.visibleEndX<i&&(this.visibleEndX=i),this.lastVisibleCellIdx<n&&(this.lastVisibleCellIdx=n);var c=t.getCell(n,!0);this.visibleCells.set(c),this.preVisibleCells.contains(c)||this.showCell(c),0===this.scrollMode?c.setXY(l,u):c.setXY(u,l)}l<r&&i<a?(l+=t.getColWidth(i),i+=1):(l=h,u+=t.getRowHeight(e),i=this.visibleStartX,e+=1),n=t.colRowToCellIndex(i,e)}}}},{key:"showCell",value:function(t){var e=null;if(this.cellContainersPool&&null!==(e=this.cellContainersPool.getFirstDead())&&e.setActive(!0).setVisible(!0),this.emit("cellvisible",t,e),this.cellContainersPool){var i=t.getContainer();i?null===e?this.cellContainersPool.add(i):e!==i&&(this.cellContainersPool.add(i),this.cellContainersPool.killAndHide(e)):null!==e&&this.cellContainersPool.killAndHide(e)}}},{key:"hideCells",value:function(){var t=this.preVisibleCells,e=this.visibleCells;t.iterate(function(t){e.contains(t)||this.hideCell(t)},this)}},{key:"hideCell",value:function(t){if(this.emit("cellinvisible",t),this.cellContainersPool){var e=t.popContainer();e&&this.cellContainersPool.killAndHide(e)}t.destroyContainer()}},{key:"tableOYExceedTop",value:function(t){return void 0===t&&(t=this.tableOY),t>this.topTableOY}},{key:"tableOYExeceedBottom",value:function(t){return void 0===t&&(t=this.tableOY),t<this.bottomTableOY}},{key:"tableOXExeceedLeft",value:function(t){return void 0===t&&(t=this.tableOX),t>this.leftTableOX}},{key:"tableOXExeceedRight",value:function(t){return void 0===t&&(t=this.tableOX),t<this.rightTableOX}},{key:"getTLX",value:function(t){var e=0===this.scrollMode?this.topLeftX:this.topLeftY;return this.tableOX+this.table.colIndexToWidth(0,t-1)+e}},{key:"getTLY",value:function(t){var e=0===this.scrollMode?this.topLeftY:this.topLeftX;return this.tableOY+this.table.rowIndexToHeight(0,t-1)+e}},{key:"tableOY",get:function(){return this._tableOY},set:function(t){this.setTableOY(t).updateTable()}},{key:"tableOX",get:function(){return this._tableOX},set:function(t){this.setTableOX(t).updateTable()}},{key:"t",set:function(t){this.setTableOYByPercentage(t).updateTable()},get:function(){return this.getTableOYPercentage()}},{key:"cellsCount",get:function(){return this.table.cellsCount}},{key:"columnCount",get:function(){return this.table.colCount}},{key:"instHeight",get:function(){return 0===this.scrollMode?this.height:this.width}},{key:"instWidth",get:function(){return 0===this.scrollMode?this.width:this.height}},{key:"tableHeight",get:function(){return this.table.totalRowsHeight}},{key:"tableWidth",get:function(){return this.table.totalColumnWidth}},{key:"topTableOY",get:function(){return 0}},{key:"bottomTableOY",get:function(){return-this.tableVisibleHeight}},{key:"leftTableOX",get:function(){return 0}},{key:"rightTableOX",get:function(){return-this.tableVisibleWidth}},{key:"tableVisibleHeight",get:function(){var t=this.tableHeight,e=this.instHeight;return e<t?t-e:0}},{key:"tableVisibleWidth",get:function(){var t=this.tableWidth,e=this.instWidth;return e<t?t-e:0}},{key:"bottomLeftY",get:function(){return-this.displayHeight*this.originY+this.displayHeight}},{key:"topRightX",get:function(){return-this.displayWidth*this.originX+this.displayWidth}},{key:"topLeftX",get:function(){return-this.displayWidth*this.originX}},{key:"topLeftY",get:function(){return-this.displayHeight*this.originY}},{key:"bottomBound",get:function(){return 0===this.scrollMode?this.bottomLeftY:this.topRightX}},{key:"rightBound",get:function(){return 0===this.scrollMode?this.topRightX:this.bottomLeftY}}]),f}();Object.assign(Jo.prototype,Ao.GetBounds);function Zo(t,e,i,n,s){var r;if(null!=(r=void 0===s?n:i.pointerToCellIndex(n,s))){var o=i.getCellContainer(r);t.emit(e,o,r)}}var Ko={v:0,vertical:0,h:1,horizontal:1},qo=function(t){if(!t.isDown){var e=this.childrenMap.child,i=e.pointerToCellIndex(t.x,t.y);if(i!==this._lastOverCellIndex){var n=this._lastOverCellIndex;this._lastOverCellIndex=i,Zo(this.eventEmitter,"cell.out",e,n),Zo(this.eventEmitter,"cell.over",e,i)}}},$o=function(){var t=this.childrenMap.child,e=this._lastOverCellIndex;this._lastOverCellIndex=void 0,Zo(this.eventEmitter,"cell.out",t,e)},Qo=Phaser.Utils.Objects.GetValue,ta=function(){function i(t,e){M(this,i),this.parent=t,this._isRunning=!1,this.tickingState=!1,this.setEventEmitter(Qo(e,"eventEmitter",void 0)),this.setTickingMode(Qo(e,"tickingMode",1))}return v(i,[{key:"boot",value:function(){2!==this.tickingMode||this.tickingState||this.startTicking()}},{key:"shutdown",value:function(){this.destroyEventEmitter(),this.tickingState&&this.stopTicking()}},{key:"setTickingMode",value:function(t){"string"==typeof t&&(t=ia[t]),this.tickingMode=t}},{key:"startTicking",value:function(){this.tickingState=!0}},{key:"stopTicking",value:function(){this.tickingState=!1}},{key:"start",value:function(){return this.isRunning=!0,this}},{key:"pause",value:function(){return this.isRunning=!1,this}},{key:"resume",value:function(){return this.isRunning=!0,this}},{key:"stop",value:function(){return this.isRunning=!1,this}},{key:"complete",value:function(){this.isRunning=!1,this.emit("complete",this.parent,this)}},{key:"isRunning",get:function(){return this._isRunning},set:function(t){this._isRunning!==t&&(this._isRunning=t,1===this.tickingMode&&t!=this.tickingState&&(t?this.startTicking():this.stopTicking()))}}]),i}();Object.assign(ta.prototype,hs);function ea(t){t.setInteractive(),function(t){t._click=new kr(t,{threshold:10}),t._click.on("click",function(t,e,i){Zo(this.eventEmitter,"cell.click",e,i.x,i.y)},this)}.call(this,t),function(t){t.on("pointermove",qo,this).on("pointerover",qo,this).on("pointerup",$o,this).on("pointerout",$o,this)}.call(this,t),function(t){t._tap=new ua(t),t._tap.on("tap",function(t){var e="cell.".concat(t.tapsCount,"tap");Zo(this.eventEmitter,e,t.gameObject,t.x,t.y)},this)}.call(this,t),function(t){t._press=new pa(t),t._press.on("pressstart",function(t){var e=t.gameObject,i=e.pointerToCellIndex(t.x,t.y);t._cellIndex=i,Zo(this.eventEmitter,"cell.pressstart",e,i)},this).on("pressend",function(t){var e=t.gameObject,i=t._cellIndex;t._cellIndex=void 0,Zo(this.eventEmitter,"cell.pressend",e,i)},this)}.call(this,t)}var ia={no:0,lazy:1,always:2},na=Phaser.Utils.Objects.GetValue,sa=function(){function s(t,e){var i;M(this,s);var n=qn(t);return n===t&&(t=void 0),(i=I(this,E(s).call(this,n,e))).scene=n,(i.gameObject=t)&&t.setInteractive(na(e,"inputConfig",void 0)),i.resetFromJSON(e),i.boot(),i}return e(s,ta),v(s,[{key:"resetFromJSON",value:function(t){return this.setEnable(na(t,"enable",!0)),void 0===this.gameObject?this.bounds=na(t,"bounds",void 0):this.bounds=void 0,this.tracerState=ra,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,this.isTouchingAnyObject=!1,this}},{key:"boot",value:function(){d(E(s.prototype),"boot",this).call(this),this.gameObject?this.gameObject.on("pointerdown",this.onPointerDown,this):this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function(){this.gameObject?this.gameObject.off("pointerdown",this.onPointerDown,this):this.scene&&this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene&&(this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.events.off("destroy",this.destroy,this),this.scene=void 0),this.scene=void 0,this.gameObject=void 0,this.bounds=void 0,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,d(E(s.prototype),"shutdown",this).call(this)}},{key:"destroy",value:function(){this.shutdown()}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable===t||(t||this.dragCancel(),this.enable=t),this}},{key:"onPointerDown",value:function(t,e){this.enable&&void 0===this.pointer&&(this.bounds&&!this.bounds.contains(t.x,t.y)||this.pointer===t||(this.pointer=t,this.lastPointer=t,this.movedState=!1,this.tracerState=oa,void 0===this.gameObject&&(this.isTouchingAnyObject=0<e.length),this.onDragStart()))}},{key:"onPointerUp",value:function(t){this.enable&&(this.bounds&&!this.bounds.contains(t.x,t.y)||this.pointer!==t||(this.pointer=void 0,this.movedState=!1,this.tracerState=ra,this.onDragEnd()))}},{key:"onPointerMove",value:function(t){if(this.enable&&t.isDown){var e=!this.bounds||this.bounds.contains(t.x,t.y),i=this.pointer===t;!i&&e||(i&&!e?this.onPointerUp(t):(this.movedState||(this.movedState=t.x!==t.downX||t.y!==t.downY),this.movedState&&this.onDrag()))}}},{key:"dragCancel",value:function(){return this.tracerState===oa&&this.onDragEnd(),this.pointer=void 0,this.tracerState=ra,this}},{key:"onDragStart",value:function(){this.emit("dragstart",this)}},{key:"onDragEnd",value:function(){this.emit("dragend",this)}},{key:"onDrag",value:function(){this.emit("drag",this)}},{key:"preUpdate",value:function(t,e){}},{key:"postUpdate",value:function(t,e){}},{key:"startTicking",value:function(){d(E(s.prototype),"startTicking",this).call(this),this.scene.events.on("preupdate",this.preUpdate,this),this.scene.events.on("postupdate",this.postUpdate,this)}},{key:"stopTicking",value:function(){d(E(s.prototype),"stopTicking",this).call(this),this.scene&&(this.scene.events.off("preupdate",this.preUpdate,this),this.scene.events.off("postupdate",this.postUpdate,this))}},{key:"setRecongizedStateObject",value:function(t){return this.recongizedState=t,this}},{key:"cancel",value:function(){return this.state=aa,this}},{key:"state",get:function(){return this.recongizedState.state},set:function(t){this.recongizedState.state=t}}]),s}(),ra=0,oa=1,aa="IDLE",ha=Phaser.Utils.Objects.GetValue,la=Phaser.Math.Distance.Between,ua=function(){function r(t,e){var i;M(this,r);var n=_(i=I(this,E(r).call(this,t,e))),s={states:{IDLE:{enter:function(){n.stop(),n.tapsCount=0,n.x=0,n.y=0,n.worldX=0,n.worldY=0},exit:function(){var t=n.lastPointer;n.x=t.x,n.y=t.y,n.worldX=t.worldX,n.worldY=t.worldY}},BEGIN:{enter:function(){n.start(),n.tapsCount=0,n.emit("tappingstart",n,n.gameObject,n.lastPointer)}},RECOGNIZED:{enter:function(){n.start(),n.emit("tap",n,n.gameObject,n.lastPointer),n.emit("".concat(n.tapsCount,"tap"),n,n.gameObject,n.lastPointer)}}},init:function(){this.state=ca},eventEmitter:!1};return i.setRecongizedStateObject(new po(s)),i}return e(r,sa),v(r,[{key:"resetFromJSON",value:function(t){d(E(r.prototype),"resetFromJSON",this).call(this,t),this.setMaxHoldTime(ha(t,"time",250)),this.setTapInterval(ha(t,"tapInterval",200)),this.setDragThreshold(ha(t,"threshold",9)),this.setTapOffset(ha(t,"tapOffset",10));var e=ha(t,"taps",void 0);return void 0!==e?this.setTaps(e):(this.setMaxTaps(ha(t,"maxTaps",void 0)),this.setMinTaps(ha(t,"minTaps",void 0))),this}},{key:"onDragStart",value:function(){switch(this.state){case ca:this.state=da;break;case da:var t=this.lastPointer;la(t.upX,t.upY,t.x,t.y)>this.tapOffset&&(this.state=fa,this.state=da);break;case fa:this.state=da}}},{key:"onDragEnd",value:function(){this.state===da&&(this.tapsCount++,this.emit("tapping",this,this.gameObject,this.lastPointer),void 0!==this.maxTaps&&this.tapsCount===this.maxTaps&&(this.state=fa))}},{key:"onDrag",value:function(){this.state!==ca&&this.pointer.getDistance()>this.dragThreshold&&(this.state=ca)}},{key:"preUpdate",value:function(t,e){if(this.state===da){var i=this.lastPointer;if(i.isDown)t-i.downTime>this.holdTime&&(this.state=ca);else t-i.upTime>this.tapInterval&&(void 0===this.minTaps||this.tapsCount>=this.minTaps?this.state=fa:this.state=ca)}}},{key:"postUpdate",value:function(t,e){this.state===fa&&(this.state=ca)}},{key:"setMaxHoldTime",value:function(t){return this.holdTime=t,this}},{key:"setTapInterval",value:function(t){return this.tapInterval=t,this}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"setTapOffset",value:function(t){return this.tapOffset=t,this}},{key:"setMaxTaps",value:function(t){return this.maxTaps=t,this}},{key:"setMinTaps",value:function(t){return this.minTaps=t,this}},{key:"setTaps",value:function(t,e){return void 0===e&&(e=t),this.setMinTaps(t).setMaxTaps(e),this}},{key:"isTapped",get:function(){return this.state===fa}}]),r}(),ca="IDLE",da="BEGIN",fa="RECOGNIZED",va=Phaser.Utils.Objects.GetValue,pa=function(){function r(t,e){var i;M(this,r);var n=_(i=I(this,E(r).call(this,t,e))),s={states:{IDLE:{enter:function(){n.x=0,n.y=0,n.worldX=0,n.worldY=0},exit:function(){var t=n.lastPointer;n.x=t.x,n.y=t.y,n.worldX=t.worldX,n.worldY=t.worldY}},BEGIN:{enter:function(){n.start()},exit:function(){n.stop()}},RECOGNIZED:{enter:function(){n.emit("pressstart",n,n.gameObject,n.lastPointer)},exit:function(){n.emit("pressend",n,n.gameObject,n.lastPointer)}}},init:function(){this.state=ga},eventEmitter:!1};return i.setRecongizedStateObject(new po(s)),i}return e(r,sa),v(r,[{key:"resetFromJSON",value:function(t){return d(E(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(va(t,"threshold",9)),this.setMinHoldTime(va(t,"time",251)),this}},{key:"onDragStart",value:function(){this.state=0===this.holdTime?ma:ya}},{key:"onDragEnd",value:function(){this.state=ga}},{key:"onDrag",value:function(){this.state!==ga&&this.pointer.getDistance()>this.dragThreshold&&(this.state=ga)}},{key:"preUpdate",value:function(t,e){this.state===ya&&t-this.pointer.downTime>=this.holdTime&&(this.state=ma)}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"setMinHoldTime",value:function(t){return this.holdTime=t,this}},{key:"isPressed",get:function(){return this.state===ma}}]),r}(),ga="IDLE",ya="BEGIN",ma="RECOGNIZED",xa=Phaser.Utils.Objects.GetValue,ka=function(){function f(t,e){var i;M(this,f),void 0===e&&(e={});var n=uo(e),s=xa(e,"table",void 0);void 0===s&&(s={}),s.scrollMode=n,s.clamplTableOXY=xa(e,"clamplChildOY",!1);var r,o,a=xa(s,"width",void 0),h=xa(s,"height",void 0),l=new Jo(t,0,0,a,h,s);o=0===n?(r=void 0===a?1:0,void 0===h):(r=void 0===h?1:0,void 0===a),function(e){Object.defineProperty(e,"childOY",{configurable:!0,get:function(){return e.tableOY},set:function(t){e.tableOY=t}}),Object.defineProperty(e,"topChildOY",{get:function(){return e.topTableOY}}),Object.defineProperty(e,"bottomChildOY",{get:function(){return e.bottomTableOY}})}(l),e.type="rexGridTable",e.child={gameObject:l,proportion:r,expand:o};var u=xa(e,"space",void 0);u&&(u.child=u.table),(i=I(this,E(f).call(this,t,e))).addChildrenMap("table",l),i.eventEmitter=xa(e,"eventEmitter",_(i));var c=xa(e,"createCellContainerCallback",K),d=xa(e,"createCellContainerCallbackScope",void 0);return i.setCreateCellContainerCallback(c,d),function(t){t.on("cellvisible",function(t,e){var i,n=this.createCellContainerCallback,s=this.createCellContainerCallbackScope;t.item=this.items[t.index],(i=s?n.call(s,t,e):n(t,e)).setOrigin&&i.setOrigin(0),i.isRexSizer&&i.layout(),t.item=void 0,t.setContainer(i)},this)}.call(_(i),l),xa(s,"interactive",!0)&&ea.call(_(i),l),i.setItems(xa(e,"items",[])),i}return e(f,Mo),v(f,[{key:"setCreateCellContainerCallback",value:function(t,e){return this.createCellContainerCallback=t,this.createCellContainerCallbackScope=e,this}},{key:"refresh",value:function(){return this.childrenMap.child.updateTable(!0),this}}]),f}(),ba={setItems:function(t){void 0===t?this.items.length=0:this.items=t;var e=this.childrenMap.child;return e.setCellsCount(this.items.length),e.updateTable(!0),this.resizeController(),this}};Object.assign(ka.prototype,ba),c.register("gridTable",function(t){var e=new ka(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.GridTable",ka);function wa(t,e){return e.orientation=t.orientation,e}var Ca={expandSubMenu:function(t,e){var i;this.collapseSubMenu(),i=this.root.toggleOrientation?0===this.orientation?1:0:this.orientation;var n=new this.constructor(this.scene,{items:e,orientation:i,createBackgroundCallback:this.root.createBackgroundCallback,createBackgroundCallbackScope:this.root.createBackgroundCallbackScope,createButtonCallback:this.root.createButtonCallback,createButtonCallbackScope:this.root.createButtonCallbackScope,easeIn:this.root.easeIn,easeOut:this.root.easeOut,_rootMenu:this.root,_parentMenu:this,_parentButton:t});return this.pin(n),this.childrenMap.subMenu=n,this.root.emit("expand",n,t,this),this},collapse:function(){return this.root.emit("collapse",this,this.parentButton,this.parentMenu),this.scaleDownDestroy(wa(this,this.root.easeOut)),this.collapseSubMenu(),this},collapseSubMenu:function(){if(void 0===this.childrenMap.subMenu)return this;var t=this.childrenMap.subMenu;return this.childrenMap.subMenu=void 0,this.remove(t),t.collapse(),this}},Sa=Phaser.Utils.Objects.GetValue,Oa=function(){function f(t,e){var i;M(this,f),void 0===e&&(e={}),e.hasOwnProperty("orientation")||(e.orientation=1);var n=e._rootMenu,s=e._parentMenu,r=e._parentButton,o=Sa(e,"items",void 0),a=Sa(e,"createBackgroundCallback",void 0),h=Sa(e,"createBackgroundCallbackScope",void 0);e.background=function(t,e,i,n){var s;return i&&(e.scene=t,s=n?i.call(n,e):i(e),e.scene=void 0),s}(t,o,a,h);var l=Sa(e,"createButtonCallback",void 0),u=Sa(e,"createButtonCallbackScope",void 0);e.buttons=function(t,e,i,n){var s,r,o=[];if(e&&i)for(var a=0,h=e.length;a<h;a++)(s=e[a]).scene=t,r=n?i.call(n,s,a,e):i(s,a,e),s.scene=void 0,o.push(r);return o}(t,o,l,u),(i=I(this,E(f).call(this,t,e))).type="rexMenu",i.items=o,i.root=void 0===n?_(i):n,i.parentMenu=s,i.parentButton=r;var c=i.root===_(i);c&&(void 0===(d=e.bounds)&&(d=kn(t)),i.bounds=d,i.expandEventName=Sa(e,"expandEvent","button.click"),i.toggleOrientation=Sa(e,"toggleOrientation",!1),i.easeIn=Sa(e,"easeIn",0),"number"==typeof i.easeIn&&(i.easeIn={duration:i.easeIn}),i.easeOut=Sa(e,"easeOut",0),"number"==typeof i.easeOut&&(i.easeOut={duration:i.easeOut}),i.createBackgroundCallback=a,i.createBackgroundCallbackScope=h,i.createButtonCallback=l,i.createButtonCallbackScope=u,i._isPassedEvent=!1);i.setOrigin(0).layout();var d=i.root.bounds;if(c)i.expandOrientation=[i.y<d.centerY?1:3,i.x<d.centerX?0:2];else switch(i.root.expandOrientation[s.orientation]){case 0:i.alignTop(r.top).alignLeft(r.right);break;case 1:i.alignLeft(r.left).alignTop(r.bottom);break;case 2:i.alignTop(r.top).alignRight(r.left);break;case 3:i.alignLeft(r.left).alignBottom(r.top)}return i.pushIntoBounds(d),function(t){t.on(t.root.expandEventName,function(t,e){if(!this._isPassedEvent){var i=this.items[e].children;i&&this.expandSubMenu(t,i)}},t).on("button.click",function(t,e,i,n){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.click",t,e,i,n),this.root._isPassedEvent=!1)},t).on("button.over",function(t,e,i,n){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.over",t,e,i,n),this.root._isPassedEvent=!1)},t).on("button.out",function(t,e,i,n){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.out",t,e,i,n),this.root._isPassedEvent=!1)},t)}(_(i)),i.popUp(wa(_(i),i.root.easeIn)),i}return e(f,Ir),v(f,[{key:"isInTouching",value:function(t){return!!d(E(f.prototype),"isInTouching",this).call(this,t)||!!this.childrenMap.subMenu&&this.childrenMap.subMenu.isInTouching(t)}}]),f}();Object.assign(Oa.prototype,Ca),c.register("menu",function(t){var e=new Oa(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.Menu",Oa);function Ta(t){return t instanceof Pa}var Pa=Phaser.GameObjects.Text,Ma=Phaser.Utils.Objects.GetValue,Ea=Phaser.Math.Clamp,_a=function(){function i(t,e){M(this,i),this.gameObject=t,this.scene=qn(t),this.setTextObjectType(),this.lines=void 0,this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){return this.setText(Ma(t,"text","")),this.setStartIdx(Ma(t,"start",0)),this.setPageIdx(Ma(t,"page",-1)),this}},{key:"toJSON",value:function(){return{text:this.text,start:this.startLineIdx,page:this.pageIndex,pageCount:this.pageCount}}},{key:"boot",value:function(){this.gameObject.once("destroy",this.destroy,this)}},{key:"shutdown",value:function(){return void 0===this.lines||(0===this.textObjectType?this.lines.length=0:this.lines.destroy()),this.gameObject=void 0,this.scene=void 0,this}},{key:"destroy",value:function(){this.shutdown()}},{key:"setTextObjectType",value:function(){return this.textObjectType=Ta(this.gameObject)?0:1,this}},{key:"setText",value:function(t,e){return void 0===e&&(e=!0),this.text=Ia(t),0===this.textObjectType?this.lines=this.gameObject.getWrappedText(this.text):this.lines=this.gameObject.getPenManager(this.text,this.lines),this.pageCount=Math.ceil(this.totalLinesCount/this.pageLinesCount),e&&this.resetPageIdx(),this}},{key:"appendText",value:function(t){return this.setText(this.text.concat(Ia(t))),this}},{key:"getPage",value:function(t){return void 0===t&&(t=this.pageIndex),this.setPageIdx(t).getLines()}},{key:"getNextPage",value:function(){return this.getPage(this.pageIndex+1)}},{key:"getPreviousPage",value:function(){return this.getPage(this.pageIndex-1)}},{key:"showPage",value:function(t){return this.displayText(this.getPage()),this}},{key:"showNextPage",value:function(){return this.displayText(this.getNextPage()),this}},{key:"showPreviousPage",value:function(){return this.displayText(this.getPreviousPage()),this}},{key:"show",value:function(){return this.displayText(this.getLines()),this}},{key:"showNextLine",value:function(){return this.displayText(this.setStartIdx(this.startLineIdx+1).getLines()),this}},{key:"showPreviousLine",value:function(){return this.displayText(this.setStartIdx(this.startLineIdx-1).getLines()),this}},{key:"setStartIdx",value:function(t){return t=Ea(t,0,this.totalLinesCount-1),this.startLineIdx=t,this}},{key:"resetPageIdx",value:function(){this.pageIndex=-1}},{key:"setPageIdx",value:function(t){return t=Ea(t,0,this.pageCount-1),this.pageIndex=t,this.setStartIdx(this.pageIndex*this.pageLinesCount),this}},{key:"getLines",value:function(t){void 0===t&&(t=this.startLineIdx);var e,i=t+this.pageLinesCount;if(0===this.textObjectType)e=this.lines.slice(t,i).join("\n");else{var n=this.lines.getLineStartIndex(t),s=this.lines.getLineEndIndex(i-1);e=this.lines.getSliceTagText(n,s,!0)}return e}},{key:"displayText",value:function(t){this.gameObject.setText(t)}},{key:"isFirstPage",get:function(){return this.pageIndex<=0}},{key:"isLastPage",get:function(){return this.pageIndex>=this.pageCount-1}},{key:"totalLinesCount",get:function(){return 0===this.textObjectType?this.lines.length:this.lines.linesCount}},{key:"pageLinesCount",get:function(){var t=this.gameObject.style.maxLines;return 0<t?t:this.totalLinesCount}}]),i}(),Ia=function(t){return Array.isArray(t)?t=t.join("\n"):"number"==typeof t&&(t=t.toString()),t},ja=Phaser.Utils.Objects.GetFastValue,Da=Phaser.Utils.Objects.GetValue,za=function(){function i(t,e){M(this,i),this.gameObject=t,this.scene=qn(t),this.setEventEmitter(Da(e,"eventEmitter",void 0)),this.timer=null,this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){this.setTypeMode(Da(t,"typeMode",0)),this.setTypeSpeed(Da(t,"speed",333)),this.setTextCallback=ja(t,"setTextCallback",null),this.setTextCallbackScope=ja(t,"setTextCallbackScope",null),this.typingIdx=ja(t,"typingIdx",0),this.text=Ra(ja(t,"text","")),this.textLen=ja(t,"textLen",0),this.insertIdx=ja(t,"insertIdx",null);var e=ja(t,"elapsed",null);return null!==e&&this.start(void 0,void 0,this.typingIdx,e),this}},{key:"toJSON",value:function(){var t,e=this.getTimer();return t=e?e.elapsed:null,{typeMode:this.typeMode,speed:this.speed,setTextCallback:this.setTextCallback,setTextCallbackScope:this.setTextCallbackScope,typingIdx:this.typingIdx,text:this.text,textLen:this.textLen,insertIdx:this.insertIdx,elapsed:t}}},{key:"boot",value:function(){return this.gameObject.once&&this.gameObject.once("destroy",this.destroy,this),this}},{key:"shutdown",value:function(){return this.destroyEventEmitter(),this.freeTimer(),this.gameObject=void 0,this.scene=void 0,this}},{key:"destroy",value:function(){return this.shutdown(),this}},{key:"setTypeMode",value:function(t){return"string"==typeof t&&(t=Ba[t]),this.typeMode=t,this}},{key:"setTypeSpeed",value:function(t){return this.speed=t,this}},{key:"start",value:function(t,e,i,n){return void 0!==t&&this.setTypingContent(t),void 0!==e&&(this.speed=e),void 0===i&&(i=0),this.typingIdx=i+1,0===this.speed?this.stop(!0):this.startTimer(n),this}},{key:"appendText",value:function(t){var e=this.text.concat(Ra(t));return this.isTyping?this.setTypingContent(e):this.start(e,void 0,this.textLen),this}},{key:"stop",value:function(t){return this.getTimer()&&this.freeTimer(),t&&(this.typingIdx=this.textLen,this.setText(this.text),this.emit("type"),this.emit("complete",this,this.gameObject)),this}},{key:"pause",value:function(){var t=this.getTimer();return t&&(t.paused=!0),this}},{key:"resume",value:function(){var t=this.getTimer();return t&&(t.paused=!1),this}},{key:"setTypingContent",value:function(t){return this.text=Ra(t),this.textLen=this.getTextLength(this.text),this}},{key:"onTyping",value:function(){var t=this.getTypingString(this.text,this.typingIdx,this.textLen,this.typeMode);this.setText(t),this.emit("type"),this.isLastChar?(this.freeTimer(),this.emit("complete",this,this.gameObject)):(this.timer.delay=this.speed,this.typingIdx++)}},{key:"getTypingString",value:function(t,e,i,n){var s;if(0===n){var r=0,o=e;this.insertIdx=o,s=this.getSubString(t,r,o)}else if(1===n){r=(o=i)-e;this.insertIdx=0,s=this.getSubString(t,r,o)}else if(2===n){var a=i/2;o=(r=Math.floor(a-e/2))+e;this.insertIdx=e%2?e:0,s=this.getSubString(t,r,o)}else if(3===n){var h,l=Math.floor(e/2);if(0<l){r=(o=i)-l;h=this.getSubString(t,r,o)}else h="";var u,c=e-l;if(0<c){o=(r=0)+c;this.insertIdx=o,u=this.getSubString(t,r,o)}else u="",this.insertIdx=0;s=u+h}return s}},{key:"startTimer",value:function(t){var e;return this.timer&&this.freeTimer(),e=void 0===t?0:(this.speed,t),this.timer=this.scene.time.addEvent({delay:0,startAt:e,loop:!0,callback:this.onTyping,callbackScope:this}),this}},{key:"getTimer",value:function(){return this.timer}},{key:"freeTimer",value:function(){return this.timer&&(this.timer.remove(),this.timer=null),this}},{key:"setText",value:function(t){this.setTextCallback&&(t=this.setTextCallbackScope?this.setTextCallback.call(this.setTextCallbackScope,t,this.isLastChar,this.insertIdx):this.setTextCallback(t,this.isLastChar,this.insertIdx)),this.gameObject.setText(t)}},{key:"getTextLength",value:function(t){var e=this.gameObject;return e.getPlainText?e.getPlainText(t).length:t.length}},{key:"getSubString",value:function(t,e,i){var n=this.gameObject;return n.getSubString?n.getSubString(t,e,i):t.slice(e,i)}},{key:"isTyping",get:function(){return null!==this.getTimer()}},{key:"isLastChar",get:function(){return this.typingIdx===this.textLen}}]),i}();Object.assign(za.prototype,hs);var Ra=function(t){return Array.isArray(t)?t=t.join("\n"):"number"==typeof t&&(t=t.toString()),t},Ba={"left-to-right":0,"right-to-left":1,"middle-to-sides":2,"sides-to-middle":3},Ya=Phaser.Utils.Objects.GetValue,La=function(){function s(t,e){var i;M(this,s),void 0===e&&(e={text:Ha(t)}),(i=I(this,E(s).call(this,t,e))).type="rexTextBox";var n=i.childrenMap.text;return i.page=new _a(n,Ya(e,"page",void 0)),i.typing=new za(n,Ya(e,"type",void 0)),i.typing.on("complete",i.onPageEnd,_(i)).on("type",i.onType,_(i)),i.textWidth=n.width,i.textHeight=n.height,i}return e(s,mr),v(s,[{key:"start",value:function(t,e){return this.page.setText(t),void 0!==e&&this.typing.setTypeSpeed(e),this.typeNextPage(),this}},{key:"typeNextPage",value:function(){if(this.page.isLastPage)this.emit("complete");else{var t=this.page.getNextPage();this.typing.start(t)}return this}},{key:"pause",value:function(){return this.typing.pause(),this}},{key:"resume",value:function(){return this.typing.resume(),this}},{key:"stop",value:function(t){return this.typing.stop(t),this}},{key:"onType",value:function(){var t=this.childrenMap.text;this.textWidth===t.width&&this.textHeight===t.height||(this.textWidth=t.width,this.textHeight=t.height,this.getTopmostSizer().layout()),this.emit("type")}},{key:"onPageEnd",value:function(){this.emit("pageend")}},{key:"isTyping",get:function(){return this.typing.isTyping}},{key:"isLastPage",get:function(){return this.page.isLastPage}},{key:"isFirstPage",get:function(){return this.page.isFirstPage}},{key:"pageCount",get:function(){return this.page.pageCount}},{key:"pageIndex",get:function(){return this.page.pageIndex}}]),s}(),Ha=function(t){return t.add.text(0,0,"",{wordWrap:{width:200},maxLines:5})};c.register("textBox",function(t){var e=new La(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.TextBox",La);var Fa=Phaser.Utils.Objects.GetValue,Va=Phaser.Math.Percent,Xa=Phaser.Math.Linear,Wa=function(){function x(t,e){var i;M(this,x),(i=I(this,E(x).call(this,t,e))).type="rexNumberBar";var n,s=Fa(e,"background",void 0),r=Fa(e,"icon",void 0),o=Fa(e,"iconMask",void 0),a=Fa(e,"slider",void 0),h=Fa(e,"text",void 0),l=Fa(e,"space.left",0),u=Fa(e,"space.right",0),c=Fa(e,"space.top",0),d=Fa(e,"space.bottom",0),f=Fa(e,"space.icon",0),v=Fa(e,"space.slider",0);s&&i.addBackground(s),r&&(p=0===i.orientation?{left:l,right:a||h?f:u,top:c,bottom:d}:{left:l,right:u,top:c,bottom:a||h?f:d},i.add(r,0,"center",p),o&&(o=new pr(r,1),r.setMask(o.createGeometryMask()),i.add(o,null)));if(a){var p,g;if(a.orientation=0==i.orientation?1:0,a.eventEmitter=_(i),a.value=null,a.hasOwnProperty("input")||(a.input=-1),n=new ao(t,a),p=0===i.orientation?{left:r?0:l,right:h?v:u,top:c,bottom:d}:{left:l,right:u,top:r?0:c,bottom:h?v:d},0===i.orientation)g=void 0===Fa(a,"width",void 0)?1:0;else g=void 0===Fa(a,"height",void 0)?1:0;i.add(n,g,"center",p)}h&&(p=0===i.orientation?{left:r||a?0:l,right:u,top:c,bottom:d}:{left:l,right:u,top:r||a?0:c,bottom:d},i.add(h,0,"center",p));i.addChildrenMap("background",s),i.addChildrenMap("icon",r),i.addChildrenMap("slider",n),i.addChildrenMap("text",h);var y=Fa(e,"valuechangeCallback",null);if(null!==y){var m=Fa(e,"valuechangeCallbackScope",void 0);i.on("valuechange",y,m)}return i.setEnable(Fa(e,"enable",void 0)),i.setValue(Fa(e,"value",0)),i}return e(x,Js),v(x,[{key:"setEnable",value:function(t){return this.childrenMap.slider||(void 0===t&&(t=!0),this.childrenMap.slider.enable=t),this}},{key:"setValue",value:function(t,e,i){return void 0!==e&&(t=Va(t,e,i)),this.value=t,this}},{key:"addValue",value:function(t,e,i){return void 0!==e&&(t=Va(t,e,i)),this.value+=t,this}},{key:"getValue",value:function(t,e){var i=this.value;return void 0!==t&&(i=Xa(t,e,i)),i}},{key:"setText",value:function(t){return this.text=t,this}},{key:"value",get:function(){return this.childrenMap.slider?this.childrenMap.slider.value:0},set:function(t){this.childrenMap.slider&&(this.childrenMap.slider.value=t)}},{key:"text",get:function(){var t=this.childrenMap.text;return void 0===t?"":t.text?t.text:t.getData("text")},set:function(t){var e=this.childrenMap.text;void 0!==e&&(e.setText?e.setText(t):e.setData("text",t))}}]),x}();c.register("numberBar",function(t){var e=new Wa(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.NumberBar",Wa);var Aa=Phaser.Utils.Objects.IsPlainObject,Ga=Phaser.Display.Align.TOP_LEFT,Ua={addPage:function(t,e,i,n,s){if(Aa(e)){var r=e;e=GetValue(r,"key",0),i=GetValue(r,"align",Ga),n=GetValue(r,"padding",0),s=GetValue(r,"expand",!1)}return"string"==typeof i&&(i=Cn[i]),void 0===i&&(i=ALIGN_CENTER),void 0===n&&(n=0),void 0===s&&(s=!0),(r=this.getSizerConfig(t)).parent=this,r.align=i,r.padding=Fs(n),r.expand=s,this.sizerChildren.has(e)&&this.sizerChildren.get(e).destroy(),this.sizerChildren.set(e,t),t.setVisible(!1),this.add(t),this},getPage:function(t){return void 0===t?null:this.sizerChildren.has(t)?this.sizerChildren.get(t):null},swapPage:function(t){this._previousKey=this._currentKey;var e=this.previousPage;e&&(0===this.swapMode?(e.setVisible(!1),this.resetChildVisibleState(e),this.emit("pageinvisible",e,this._previousKey,this)):e.destroy()),t&&!this.sizerChildren.has(t)&&this.emit("createpage",t,this),this._currentKey=t;var i=this.currentPage;return i&&(i.setVisible(!0),this.resetChildVisibleState(i),this.emit("pagevisible",i,this._currentKey,this)),this},getChildrenWidth:function(){if(this.rexSizer.hidden)return 0;var t,e,i,n=0,s=this.sizerChildren.entries;for(var r in s)i=(t=s[r]).isRexSizer?Math.max(t.minWidth,t.childrenWidth):t.displayWidth,i+=(e=t.rexSizer.padding).left+e.right,n=Math.max(i,n);return n},getChildrenHeight:function(){if(this.rexSizer.hidden)return 0;var t,e,i,n=0,s=this.sizerChildren.entries;for(var r in s)i=(t=s[r]).isRexSizer?Math.max(t.minHeight,t.childrenHeight):t.displayHeight,i+=(e=t.rexSizer.padding).top+e.bottom,n=Math.max(i,n);return n},getChildrenSizers:function(t){void 0===t&&(t=[]);var e,i=this.sizerChildren.entries;for(var n in i)(e=i[n]).isRexSizer&&t.push(e);return t},layout:function(t,e,i){if(this.rexSizer.hidden)return this;var n,s,r;this.preLayout(t),void 0===e&&(e=Math.max(this.childrenWidth,this.minWidth)),void 0===i&&(i=Math.max(this.childrenHeight,this.minHeight)),this.resize(e,i);var o,a,h,l,u,c,d,f,v,p,g,y,m,x,k=this.left,b=this.top,w=this.pages;for(var C in w)r=(s=(n=w[C]).rexSizer).padding,n.isRexSizer?n.layout(this,(g=this,y=void 0,m=n.rexSizer,x=m.padding,m.expand&&(y=g.width-x.left-x.right),y),(d=this,f=void 0,v=n.rexSizer,p=v.padding,v.expand&&(f=d.height-p.top-p.bottom),f)):(c=u=void 0,s.expand&&(c=this.height-r.top-r.bottom,u=this.width-r.left-r.right),zs(n,u,c)),o=k+r.left,h=this.width-r.left-r.right,a=b+r.top,l=this.height-r.top-r.bottom,Sn.setPosition(o,a).setSize(h,l),$n(n,Sn,s.align),this.resetChildPositionState(n);return this.layoutBackgrounds(),this.postLayout()},_layoutInit:function(){this._childrenWidth=void 0,this._childrenHeight=void 0}},Na=Phaser.Utils.Objects.IsPlainObject,Ja=Phaser.Utils.Objects.GetValue,Za=Phaser.Structs.Map,Ka=function(){function a(t,e,i,n,s,r){var o;return M(this,a),Na(e)?(e=Ja(r=e,"x",0),i=Ja(r,"y",0),n=Ja(r,"width",void 0),s=Ja(r,"height",void 0)):Na(n)&&(n=Ja(r=n,"width",void 0),s=Ja(r,"height",void 0)),(o=I(this,E(a).call(this,t,e,i,n,s,r))).type="rexPages",o._previousKey=void 0,o._currentKey=void 0,o.sizerChildren=new Za,o.setSwapMode(Ja(r,"swapMode",0)),o.addChildrenMap("pages",o.pages),o}return e(a,Hs),v(a,[{key:"destroy",value:function(t){this.scene&&(this.sizerChildren.clear(),d(E(a.prototype),"destroy",this).call(this,t))}},{key:"setSwapMode",value:function(t){return"string"==typeof t&&(t=qa[t]),this.swapMode=t,this}},{key:"previousKey",get:function(){return this._previousKey}},{key:"currentKey",get:function(){return this._currentKey},set:function(t){this.swapPage(t)}},{key:"currentPage",get:function(){return this.getPage(this.currentKey)}},{key:"previousPage",get:function(){return this.getPage(this.previousKey)}},{key:"keys",get:function(){return this.sizerChildren.keys()}},{key:"pages",get:function(){return this.sizerChildren.entries}}]),a}();Object.assign(Ka.prototype,Ua);var qa={invisible:0,destroy:1};c.register("pages",function(t,e,i,n,s){var r=new Ka(this.scene,t,e,i,n,s);return this.scene.add.existing(r),r}),ct(window,"RexPlugins.UI.Pages",Ka);function $a(t){return(t-this.textLineSpacing)/(this.textLineHeight+this.textLineSpacing)}function Qa(t){return t*(this.textLineHeight+this.textLineSpacing)-this.textLineSpacing}function th(){var t=this.textObject.rexSizer;this.textObject.y+=t.offsetY-t.preOffsetY,t.preOffsetY=t.offsetY,this.resetChildPositionState(this.textObject)}var eh=Phaser.Display.Align.TOP_LEFT,ih={setTextObject:function(t,e){void 0===e&&(e=!0),this.add(t);var i=this.getSizerConfig(t);return i.parent=this,i.align=eh,i.padding=Fs(0),i.expand=!0,this.textObject=t,this.textObjectType=Ta(t)?0:1,i.preOffsetY=0,i.offsetY=0,e&&(this.textMask=new pr(this),this.textObject.setMask(this.textMask.createGeometryMask()),this.add(this.textMask)),this},setText:function(t){return void 0!==t&&(this.text=t),0===this.textObjectType?this.lines=this.textObject.getWrappedText(this.text):this.lines=this.textObject.getPenManager(this.text,this.lines),this.updateTextObject(),this},updateTextObject:function(){var t=Math.max(Math.floor($a.call(this,-this.textOY)),0),e=Qa.call(this,t)+this.textOY;return this.textObject.setText(function(t){var e,i=t+this.textObject.style.maxLines;if(0===this.textObjectType)e=this.lines.slice(t,i).join("\n");else{var n=this.lines.getLineStartIndex(t),s=this.lines.getLineEndIndex(i-1);e=this.lines.getSliceTagText(n,s,!0)}return e}.call(this,t)),this.textObject.rexSizer.offsetY=e,th.call(this),this},layout:function(t,e,i){if(this.rexSizer.hidden)return this;var n,s,r;this.preLayout(t),void 0===e&&(e=this.minWidth),void 0===i&&(i=this.minHeight),this.resize(e,i);var o,a,h,l,u=this.left,c=this.top;return(n=this.textObject).rexSizer.hidden||(o=u+(r=(s=n.rexSizer).padding).left,a=c+r.top,h=this.width-r.left-r.right,l=this.height-r.top-r.bottom,function(t,e,i){if(i+=this.textLineHeight+this.textLineSpacing,t.width!==e||t.height!==i){t.setFixedSize(e,i);var n=t.style,s=Math.max(e,0),r=Math.ceil($a.call(this,i))+1;0===this.textObjectType?n.wordWrapWidth=s:n.wrapWidth=s,n.maxLines=r,this.setText()}}.call(this,n,h,l),Sn.setPosition(o,a).setSize(h,l),$n(n,Sn,s.align),s.preOffsetY=0,th.call(this),this.textMask&&(this.textMask.setPosition().resize(),this.resetChildPositionState(this.textMask))),this.layoutBackgrounds(),this.postLayout()}},nh=Phaser.Utils.Objects.IsPlainObject,sh=Phaser.Utils.Objects.GetValue,rh=function(){function u(t,e,i,n,s,r){var o;M(this,u),nh(e)?(e=sh(r=e,"x",0),i=sh(r,"y",0),n=sh(r,"width",void 0),s=sh(r,"height",void 0)):nh(n)&&(n=sh(r=n,"width",void 0),s=sh(r,"height",void 0)),(o=I(this,E(u).call(this,t,e,i,n,s,r))).type="rexTextBlock",o.textObject=void 0,o.textMask=void 0,o.textObjectType=void 0,o.lines=void 0,o.text=sh(r,"content",""),o._textOY=0,o.execeedTopState=!1,o.execeedBottomState=!1,o.setClampMode(sh(r,"clamplTextOY",!0));var a=sh(r,"background",void 0),h=sh(r,"text",void 0);void 0===h&&(h=oh(t));var l=sh(r,"textMask",!0);return a&&o.addBackground(a),o.setTextObject(h,l),o}return e(u,Hs),v(u,[{key:"destroy",value:function(t){this.scene&&(this.textObject=void 0,(this.textMask=void 0)===this.lines||(0===this.textObjectType?this.lines.length=0:this.lines.destroy()),d(E(u.prototype),"destroy",this).call(this,t))}},{key:"setClampMode",value:function(t){return this.clampTextOYMode=t,this}},{key:"textOYExceedTop",value:function(t){return void 0===t&&(t=this.textOY),t>this.topTextOY}},{key:"textOYExeceedBottom",value:function(t){return void 0===t&&(t=this.textOY),t<this.bottomTextOY}},{key:"setTextOY",value:function(t){return this.textOY=t,this}},{key:"setTextOYByPercentage",value:function(t){return this.t=t,this}},{key:"textLineHeight",get:function(){var t=this.textObject.style;return t.metrics.fontSize+t.strokeThickness}},{key:"textLineSpacing",get:function(){return this.textObject.lineSpacing}},{key:"linesCount",get:function(){return void 0===this.lines?0:0===this.textObjectType?this.lines.length:this.lines.linesCount}},{key:"visibleLinesCount",get:function(){return Math.floor($a.call(this,this.textObject.height))}},{key:"topTextOY",get:function(){return 0}},{key:"bottomTextOY",get:function(){return-this.textVisibleHeight}},{key:"textHeight",get:function(){return Qa.call(this,this.linesCount)}},{key:"textObjectHeight",get:function(){return this.textObject.height-this.textLineHeight-this.textLineSpacing}},{key:"textVisibleHeight",get:function(){var t=this.textHeight,e=this.textObjectHeight;return e<t?t-e:0}},{key:"textOY",get:function(){return this._textOY},set:function(t){var e=this.topTextOY,i=this.bottomTextOY,n=this.textOYExceedTop(t),s=this.textOYExeceedBottom(t);this.clampTextOYMode&&(this.visibleLinesCount>this.linesCount?t=0:n?t=e:s&&(t=i)),this._textOY!==t&&(this._textOY=t,this.updateTextObject()),n&&(this.execeedTopState||this.emit("execeedtop",this,t,e)),this.execeedTopState=n,s&&(this.execeedBottomState||this.emit("execeedbottom",this,t,i)),this.execeedBottomState=s}},{key:"t",set:function(t){this.textOY=-this.textVisibleHeight*t},get:function(){var t=this.textVisibleHeight;return 0===t?0:this.textOY/-t}}]),u}(),oh=function(t){return t.add.text(0,0,"")};Object.assign(rh.prototype,ih),c.register("textBlock",function(t,e,i,n,s,r){var o=new rh(this.scene,t,e,i,n,s,r);return this.scene.add.existing(o),o}),ct(window,"RexPlugins.UI.TextBlock",rh);var ah=Phaser.Utils.Objects.GetValue,hh=function(){function d(t,e){var i;M(this,d),void 0===e&&(e={});var n=ah(e,"text",void 0),s=ah(e,"textWidth",void 0),r=ah(e,"textHeight",void 0),o=ah(e,"textMask",!0),a=ah(e,"content",""),h=new rh(t,{width:s,height:r,text:n,textMask:o,content:a,clamplTextOY:ah(e,"clamplChildOY",!1)}),l=void 0===s?1:0,u=void 0===r;!function(e){Object.defineProperty(e,"childOY",{configurable:!0,get:function(){return e.textOY},set:function(t){e.textOY=t}}),Object.defineProperty(e,"topChildOY",{get:function(){return e.topTextOY}}),Object.defineProperty(e,"bottomChildOY",{get:function(){return e.bottomTextOY}})}(h),e.scrollMode=0,e.type="rexTextArea",e.child={gameObject:h,proportion:l,expand:u};var c=ah(e,"space",void 0);return c&&(c.child=c.text),(i=I(this,E(d).call(this,t,e))).addChildrenMap("text",n),i}return e(d,Mo),v(d,[{key:"text",get:function(){return this.childrenMap.child.text}},{key:"linesCount",get:function(){return this.childrenMap.child.linesCount}}]),d}(),lh={setText:function(t){return this.childrenMap.child.setText(t),this.resizeController(),this},appendText:function(t){return this.setText(this.text+t),this}};Object.assign(hh.prototype,lh),c.register("textArea",function(t){var e=new hh(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.TextArea",hh);var uh=Phaser.Utils.Objects.GetValue,ch=Phaser.Display.Align.TOP_LEFT,dh={setChild:function(t,e,i){t.setOrigin&&t.setOrigin(0),this.add(t);var n,s,r=this.getSizerConfig(t);if(r.parent=this,r.align=ch,r.expand=e,this.child=t,!0===i?(n=!0,s=0):!1===i?n=!1:(n=uh(i,"mask",!0),s=uh(i,"padding",0)),n){var o=new pr(this,0,s);this.childMask=o.createGeometryMask(),this.add(o)}return this},getChildrenWidth:function(){if(this.rexSizer.hidden)return 0;var t=this.child;return t.rexSizer.hidden?0:0===this.scrollMode?t.isRexSizer?Math.max(t.minWidth,t.childrenWidth):t.displayWidth:0},getChildrenHeight:function(){if(this.rexSizer.hidden)return 0;var t=this.child;return t.rexSizer.hidden?0:0===this.scrollMode?0:t.isRexSizer?Math.max(t.minHeight,t.childrenHeight):t.displayHeight},resetChildPosition:function(){var t=this.left,e=this.top;0===this.scrollMode?e+=this.childOY:t+=this.childOY,this.child.setPosition(t,e),jo(this,this.childMask,this.child.getAllChildren()),this.resetChildPositionState(this.child)},layout:function(t,e,i){if(this.rexSizer.hidden)return this;this.preLayout(t),void 0===e&&(e=Math.max(this.childrenWidth,this.minWidth)),void 0===i&&(i=Math.max(this.childrenHeight,this.minHeight)),this.resize(e,i);var n,s,r=this.child;if(!r.rexSizer.hidden&&(0===this.scrollMode?n=this.width:s=this.height,r.isRexSizer?r.layout(this,n,s):zs(r,n,s),this.resetChildPosition(),this.childMask)){var o=Io(this.childMask);o.setPosition().resize(),this.resetChildPositionState(o)}return this.postLayout()}},fh=Phaser.Utils.Objects.IsPlainObject,vh=Phaser.Utils.Objects.GetValue,ph=function(){function u(t,e,i,n,s,r){var o;M(this,u),fh(e)?(e=vh(r=e,"x",0),i=vh(r,"y",0),n=vh(r,"width",void 0),s=vh(r,"height",void 0)):fh(n)&&(n=vh(r=n,"width",void 0),s=vh(r,"height",void 0)),(o=I(this,E(u).call(this,t,e,i,n,s,r))).type="rexScrollableBlock",o.child=void 0,o.childMask=void 0,o._childOY=0,o.execeedTopState=!1,o.execeedBottomState=!1,o.setScrollMode(vh(r,"scrollMode",!0)),o.setClampMode(vh(r,"clamplChildOY",!0));var a=vh(r,"child",void 0),h=vh(r,"expand",!0),l=vh(r,"mask",void 0);return o.setChild(a,h,l),o}return e(u,Hs),v(u,[{key:"destroy",value:function(t){this.scene&&(this.child=void 0,this.childMask&&(this.childMask.destroy(),this.childMask=void 0),d(E(u.prototype),"destroy",this).call(this,t))}},{key:"setScrollMode",value:function(t){return"string"==typeof t&&(t=co[t.toLowerCase()]),this.scrollMode=t,this}},{key:"setClampMode",value:function(t){return this.clampChildOYMode=t,this}},{key:"childOYExceedTop",value:function(t){return void 0===t&&(t=this.childOY),t>this.topChildOY}},{key:"childOYExeceedBottom",value:function(t){return void 0===t&&(t=this.childOY),t<this.bottomChildOY}},{key:"setChildOY",value:function(t){return this.childOY=t,this}},{key:"setChildOYByPercentage",value:function(t){return this.t=t,this}},{key:"instHeight",get:function(){return 0===this.scrollMode?this.height:this.width}},{key:"instWidth",get:function(){return 0===this.scrollMode?this.width:this.height}},{key:"childHeight",get:function(){return 0===this.scrollMode?this.child.displayHeight:this.child.displayWidth}},{key:"childWidth",get:function(){return 0===this.scrollMode?this.child.displayWidth:this.child.displayHeight}},{key:"topChildOY",get:function(){return 0}},{key:"bottomChildOY",get:function(){return-this.visibleHeight}},{key:"visibleHeight",get:function(){var t=this.childHeight,e=this.instHeight;return e<t?t-e:0}},{key:"childOY",get:function(){return this._childOY},set:function(t){var e=this.topChildOY,i=this.bottomChildOY,n=this.childOYExceedTop(t),s=this.childOYExeceedBottom(t);this.clampChildOYMode&&(this.instHeight>this.childHeight?t=0:n?t=e:s&&(t=i)),this._childOY!==t&&(this._childOY=t,this.resetChildPosition()),n&&(this.execeedTopState||this.emit("execeedtop",this,t,e)),this.execeedTopState=n,s&&(this.execeedBottomState||this.emit("execeedbottom",this,t,i)),this.execeedBottomState=s}},{key:"t",set:function(t){this.childOY=-this.visibleHeight*t},get:function(){var t=this.visibleHeight;return 0===t?0:this.childOY/-t}}]),u}();Object.assign(ph.prototype,dh),c.register("scrollableBlock",function(t){var e=new ph(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.ScrollableBlock",ph);var gh=Phaser.Utils.Objects.GetValue,yh=function(){function c(t,e){var i;M(this,c),void 0===e&&(e={});var n=uo(e),s=gh(e,"panel",void 0);void 0===s&&(s={}),s.scrollMode=n,s.clamplChildOY=gh(e,"clamplChildOY",!1);var r,o,a=new ph(t,s),h=gh(s,"width",void 0),l=gh(s,"height",void 0);o=0===n?(r=void 0===h?1:0,void 0===l):(r=void 0===l?1:0,void 0===h),e.type="rexScrollablePanel",e.child={gameObject:a,proportion:r,expand:o};var u=gh(e,"space",void 0);return u&&(u.child=u.panel),(i=I(this,E(c).call(this,t,e))).addChildrenMap("panel",i.childrenMap.child.child),i}return e(c,Mo),c}();c.register("scrollablePanel",function(t){var e=new yh(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.ScrollablePanel",yh);function mh(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length),t.length=n-i;for(var s=0,r=t.length;s<r;s++)t[s]=e[s+i];return t}function xh(t){return"string"!=typeof t||(""===t?t=null:Ph.test(t)?t=parseFloat(t):"false"===screen?t=!1:"true"===t&&(t=!0)),t}function kh(t){return"[object Array]"===Object.prototype.toString.call(t)}function bh(t,e,i){var n,s=Mh(i,"reverse",!1);if(kh(t[0]))if(s)for(r=(o=t.length)-1;0<=r;r--)n=bh(t[r],e,i);else for(var r=0,o=t.length;r<o;r++)n=bh(t[r],e,i);else n=Eh(t,e,i);return n}var wh={popUp:0,fadeIn:1,scaleDown:0,fadeOut:1},Ch=function(t,e){t.popUp(e)},Sh=function(t,e){t.scaleDownDestroy(e,void 0,void 0,!1)},Oh=function(t,e){t.fadeIn(e)},Th=function(t,e){t.fadeOut(e,!1)},Ph=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,Mh=Phaser.Utils.Objects.GetValue,Eh=function(t,e,i){var n,s=Mh(i,"argsConvert",void 0),r=Mh(i,"argsConvertScope",void 0),o=t[0];if(_h=mh(_h,t,1),s){!0===s&&(s=xh,r=void 0);for(var a=0,h=_h.length;a<h;a++)_h[a]=r?s.call(r,_h[a],t):s(_h[a],t)}return"string"==typeof o?null==(n=e[o])&&(n=Mh(e,o,null)):n=o,n.apply(e,_h)},_h=[],Ih=function(){function n(t,e){var i;return M(this,n),(i=I(this,E(n).call(this,t,e))).parent=t,i.scene=qn(t),i.resetFromJSON(e),i.boot(),i}return e(n,ta),v(n,[{key:"resetFromJSON",value:function(t){return this.isRunning=vo(t,"isRunning",!1),this.state=vo(t,"state",0),this.commands=vo(t,"commands",[]),this.scope=vo(t,"scope",void 0),this.setTimeUnit(vo(t,"timeUnit",0)),this.setDtMode(vo(t,"dtMode",0)),this.setTimeScale(vo(t,"timeScale",1)),this.index=vo(t,"index",0),this.nextDt=vo(t,"nextDt",0),this.seek(vo(t,"now",0)),this.timeScale=vo(t,"timeScale",1),this}},{key:"toJSON",value:function(){return{isRunning:this.isRunning,state:this.state,commands:this.commands,scope:this.scope,timeUnit:this.timeUnit,dtMode:this.dtMode,index:this.index,nextDt:this.nextDt,now:this.now,timeScale:this.timeScale,tickingMode:this.tickingMode}}},{key:"boot",value:function(){d(E(n.prototype),"boot",this).call(this);var t=function(t){return Kn(t)?t.events:t.on?t:void 0}(this.parent);t&&t.once("destroy",this.destroy,this)}},{key:"shutdown",value:function(){d(E(n.prototype),"shutdown",this).call(this),this.parent=void 0,this.scene=void 0,this.commands=void 0}},{key:"destroy",value:function(){this.shutdown()}},{key:"startTicking",value:function(){d(E(n.prototype),"startTicking",this).call(this),this.scene.events.on("update",this.update,this)}},{key:"stopTicking",value:function(){d(E(n.prototype),"stopTicking",this).call(this),this.scene&&this.scene.events.off("update",this.update,this)}},{key:"load",value:function(t,e,i){this.stop();var n=vo(i,"timeUnit",void 0);void 0!==n&&this.setTimeUnit(n);var s=vo(i,"dtMode",void 0);return void 0!==s&&this.setDtMode(s),t=t.filter(function(t){var e=t[0];return!isNaN(e)}).map(function(t){return"string"==typeof t[0]&&(t[0]=parseFloat(t[0])),t}),0===this.dtMode&&t.sort(function(t,e){var i=t[0],n=e[0];return n<i?1:i<n?-1:0}),this.commands=t,this.scope=e,this}},{key:"start",value:function(t){return void 0===t&&(t=0),this.stop(),this.index=0,this.isRunning=!0,this.state=1,this.nextDt=this.getNextDt(0),this.seek(t),this.update(),this}},{key:"pause",value:function(){return this.isRunning=!1,this}},{key:"resume",value:function(){return this.isRunning=!0,this}},{key:"stop",value:function(){return this.isRunning=!1,this.state=0,this}},{key:"seek",value:function(t){return this.now=t,this}},{key:"setTimeScale",value:function(t){this.timeScale=t}},{key:"update",value:function(t,e){if(!this.isRunning)return this;if(void 0!==t){if(0===this.timeScale||0===e)return this;this.now+=e*this.timeScale}if(this.nextDt>this.now)return this;for(;;){var i=this.commands[this.index],n=i[1];if(kh(n)||(n=mh(jh,i,1)),bh(n,this.scope),this.emit("runcommand",n,this.scope),this.index===this.commands.length-1)return this.complete(),this;if(this.index++,this.nextDt=this.getNextDt(this.nextDt),this.nextDt>this.now)return this}}},{key:"complete",value:function(){d(E(n.prototype),"complete",this).call(this),this.state=2}},{key:"getNextDt",value:function(t){var e=this.commands[this.index][0];return 1===this.timeUnit&&(e*=1e3),1===this.dtMode&&(e+=t),e}},{key:"setDtMode",value:function(t){return"string"==typeof t&&(t=zh[t]),this.dtMode=t,this}},{key:"setTimeUnit",value:function(t){return"string"==typeof t&&(t=Dh[t]),this.timeUnit=t,this}},{key:"isPlaying",get:function(){return this.isRunning}},{key:"completed",get:function(){return 2===this.state}}]),n}(),jh=[],Dh={ms:0,s:1,sec:1},zh={abs:0,absolute:0,inc:1,increment:1},Rh=Phaser.Utils.Objects.GetValue,Bh=function(){function n(t,e){var i;return M(this,n),void 0===e&&(e={text:createDefaultTextObject(t)}),(i=I(this,E(n).call(this,t,e))).type="rexToast",i.setTransitInTime(Rh(e,"duration.in",200)),i.setDisplayTime(Rh(e,"duration.hold",1200)),i.setTransitOutTime(Rh(e,"duration.out",200)),i.setTransitInCallback(Rh(e,"transitIn",wh.popUp)),i.setTransitOutCallback(Rh(e,"transitOut",wh.scaleDown)),i.player=new Ih(_(i),{dtMode:1}),i.messages=[],i.setVisible(!1),i}return e(n,mr),v(n,[{key:"destroy",value:function(t){this.scene&&(this.player.destroy(),this.player=void 0,this.messages=void 0,d(E(n.prototype),"destroy",this).call(this,t))}},{key:"setDisplayTime",value:function(t){return this.displayTime=t,this}},{key:"setTransitOutTime",value:function(t){return this.transitOutTime=t,this}},{key:"setTransitInTime",value:function(t){return this.transitInTime=t,this}},{key:"setTransitInCallback",value:function(t){switch("string"==typeof t&&(t=wh[t]),t){case wh.popUp:t=Ch;break;case wh.fadeIn:t=Oh}return this.transitInCallback=t,this}},{key:"setTransitOutCallback",value:function(t){switch("string"==typeof t&&(t=wh[t]),t){case wh.scaleDown:t=Sh;break;case wh.fadeOut:t=Th}return this.transitOutCallback=t,this}},{key:"show",value:function(t){if(void 0===t){if(0===this.messages.length)return this;t=this.messages.shift()}if(this.player.isPlaying)return this.messages.push(t),this;this.setScale(1,1).setVisible(!0),"string"==typeof t?this.setText(t):t(this),this.layout();var e=[[0,[this.transitInCallback,this,this.transitInTime]],[this.transitInTime,[K]],[this.displayTime,[this.transitOutCallback,this,this.transitOutTime]],[this.transitOutTime,[this.setVisible,!1]],[30,[K]]];return this.player.load(e,this).once("complete",function(){this.show()},this).start(),this}}]),n}();c.register("toast",function(t){var e=new Bh(this.scene,t);return this.scene.add.existing(e),e}),ct(window,"RexPlugins.UI.Toast",Bh);function Yh(t){return t instanceof Lh}var Lh=Phaser.GameObjects.GameObject;c.register("tap",function(t,e){return Yh(t)||(e=t,t=this.scene),new ua(t,e)}),ct(window,"RexPlugins.UI.Tap",ua),c.register("press",function(t,e){return Yh(t)||(e=t,t=this.scene),new pa(t,e)}),ct(window,"RexPlugins.UI.Press",pa);var Hh=Phaser.Math.Distance.Between,Fh=Phaser.Math.Angle.Between,Vh={getDt:function(){return this.scene.sys.game.loop.delta},getVelocity:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Hh(e.x,e.y,t.x,t.y)/(.001*this.getDt())},getVelocityX:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Math.abs(t.x-e.x)/(.001*this.getDt())},getVelocityY:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Math.abs(t.y-e.y)/(.001*this.getDt())},getVelocityAngle:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Fh(e.x,e.y,t.x,t.y)}},Xh={"up&down":0,"left&right":1,"4dir":2,"8dir":3},Wh={},Ah=Phaser.Utils.Objects.GetValue,Gh=Phaser.Math.RadToDeg,Uh=function(){function r(t,e){var i;M(this,r);var n=_(i=I(this,E(r).call(this,t,e))),s={states:{IDLE:{},BEGIN:{enter:function(){n.validDrag=!1}},RECOGNIZED:{enter:function(){n.start(),n.updateDirectionStates(),n.emit("swipe",n,n.gameObject,n.lastPointer)},exit:function(){n.stop(),n.clearDirectionStates()}}},init:function(){this.state=Nh},eventEmitter:!1};return i.setRecongizedStateObject(new po(s)),i.clearDirectionStates(),i}return e(r,sa),v(r,[{key:"resetFromJSON",value:function(t){return d(E(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(Ah(t,"threshold",10)),this.setMinDragVelocity(Ah(t,"velocityThreshold",1e3)),this.setDirectionMode(Ah(t,"dir","8dir")),this}},{key:"onDragStart",value:function(){this.state=Jh}},{key:"onDragEnd",value:function(){this.state=Nh}},{key:"onDrag",value:function(){this.state===Jh&&(this.vaildDrag||(this.vaildDrag=0===this.dragThreshold||this.pointer.getDistance()>=this.dragThreshold),this.vaildDrag&&this.dragVelocity>this.minDragVelocity&&(this.state=Zh))}},{key:"postUpdate",value:function(t,e){this.state===Zh&&(this.state=Nh)}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"setMinDragVelocity",value:function(t){return this.minDragVelocity=t,this}},{key:"setDirectionMode",value:function(t){return"string"==typeof t&&(t=Xh[t]),this.dirMode=t,this}},{key:"updateDirectionStates",value:function(){return function(t,e,i){switch(void 0===i?i={}:!0===i&&(i=Wh),i.left=!1,i.right=!1,i.up=!1,i.down=!1,t=(t+360)%360,e){case 0:t<180?i.down=!0:i.up=!0;break;case 1:90<t&&t<=270?i.left=!0:i.right=!0;break;case 2:45<t&&t<=135?i.down=!0:135<t&&t<=225?i.left=!0:225<t&&t<=315?i.up=!0:i.right=!0;break;case 3:22.5<t&&t<=67.5?(i.down=!0,i.right=!0):67.5<t&&t<=112.5?i.down=!0:112.5<t&&t<=157.5?(i.down=!0,i.left=!0):157.5<t&&t<=202.5?i.left=!0:202.5<t&&t<=247.5?(i.left=!0,i.up=!0):247.5<t&&t<=292.5?i.up=!0:(292.5<t&&t<=337.5&&(i.up=!0),i.right=!0)}}(Gh(this.getVelocityAngle()),this.dirMode,this),this}},{key:"clearDirectionStates",value:function(){return this.left=!1,this.right=!1,this.up=!1,this.down=!1,this}},{key:"isSwiped",get:function(){return this.state===Zh}},{key:"dragVelocity",get:function(){var t;switch(this.dirMode){case 0:t=this.getVelocityX();break;case 1:t=this.getVelocityY();break;default:t=this.getVelocity()}return t}}]),r}();Object.assign(Uh.prototype,Vh);var Nh="IDLE",Jh="BEGIN",Zh="RECOGNIZED";c.register("swipe",function(t,e){return Yh(t)||(e=t,t=this.scene),new Uh(t,e)}),ct(window,"RexPlugins.UI.Swipe",Uh);var Kh=Phaser.Utils.Objects.GetValue,qh=function(){function r(t,e){var i;M(this,r);var n=_(i=I(this,E(r).call(this,t,e))),s={states:{IDLE:{},BEGIN:{enter:function(){var t=n.pointer;n.startX=t.x,n.startY=t.y,n.startWorldX=t.worldX,n.startWorldY=t.worldY}},RECOGNIZED:{enter:function(){n.emit("panstart",n,n.gameObject,n.lastPointer)},exit:function(){var t=n.lastPointer;n.endX=t.x,n.endY=t.y,n.endWorldX=t.worldX,n.endWorldY=t.worldY,n.emit("panend",n,n.gameObject,n.lastPointer)}}},init:function(){this.state=$h},eventEmitter:!1};return i.setRecongizedStateObject(new po(s)),i}return e(r,sa),v(r,[{key:"resetFromJSON",value:function(t){return d(E(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(Kh(t,"threshold",10)),this}},{key:"onDragStart",value:function(){this.state=0===this.dragThreshold?tl:Qh}},{key:"onDragEnd",value:function(){this.state=$h}},{key:"onDrag",value:function(){switch(this.state){case Qh:this.pointer.getDistance()>=this.dragThreshold&&(this.state=tl);break;case tl:var t=this.pointer.position,e=this.pointer.prevPosition;this.dx=t.x-e.x,this.dy=t.y-e.y;var i=this.pointer;self.x=i.x,self.y=i.y,self.worldX=i.worldX,self.worldY=i.worldY,this.emit("pan",this)}}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"isPan",get:function(){return this.state===tl}}]),r}(),$h="IDLE",Qh="BEGIN",tl="RECOGNIZED";c.register("pan",function(t,e){return Yh(t)||(e=t,t=this.scene),new qh(t,e)}),ct(window,"RexPlugins.UI.Pan",qh);var el=Phaser.Utils.Objects.GetValue,il=Phaser.Utils.Array.SpliceOne,nl=Phaser.Math.Distance.Between,sl=Phaser.Math.Angle.Between,rl=function(){function n(t,e){M(this,n);var i=t.input.manager.pointersTotal-1;i<2&&t.input.addPointer(2-i),this.scene=t,this.setEventEmitter(el(e,"eventEmitter",void 0)),this.pointers=[],this.movedState={},this.resetFromJSON(e),this.boot()}return v(n,[{key:"resetFromJSON",value:function(t){return this.setEnable(el(t,"enable",!0)),this.bounds=el(t,"bounds",void 0),this.tracerState=al,this.pointers.length=0,gt(this.movedState),this}},{key:"boot",value:function(){this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function(){this.destroyEventEmitter(),this.pointers.length=0,gt(this.movedState),this.scene&&(this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.events.off("destroy",this.destroy,this),this.scene=void 0),this.scene=void 0}},{key:"destroy",value:function(){this.shutdown()}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable===t||(t||this.dragCancel(),this.enable=t),this}},{key:"onPointerDown",value:function(t){if(this.enable&&(2!==this.pointers.length&&(!this.bounds||this.bounds.contains(t.x,t.y))&&-1===this.pointers.indexOf(t)))switch(this.movedState[t.id]=!1,this.pointers.push(t),this.tracerState){case al:this.tracerState=hl,this.onDrag1Start();break;case hl:this.tracerState=ll,this.onDrag2Start()}}},{key:"onPointerUp",value:function(t){if(this.enable&&(!this.bounds||this.bounds.contains(t.x,t.y))){var e=this.pointers.indexOf(t);if(-1!==e)switch(delete this.movedState[t.id],il(this.pointers,e),this.tracerState){case hl:this.tracerState=al,this.onDrag1End();break;case ll:this.tracerState=hl,this.onDrag2End(),this.onDrag1Start()}}}},{key:"onPointerMove",value:function(t){if(this.enable&&t.isDown){var e=!this.bounds||this.bounds.contains(t.x,t.y),i=-1!==this.pointers.indexOf(t);if(!i&&e);else if(i&&!e)this.onPointerUp(t);else if(this.movedState[t.id]||(this.movedState[t.id]=t.x!==t.downX||t.y!==t.downY),this.movedState[t.id])switch(this.tracerState){case hl:this.onDrag1();break;case ll:this.onDrag2()}}}},{key:"dragCancel",value:function(){return this.tracerState===ll&&this.onDrag2End(),this.pointers.length=0,gt(this.movedState),this.tracerState=al,this}},{key:"onDrag1Start",value:function(){this.emit("drag1start",this)}},{key:"onDrag1End",value:function(){this.emit("drag1end",this)}},{key:"onDrag1",value:function(){this.emit("drag1",this)}},{key:"onDrag2Start",value:function(){this.emit("drag2start",this)}},{key:"onDrag2End",value:function(){this.emit("drag2end",this)}},{key:"onDrag2",value:function(){this.emit("drag2",this)}},{key:"setRecongizedStateObject",value:function(t){return this.recongizedState=t,this}},{key:"cancel",value:function(){return this.state=ul,this}},{key:"distanceBetween",get:function(){if(this.tracerState!==ll)return 0;var t=this.pointers[0],e=this.pointers[1];return nl(t.x,t.y,e.x,e.y)}},{key:"angleBetween",get:function(){if(this.tracerState!==ll)return 0;var t=this.pointers[0],e=this.pointers[1];return sl(t.x,t.y,e.x,e.y)}},{key:"drag1Vector",get:function(){var t=this.pointers[0];if(t&&this.movedState[t.id]){var e=t.position,i=t.prevPosition;ol.x=e.x-i.x,ol.y=e.y-i.y}else ol.x=0,ol.y=0;return ol}},{key:"centerX",get:function(){if(this.tracerState!==ll)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.x+e.x)/2}},{key:"centerY",get:function(){if(this.tracerState!==ll)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.y+e.y)/2}},{key:"prevCenterX",get:function(){if(this.tracerState!==ll)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.x+e.x)/2}},{key:"prevCenterY",get:function(){if(this.tracerState!==ll)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.y+e.y)/2}},{key:"movementCenterX",get:function(){return this.centerX-this.prevCenterX}},{key:"movementCenterY",get:function(){return this.centerY-this.prevCenterY}},{key:"state",get:function(){return this.recongizedState.state},set:function(t){this.recongizedState.state=t}}]),n}();Object.assign(rl.prototype,hs);var ol={},al=0,hl=1,ll=2,ul="IDLE",cl=Phaser.Utils.Objects.GetValue,dl=function(){function r(t,e){var i;M(this,r);var n=_(i=I(this,E(r).call(this,t,e))),s={states:{IDLE:{enter:function(){n.prevDistance=void 0,n.scaleFactor=1}},BEGIN:{},RECOGNIZED:{enter:function(){n.emit("pinchstart",n)},exit:function(){n.emit("pinchend",n)}}},init:function(){this.state=fl},eventEmitter:!1};return i.setRecongizedStateObject(new po(s)),i}return e(r,rl),v(r,[{key:"resetFromJSON",value:function(t){return d(E(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(cl(t,"threshold",0)),this}},{key:"onDrag2Start",value:function(){this.scaleFactor=1,this.prevDistance=this.distanceBetween,this.state=0===this.dragThreshold?pl:vl}},{key:"onDrag2End",value:function(){this.state=fl}},{key:"onDrag2",value:function(){switch(this.state){case vl:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var t=this.distanceBetween;this.scaleFactor=t/this.prevDistance,this.prevDistance=t,this.state=pl}break;case pl:t=this.distanceBetween;this.scaleFactor=t/this.prevDistance,this.emit("pinch",this),this.prevDistance=t}}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"isPinch",get:function(){return this.state===pl}}]),r}(),fl="IDLE",vl="BEGIN",pl="RECOGNIZED";c.register("pinch",function(t){return new dl(this.scene,t)}),ct(window,"RexPlugins.UI.Pinch",dl);function gl(t,e,i,n){return yl(t,e,i,n),t.rotation+=n,t}var yl=Phaser.Math.RotateAround,ml={},xl=Phaser.Utils.Objects.GetValue,kl=Phaser.Math.Angle.WrapDegrees,bl=Phaser.Math.Angle.ShortestBetween,wl=Phaser.Math.RadToDeg,Cl=Phaser.Math.DegToRad,Sl=function(){function r(t,e){var i;M(this,r);var n=_(i=I(this,E(r).call(this,t,e))),s={states:{IDLE:{enter:function(){n.prevAngle=void 0,n.angle=0}},BEGIN:{},RECOGNIZED:{enter:function(){n.emit("rotatestart",n)},exit:function(){n.emit("rotateend",n)}}},init:function(){this.state=Tl},eventEmitter:!1};return i.setRecongizedStateObject(new po(s)),i}return e(r,rl),v(r,[{key:"resetFromJSON",value:function(t){return d(E(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(xl(t,"threshold",0)),this}},{key:"onDrag2Start",value:function(){this.prevAngle=kl(wl(this.angleBetween)),this.state=0===this.rotationThreshold?Ml:Pl}},{key:"onDrag2End",value:function(){this.state=Tl}},{key:"onDrag2",value:function(){switch(this.state){case Pl:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var t=kl(wl(this.angleBetween));this.angle=bl(this.prevAngle,t),this.prevAngle=t,this.state=Ml}break;case Ml:t=kl(wl(this.angleBetween));this.angle=bl(this.prevAngle,t),this.prevAngle=t,this.emit("rotate",this)}}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"isRotation",get:function(){return this.state===Ml}},{key:"rotation",get:function(){return Cl(this.angle)}}]),r}(),Ol={spinObject:function(t,e){if(!this.isRotation)return this;void 0===e&&(e=this.pointers[0].camera);var i=this.movementCenterX,n=this.movementCenterY;e.getWorldPoint(this.centerX,this.centerY,ml);var s=ml.x,r=ml.y,o=this.rotation;if(Array.isArray(t))for(var a=t,h=0,l=a.length;h<l;h++)(t=a[h]).x+=i,t.y+=n,gl(t,s,r,o);else t.x+=i,t.y+=n,gl(t,x,y,o);return this}};Object.assign(Sl.prototype,Ol);var Tl="IDLE",Pl="BEGIN",Ml="RECOGNIZED";c.register("rotate",function(t){return new Sl(this.scene,t)}),ct(window,"RexPlugins.UI.Rotate",Sl);function El(e,i,t){var n;if(void 0===e)e=t.texture.key,i=t.frame.name;else if(_l(e)){var s=e;e=Il(s,"key",t.texture.key),i=Il(s,"frame",t.frame.name)}else"string"==typeof e||(n=e);return void 0===n&&(n=function(t){t.setTexture(e,i)}),n}var _l=Phaser.Utils.Objects.IsPlainObject,Il=Phaser.Utils.Objects.GetValue,jl=Phaser.Utils.Objects.GetValue,Dl=Phaser.Utils.Objects.GetAdvancedValue,zl=function(){function i(t,e){M(this,i),this.gameObject=t,this.scene=qn(t),this.setEventEmitter(jl(e,"eventEmitter",void 0)),this.scaleStart={},this.scaleEnd={},this.tween=void 0,this.resetFromJSON(e),this.boot()}return v(i,[{key:"resetFromJSON",value:function(t){return this.setOrientation(jl(t,"orientation",0)),this.setDelay(Dl(t,"delay",0)),this.setDuration(Dl(t,"duration",500)),this.setEase(jl(t,"ease","Sine")),this.setFrontFace(jl(t,"front",void 0)),this.setBackFace(jl(t,"back",void 0)),this.setFace(jl(t,"face",0)),this}},{key:"boot",value:function(){this.gameObject.once&&this.gameObject.once("destroy",this.destroy,this)}},{key:"shutdown",value:function(){return this.destroyEventEmitter(),this.stop(),this.gameObject=void 0,this.scene=void 0,this}},{key:"destroy",value:function(){return this.shutdown(),this}},{key:"setOrientation",value:function(t){return"string"==typeof t&&(t=Rl[t]),this.orientation=t,this}},{key:"setDelay",value:function(t){return this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setEase",value:function(t){return void 0===t&&(t="Linear"),this.ease=t,this}},{key:"setFace",value:function(t){return this.face=t,this}},{key:"toggleFace",value:function(){var t=0===this.face?1:0;return this.setFace(t),this}},{key:"setFrontFace",value:function(t,e){return this.frontFaceCallback=El(t,e,this.gameObject),this}},{key:"setBackFace",value:function(t,e){return this.backFaceCallback=El(t,e,this.gameObject),this}},{key:"start",value:function(){if(this.isRunning)return this;if(0===this.duration)return this.toggleFace().complete(),this;var t={targets:this.gameObject,duration:this.duration/2,ease:this.ease,yoyo:!0,repeat:0,onYoyo:this.toggleFace,onYoyoScope:this,onComplete:this.complete,onCompleteScope:this};return t[0===this.orientation?"scaleX":"scaleY"]={from:1,to:0},this.tween=this.scene.tweens.add(t),this}},{key:"restart",value:function(){return this.stop().start(),this}},{key:"flip",value:function(t){return this.isRunning||(void 0!==t&&this.setDuration(t),this.start()),this}},{key:"stop",value:function(){return this.tween&&(this.tween.remove(),this.tween=void 0),this}},{key:"complete",value:function(){return this.stop(),this.emit("complete",this,this.gameObject),this}},{key:"isRunning",get:function(){return!!this.tween}},{key:"face",get:function(){return this._face},set:function(t){"string"==typeof t&&(t=Bl[t]),0===(this._face=t)&&this.frontFaceCallback?this.frontFaceCallback(this.gameObject):1===t&&this.backFaceCallback&&this.backFaceCallback(this.gameObject)}}]),i}();Object.assign(zl.prototype,hs);var Rl={x:0,horizontal:0,y:1,vertical:1},Bl={front:0,back:1};c.register("flip",function(t,e){return new zl(t,e)}),ct(window,"RexPlugins.UI.Flip",zl);var Yl=function(t){t.stopPropagation()},Ll=Phaser.GameObjects.DOMElement,Hl=Phaser.Utils.Objects.IsPlainObject,Fl=Phaser.Utils.Objects.GetValue,Vl=function(){function x(t,e,i,n,s,r){var o;M(this,x),Hl(e)?(e=Fl(r=e,"x",0),i=Fl(r,"y",0),n=Fl(r,"width",void 0),s=Fl(r,"height",void 0)):Hl(n)&&(n=Fl(r=n,"width",void 0),s=Fl(r,"height",void 0)),void 0===r&&(r={});var a,h=t.scale.autoRound;void 0!==n&&(h&&(n=Math.floor(n)),r.width=n+"px"),void 0!==s&&(h&&(s=Math.floor(s)),r.height=s+"px");var l,u,c=Fl(r,"type","text");for(var d in"textarea"===c?(a=document.createElement("textarea")).style.resize="none":(a=document.createElement("input")).type=c,Xl)l=Xl[d],void 0!==(u=Fl(r,d,l[1]))&&(a[l[0]]=u);var f,v,p=Fl(r,"style",void 0);for(var d in void 0===p&&(p={}),Wl)f=Wl[d],void 0!==(v=Fl(r,d,f[1]))&&(p[f[0]]=v);var g=a.style;for(var d in r)d in Xl||d in Wl||d in g&&(p[d]=r[d]);p["box-sizing"]="border-box",(o=I(this,E(x).call(this,t,e,i,a,p))).type="rexInputText";function y(t){o.node[Al[t]]=function(){this.emit(t,this)}.bind(_(o))}for(var m in Al)y(m);return function(t){t.addEventListener("touchstart",Yl,!1),t.addEventListener("touchmove",Yl,!1),t.addEventListener("touchend",Yl,!1),t.addEventListener("mousedown",Yl,!1),t.addEventListener("mouseup",Yl,!1),t.addEventListener("mousemove",Yl,!1)}(o.node),o}return e(x,Ll),v(x,[{key:"resize",value:function(t,e){var i=this.node.style;return i.width=t+"px",i.height=e+"px",this.updateSize(),this}},{key:"setText",value:function(t){return this.text=t,this}},{key:"selectText",value:function(){return this.node.select(),this}},{key:"setPlaceholder",value:function(t){return this.placeholder=t,this}},{key:"setTooltip",value:function(t){return this.tooltip=t,this}},{key:"setTextChangedCallback",value:function(t){return this.onTextChanged=t,this}},{key:"setReadOnly",value:function(t){return void 0===t&&(t=!0),this.readOnly=t,this}},{key:"setSpellCheck",value:function(t){return this.spellCheck=t,this}},{key:"setStyle",value:function(t,e){return this.node.style[t]=e,this}},{key:"getStyle",value:function(t){return this.node.style[t]}},{key:"scrollToBottom",value:function(){return this.node.scrollTop=this.node.scrollHeight,this}},{key:"setEnabled",value:function(t){return void 0===t&&(t=!0),this.node.disabled=!t,this}},{key:"setBlur",value:function(){return this.node.blur(),this}},{key:"setFocus",value:function(){return this.node.focus(),this}},{key:"text",get:function(){return this.node.value},set:function(t){this.node.value=t}},{key:"placeholder",get:function(){return this.node.placeholder},set:function(t){this.node.placeholder=t}},{key:"tooltip",get:function(){return this.node.title},set:function(t){this.node.title=t}},{key:"readOnly",get:function(){return this.node.readOnly},set:function(t){this.node.readOnly=t}},{key:"spellCheck",get:function(){return this.node.spellcheck},set:function(t){this.node.spellcheck=t}}]),x}(),Xl={id:["id",void 0],text:["value",void 0],placeholder:["placeholder",void 0],tooltip:["title",void 0],readOnly:["readonly",!1],spellCheck:["spellcheck",!1],autoComplete:["autocomplete","off"]},Wl={align:["textAlign",void 0],width:["width",void 0],height:["height",void 0],fontFamily:["fontFamily",void 0],fontSize:["font-size",void 0],color:["color","#ffffff"],backgroundColor:["backgroundColor","transparent"],borderColor:["borderColor","transparent"],outline:["outline","none"]},Al={textchange:"oninput",click:"onclick",dblclick:"ondblclick",focus:"onfocus",blur:"onblur"},Gl=Phaser.Utils.Objects.GetValue,Ul=function(t){return t.hasOwnProperty("align")?t.align:t.hasOwnProperty("halign")?t.halign:"left"},Nl=Phaser.Utils.Objects.GetValue,Jl=function(){function e(t){M(this,e),this.gameObject=t,this.scene=qn(t),this.inputText=void 0,this.onClose=void 0,this.delayCall=void 0,this.boot()}return v(e,[{key:"boot",value:function(){return this.gameObject.once("destroy",this.destroy,this),this}},{key:"shutdown",value:function(){return this.close(),this.gameObject=void 0,this.scene=void 0,Zl===this&&(Zl=void 0),this}},{key:"destroy",value:function(){return this.shutdown(),this}},{key:"open",value:function(t,e){void 0!==Zl&&Zl.close(),Zl=this,function(t){return t&&"function"==typeof t}(t)&&(e=t,t=void 0),void 0===e&&(e=Nl(t,"onClose",void 0));var i=Nl(t,"onTextChanged",void 0);return this.inputText=function(t,e){void 0===e&&(e={});var i=t.scene,n=t.style,s=Gl(e,"backgroundColor",n.backgroundColor);null===s&&(s="transparent"),e.text=Gl(e,"text",t.text),e.fontFamily=Gl(e,"fontFamily",n.fontFamily),e.fontSize=Gl(e,"fontSize",n.fontSize),e.color=Gl(e,"color",n.color),e.backgroundColor=s,e.align=Gl(e,"align",Ul(n));var r=new Vl(i,t.x,t.y,Gl(e,"width",t.width),Gl(e,"height",t.height),e);return r.setOrigin(t.originX,t.originY),i.add.existing(r),r}(this.gameObject,t).on("textchange",function(t){var e=t.text;i?i(this.gameObject,e):this.gameObject.text=e},this).setFocus(),this.gameObject.setVisible(!1),this.onClose=e,this.scene.input.keyboard.once("keydown-ENTER",this.close,this),this.delayCall=this.scene.time.delayedCall(0,function(){this.scene.input.once("pointerdown",this.close,this)},[],this),this}},{key:"close",value:function(){return Zl=void 0,this.inputText&&(this.gameObject.setVisible(!0),this.inputText.destroy(),this.inputText=void 0,this.delayCall&&(this.delayCall.remove(),this.delayCall=void 0),this.scene.input.keyboard.off("keydown-ENTER",this.close,this),this.scene.input.off("pointerdown",this.close,this),this.onClose&&this.onClose(this.gameObject)),this}},{key:"isOpened",get:function(){return void 0!==this.inputText}},{key:"text",get:function(){return this.isOpened?this.inputText.text:this.gameObject.text}}]),e}(),Zl=void 0,Kl=function(){function n(t,e){var i;return M(this,n),(i=I(this,E(n).call(this,t,e))).add=new c(t),i}return e(n,Phaser.Plugins.ScenePlugin),n}(),ql={getParentSizer:js,getTopmostSizer:Ds,hide:Cr,show:wr,isShown:Sr,edit:function(t,e,i){return t._edit||(t._edit=new Jl(t)),t._edit.open(e,i),t._edit},isInTouching:_s};return Object.assign(Kl.prototype,ql),Kl});
