!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).rexcontainerliteplugin=i()}(this,function(){"use strict";function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function t(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&e(t,i)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function e(t,i){return(e=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function u(t,i){return!i||"object"!=typeof i&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function o(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=a(t)););return t}function r(t,i,e){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,i,e){var n=o(t,i);if(n){var r=Object.getOwnPropertyDescriptor(n,i);return r.get?r.get.call(e):r.value}})(t,i,e||t)}function s(t,i,e,n){return(s="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,i,e,n){var r,s=o(t,i);if(s){if((r=Object.getOwnPropertyDescriptor(s,i)).set)return r.set.call(n,e),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(n,i)){if(!r.writable)return!1;r.value=e,Object.defineProperty(n,i,r)}else!function(t,i,e){i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e}(n,i,e);return!0})(t,i,e,n)}function f(t,i,e,n,r){if(!s(t,i,e,n||t)&&r)throw new Error("failed to set property");return e}function l(t){return function(t){if(Array.isArray(t)){for(var i=0,e=new Array(t.length);i<t.length;i++)e[i]=t[i];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t,i){return t===i?1:t/i}var p={add:function(t){return Array.isArray(t)?this.addMultiple(t):this._add(t),this},addMultiple:function(t){return t.forEach(this._add,this),this},_add:function(t){return this.children.add(t),this.resetChildState(t).updateChildVisible(t).updateChildActive(t).updateChildScrollFactor(t).updateChildMask(t),this}},y=Phaser.Math.RotateAround,v={worldToLocal:function(t){return t.x-=this.x,t.y-=this.y,y(t,0,0,-this.rotation),t.x/=this.scaleX,t.y/=this.scaleY,t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t},localToWorld:function(t){return t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t.x*=this.scaleX,t.y*=this.scaleY,y(t,0,0,this.rotation),t.x+=this.x,t.y+=this.y,t}},b={updateChildPosition:function(t){t.isRexContainerLite&&(t.syncChildrenEnable=!1);var i=this.getLocalState(t);return t.x=i.x,t.y=i.y,this.localToWorld(t),t.scaleX=i.scaleX*this.scaleX,t.scaleY=i.scaleY*this.scaleY,void 0!==t.flipX&&(t.flipX=this.flipX?!i.flipX:i.flipX,t.flipY=this.flipY?!i.flipY:i.flipY),t.rotation=i.rotation+this.rotation,t.isRexContainerLite&&(t.syncChildrenEnable=!0,t.syncPosition()),this},syncPosition:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildPosition,this),this},resetChildPositionState:function(t){var i=this.getLocalState(t);return i.x=t.x,i.y=t.y,this.worldToLocal(i),i.scaleX=d(t.scaleX,this.scaleX),i.scaleY=d(t.scaleY,this.scaleY),void 0!==t.flipX&&(i.flipX=t.flipX,i.flipY=t.flipY),i.rotation=t.rotation-this.rotation,this},setChildPosition:function(t,i,e){return t.x=i,t.y=e,this.resetChildPositionState(t),this},setChildLocalPosition:function(t,i,e){var n=this.getLocalState(t);return n.x=i,n.y=e,this.updateChildPosition(t),this}},g={updateChildVisible:function(t){return t.visible=this.visible&&this.getLocalState(t).visible,this},syncVisible:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildVisible,this),this},resetChildVisibleState:function(t){return this.getLocalState(t).visible=t.visible,this},setChildVisible:function(t,i){return t.visible=i,this.resetChildVisibleState(t),this},setChildLocalVisible:function(t,i){return void 0===i&&(i=!0),this.getLocalState(t).visible=i,this.updateChildVisible(t),this}},C={updateChildAlpha:function(t){return t.alpha=this.alpha*this.getLocalState(t).alpha,this},syncAlpha:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildAlpha,this),this},resetChildAlphaState:function(t){return this.getLocalState(t).alpha=d(t.alpha,this.alpha),this},setChildAlpha:function(t,i){return t.alpha=i,this.resetChildAlphaState(t),this._add},setChildLocalAlpha:function(t,i){return this.getLocalState(t).alpha=i,this.updateChildAlpha(t),this}},m={updateChildActive:function(t){return t.active=this.active&&this.getLocalState(t).active,this},syncActive:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildActive,this),this},resetChildActiveState:function(t){return this.getLocalState(t).active=t.active,this},setChildActive:function(t,i){return t.active=i,this.resetChildActiveState(t),this},setChildLocalActive:function(t,i){return void 0===i&&(i=!0),this.getLocalState(t).active=i,this.updateChildActive(t),this}},S={updateChildMask:function(t){return null==this.mask||(this.mask.hasOwnProperty("geometryMask")?this.mask.geometryMask:this.mask.bitmapMask)!==t&&(t.mask=this.mask),this},syncMask:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildMask,this),this},setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this}},_=Phaser.Utils.Array,A={getChildren:function(){return this.children.getChildren()},getAllChildren:function(t){void 0===t&&(t=[]);for(var i,e=this.children.getChildren(),n=0,r=e.length;n<r;n++){var s;if(i=e[n],t.push(i),i.hasOwnProperty("isRexContainerLite"))(s=t).push.apply(s,l(i.getAllChildren()))}return t},contains:function(t){if(this.children.contains(t))return!0;for(var i,e=this.children.getChildren(),n=0,r=e.length;n<r;n++)if((i=e[n]).isRexContainerLite&&i.contains(t))return!0;return!1},getByName:function(t){return _.GetFirst(this.list,"name",t)},getRandom:function(t,i){return _.GetRandom(this.list,t,i)},getFirst:function(t,i,e,n){return _.GetFirstElement(this.list,t,i,e,n)},getAll:function(t,i,e,n){return _.GetAll(this.list,t,i,e,n)},count:function(t,i,e,n){return _.CountAllMatching(this.list,t,i,e,n)},swap:function(t,i){return _.Swap(this.list,t,i),this},moveTo:function(t,i){return _.MoveTo(this.list,t,i),this},setAll:function(t,i,e,n){return _.SetAll(this.list,t,i,e,n),this}},k=Phaser.GameObjects.Zone,P=Phaser.GameObjects.Components,x=function(){function l(t,i,e,n,r,s){var o;return c(this,l),Array.isArray(n)&&(s=n,n=void 0),void 0===n&&(n=1),void 0===r&&(r=1),(o=u(this,a(l).call(this,t,i,e,n,r))).children=t.add.group(),o.type="rexContainerLite",o.isRexContainerLite=!0,o.syncChildrenEnable=!0,o._flipX=!1,o._flipY=!1,o._alpha=1,o._active=!0,o._mask=null,o._scrollFactorX=1,o._scrollFactorY=1,s&&o.add(s),o}return i(l,k),t(l,[{key:"destroy",value:function(t){this.scene&&(this.children.destroy(!t),this.children=void 0,r(a(l.prototype),"destroy",this).call(this,t))}},{key:"resize",value:function(t,i){return this.setSize(t,i),this}},{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.syncPosition())}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.syncPosition())}},{key:"rotation",get:function(){return r(a(l.prototype),"rotation",this)},set:function(t){this.rotation!==t&&(f(a(l.prototype),"rotation",t,this,!0),this.syncPosition())}},{key:"scaleX",get:function(){return r(a(l.prototype),"scaleX",this)},set:function(t){this.scaleX!==t&&(f(a(l.prototype),"scaleX",t,this,!0),this.syncPosition())}},{key:"scaleY",get:function(){return r(a(l.prototype),"scaleY",this)},set:function(t){this.scaleY!==t&&(f(a(l.prototype),"scaleY",t,this,!0),this.syncPosition())}},{key:"flipX",get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t,this.syncPosition())}},{key:"flipY",get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t,this.syncPosition())}},{key:"visible",get:function(){return r(a(l.prototype),"visible",this)},set:function(t){this.visible!==t&&(f(a(l.prototype),"visible",t,this,!0),this.syncVisible())}},{key:"alpha",get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this.syncAlpha())}},{key:"active",get:function(){return this._active},set:function(t){this._active!==t&&(this._active=t,this.syncActive())}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask!==t&&(this._mask=t,this.syncMask())}},{key:"scrollFactorX",get:function(){return this._scrollFactorX},set:function(t){this._scrollFactorX!==t&&(this._scrollFactorX=t,this.syncScrollFactor())}},{key:"scrollFactorY",get:function(){return this._scrollFactorY},set:function(t){this._scrollFactorY!==t&&(this._scrollFactorY=t,this.syncScrollFactor())}},{key:"list",get:function(){return this.children.getChildren()}}]),l}();function O(t,i,e,n,r){var s=new x(this.scene,t,i,e,n,r);return this.scene.add.existing(s),s}Object.assign(x.prototype,p,{remove:function(t,i){return this.children.remove(t,!1,i),this},clear:function(t){return this.children.clear(!1,t),this}},{getLocalState:function(t){return t.hasOwnProperty("rexContainer")||(t.rexContainer={}),t.rexContainer},resetChildState:function(t){return this.resetChildPositionState(t).resetChildVisibleState(t).resetChildAlphaState(t).resetChildActiveState(t),this},resetChildrenState:function(t){for(var i=0,e=t.length;i<e;i++)this.resetChildState(t[i]);return this},syncProperties:function(){return this.syncPosition().syncVisible().syncAlpha().syncActive().syncScrollFactor().syncMask(),this}},v,b,g,C,{updateChildScrollFactor:function(t){return t.setScrollFactor(this.scrollFactorX,this.scrollFactorY),this},syncScrollFactor:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildScrollFactor,this),this}},m,S,{setDepth:function(t){if(this.depth=t,this.children)for(var i=this.getAllChildren(),e=0,n=i.length;e<n;e++)i[e].depth=t;return this},swapDepth:function(t){var i=this.depth,e=t.depth;return this.setDepth(e),t.setDepth(i),this},incDepth:function(t){if(this.depth+=t,this.children)for(var i=this.getAllChildren(),e=0,n=i.length;e<n;e++)i[e].depth+=t;return this}},A,P.Alpha,P.Flip);var w=Phaser.Utils.Objects.GetAdvancedValue,X=Phaser.Utils.Objects.GetValue,Y=Phaser.GameObjects.BuildGameObject;function j(t){var i=w(t,"width",1),e=w(t,"height",i),n=X(t,"children",void 0),r=new x(this.scene,0,0,i,e);return r.syncChildrenEnable=!1,Y(this.scene,r,t),r.syncChildrenEnable=!0,r.add(n),r}function L(t){return null==t||""===t||0===t.length}var E=function(){function e(t){var i;return c(this,e),i=u(this,a(e).call(this,t)),t.registerGameObject("rexContainerLite",O,j),i}return i(e,Phaser.Plugins.BasePlugin),t(e,[{key:"start",value:function(){this.game.events.once("destroy",this.destroy,this)}}]),e}();return function(t,i,e){if("object"===h(t))if(L(i)){if(null==e)return;"object"===h(e)&&(t=e)}else{"string"==typeof i&&(i=i.split("."));var n=i.pop();(function(t,i,e){void 0===e&&(e={});var n=t;if(L(i));else{var r;"string"==typeof i&&(i=i.split("."));for(var s=0,o=i.length;s<o;s++){var l;if(null==n[r=i[s]]||"object"!==h(n[r]))l=s===o-1?e:{},n[r]=l;n=n[r]}}return n})(t,i)[n]=e}}(window,"RexPlugins.GameObjects.ContainerLite",x),E});
