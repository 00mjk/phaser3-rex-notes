!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexninepatchplugin=e()}(this,function(){"use strict";function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function t(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function n(t,e,i){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function b(t,e,i){return void 0===i&&(i="image"),t[e]||(t[e]=t.scene.make[i]({add:!1,origin:{x:0,y:0}}),t.once("destroy",function(){t[e]&&(t[e].destroy(),t[e]=void 0)})),t[e]}var s=Phaser.Utils.Objects.IsPlainObject,o=Phaser.Utils.Objects.GetValue,c=function(t){return"string"==typeof t&&(t=u[t]),t},u={scale:0,repeat:1},a={setTexture:function(t,e,i){this.textureKey=t,this.columns.data=e,this.columns.count=e?e.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.rows.data=i,this.rows.count=i?i.length:0,this.rows.stretch=0,this.rows.minHeight=0;var r=this.scene.textures.get(t);if(!r)return this.clear(),this;if(!e||!i)return this.clear(),this;for(var n=r.frames.__BASE,s=n.width,o=0,c=0,h=e.length;c<h;c++)void 0===e[c]?o++:"number"==typeof e[c]?s-=e[c]:s-=e[c].width;var u=s/o,a=n.height,l=0;for(c=0,h=i.length;c<h;c++)void 0===i[c]?l++:"number"==typeof i[c]?a-=i[c]:a-=i[c].width;for(var f,d,m,g,p,y=a/l,v=0,b=0,w=0,O=i.length;w<O;w++){void 0===i[w]&&(i[w]=y),"number"==typeof i[w]&&(i[w]={height:i[w],stretch:w%2}),m=(f=i[w]).height,this.rows.stretch+=0|f.stretch,this.rows.minHeight+=0<f.stretch?0:m;c=v=0;for(var j=e.length;c<j;c++)void 0===e[c]&&(e[c]=u),"number"==typeof e[c]&&(e[c]={width:e[c],stretch:c%2}),g=(d=e[c]).width,0===w&&(this.columns.stretch+=0|d.stretch,this.columns.minWidth+=0<d.stretch?0:g),1<=g&&1<=m?(p=this.getFrameNameCallback(c,w))&&r.add(p,0,v,b,g,m):console.warn("Size of Grid(".concat(c,",").concat(w,") = ").concat(g,"x").concat(m,", which is invalid")),v+=g;b+=m}return this.updateTexture(),this},updateTexture:function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.textures.get(this.textureKey);if(!t)return this;var e,i,r=this.width-this.columns.minWidth;i=0<=r?(e=0<this.columns.stretch?r/this.columns.stretch:0,1):(e=0,this.width/this.columns.minWidth);var n,s,o,c,h,u,a,l=this.height-this.rows.minHeight;s=0<=l?(n=0<this.rows.stretch?l/this.rows.stretch:0,1):(n=0,this.height/this.rows.minHeight);for(var f,d=0,m=0,g=0,p=this.rows.count;g<p;g++){a=0===(h=this.rows.data[g]).stretch?h.height*s:n*h.stretch;for(var y=d=0,v=this.columns.count;y<v;y++)u=0===(c=this.columns.data[y]).stretch?c.width*i:e*c.stretch,(o=this.getFrameNameCallback(y,g))&&0<u&&0<a&&t.has(o)&&(0===(0===h.stretch&&0===c.stretch?0:0===this.getStretchMode(y,g)?0:1)?(f=b(this,"_image","image")).setTexture(this.textureKey,o).setDisplaySize(u,a):(f=b(this,"_tileSprite","tileSprite")).setTexture(this.textureKey,o).setSize(u,a)),f&&(this.draw(f,d,m),f=void 0),d+=u;m+=a}},setStretchMode:function(t){return s(t)?(this.stretchMode.edge=c(o(t,"edge",0)),this.stretchMode.internal=c(o(t,"internal",0))):(t=c(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1}.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal}};function m(t,e){return"".concat(t,",").concat(e)}var g=Phaser.GameObjects.RenderTexture,p=Phaser.Utils.Objects.IsPlainObject,y=Phaser.Utils.Objects.GetValue,v=function(){function a(t,e,i,r,n,s,o,c,h){var u;return l(this,a),p(e)?(e=y(h=e,"x",0),i=y(h,"y",0),r=y(h,"width",1),n=y(h,"height",1),s=y(h,"key",void 0),o=y(h,"columns",void 0),c=y(h,"rows",void 0)):p(r)?(r=y(h=r,"width",1),n=y(h,"height",1),s=y(h,"key",void 0),o=y(h,"columns",void 0),c=y(h,"rows",void 0)):p(s)&&(s=y(h=s,"key",void 0),o=y(h,"columns",void 0),c=y(h,"rows",void 0)),(u=d(this,f(a).call(this,t,e,i,r,n))).columns={},u.rows={},u.stretchMode={},u._tileSprite=void 0,u._image=void 0,u.setOrigin(.5,.5),u.setGetFrameNameCallback(y(h,"getFrameNameCallback",void 0)),u.setStretchMode(y(h,"stretchMode",0)),u.setTexture(s,o,c),u}return e(a,g),t(a,[{key:"setGetFrameNameCallback",value:function(t){return void 0===t&&(t=m),this.getFrameNameCallback=t,this}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(n(f(a.prototype),"resize",this).call(this,t,e),this.updateTexture()),this}},{key:"minWidth",get:function(){return this.columns.minWidth}},{key:"minHeight",get:function(){return this.rows.minHeight}}]),a}();function w(t,e,i,r,n,s,o,c){var h=new v(this.scene,t,e,i,r,n,s,o,c);return this.scene.add.existing(h),h}Object.assign(v.prototype,a);var O=Phaser.GameObjects.BuildGameObject;function j(t,e){void 0!==e&&(t.add=e);var i=new v(this.scene,t);return O(this.scene,i,t),i}function x(t){return null==t||""===t||0===t.length}var P=function(){function i(t){var e;return l(this,i),e=d(this,f(i).call(this,t)),t.registerGameObject("rexNinePatch",w,j),e}return e(i,Phaser.Plugins.BasePlugin),t(i,[{key:"start",value:function(){this.game.events.once("destroy",this.destroy,this)}}]),i}();return function(t,e,i){if("object"===h(t))if(x(e)){if(null==i)return;"object"===h(i)&&(t=i)}else{"string"==typeof e&&(e=e.split("."));var r=e.pop();(function(t,e,i){void 0===i&&(i={});var r=t;if(x(e));else{var n;"string"==typeof e&&(e=e.split("."));for(var s=0,o=e.length;s<o;s++){var c;if(null==r[n=e[s]]||"object"!==h(r[n]))c=s===o-1?i:{},r[n]=c;r=r[n]}}return r})(t,e)[r]=i}}(window,"RexPlugins.GameObjects.NinePatch",v),P});
