!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).rexloadingprogress=t()}(this,function(){"use strict";function f(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(r);if(o){var n=a(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)}}function t(e,t){var n;return(n=e)&&"function"==typeof n?t={config:{callback:e,scope:t}}:o(e)?(t=e).hasOwnProperty("config")||(t={config:t}):t={key:e,config:t},this.addFile(new r(this,t)),this}var l=Phaser.Loader.FILE_POPULATED,r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(o,Phaser.Loader.File);var e,t,n,r=u(o);function o(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t.hasOwnProperty("type")||(t.type="await"),t.hasOwnProperty("url")||(t.url=""),t.hasOwnProperty("key")||(t.key=(new Date).getTime().toString()),r.call(this,e,t)}return e=o,(t=[{key:"load",value:function(){if(this.state===l)this.loader.nextFile(this,!0);else{var e=this.config,t=e.callback,n=e.scope,r=this.onLoad.bind(this),o=this.onError.bind(this);t?n?t.call(n,r,o):t(r,o):this.onLoad()}}},{key:"onLoad",value:function(){this.loader.nextFile(this,!0)}},{key:"onError",value:function(){this.loader.nextFile(this,!1)}}])&&i(e.prototype,t),n&&i(e,n),o}(),o=Phaser.Utils.Objects.IsPlainObject;Phaser.Loader.FileTypesManager.register("rexAwait",t);function p(e,t){void 0===t&&(t=0);var n=e.load,r=n.totalToLoad-t;return 1-(n.list.size+n.inflight.size-t)/r}function h(n,r){return new Promise(function(e,t){n.once(r,function(){e()})})}function n(){}var d=Phaser.Utils.Objects.GetValue;return function(o,e){var i=d(e,"transitIn",n),a=d(e,"progress",n),s=d(e,"transitionOut",n),u=o.scene;Phaser.Loader.FileTypesManager.register("rexAwait",t),u.sys.load.rexAwait=t,u.load.rexAwait(function(){var c,n=(c=regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(o);case 2:if(!((r=p(u,1))<1)){e.next=13;break}case 4:if(r<1)return e.next=7,h(u.load,"progress");e.next=11;break;case 7:r=p(u,1),a(o,r),e.next=4;break;case 11:e.next=14;break;case 13:a(o,r);case 14:return e.next=16,s(o);case 16:o.destroy(),t();case 18:case"end":return e.stop()}},e)}),function(){var e=this,a=arguments;return new Promise(function(t,n){var r=c.apply(e,a);function o(e){f(r,t,n,o,i,"next",e)}function i(e){f(r,t,n,o,i,"throw",e)}o(void 0)})});return function(e,t){return n.apply(this,arguments)}}())}});
