!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).rexgridcutimageplugin=t()}(void 0,function(){function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);if(o){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)}}function B(e,t,n,r,o,i){var c,u,a;null==n&&(n="__BASE"),(a=i)&&"function"==typeof a||(void 0===(u=i)&&(u=","),i="__BASE"===(c=n)?function(e,t){return"".concat(e).concat(u).concat(t)}:function(e,t){return"".concat(c,"_").concat(e).concat(u).concat(t)});for(var f,s,l,p=e.sys.textures.get(t),d=p.source[0].isRenderTexture,y=p.frames[n],h=y.width,b=y.height,g=h/r,v=b/o,m=0,O=0,P=0;P<o;P++){for(var j=m=0;j<r;j++)l=i(j,P),f=m+y.cutX,s=d?b-O-v+y.cutY:O+y.cutY,p.add(l,0,f,s,g,v),m+=g;O+=v}return{getFrameNameCallback:i,cellWidth:g,cellHeight:v,columns:r,rows:o}}var C=Phaser.Utils.Objects.GetValue,S=Phaser.GameObjects.Image,Y=Phaser.Utils.Objects.IsPlainObject,A=Phaser.Math.RotateAround;return function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(o,Phaser.Plugins.BasePlugin);var e,t,n,r=f(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return e=o,(t=[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"gridCut",value:function(e,t,n,r){return function(e,t,n,r){Y(t)&&(t=C(r=t,"columns",1),n=C(r,"rows",1));for(var o=C(r,"ImageClass",S),i=C(r,"originX",.5),c=C(r,"originY",.5),u=C(r,"add",!0),a=C(r,"align",u),f=C(r,"objectPool",void 0),s=e.scene,l=e.texture.key,p=e.frame.name,d=B(s,l,p,t,n),y=d.getFrameNameCallback,h=e.scaleX,b=e.scaleY,g=e.rotation,v=e.getTopLeft(),m=v.x,O=v.y,P=[],j=d.cellWidth*h,w=d.cellHeight*b,_=0;_<n;_++)for(var x=0;x<t;x++){var R,T=y(x,_);R=f&&0<f.length?f.pop().setTexture(l,T):new o(s,0,0,l,T),u&&s.add.existing(R);var k=m+j*x+i*j,E=O+w*_+c*w;a&&(R.setOrigin(i,c).setPosition(k,E).setScale(h,b).setRotation(g),A(R,m,O,g)),P.push(R)}return P}(e,t,n,r)}}])&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}()});
