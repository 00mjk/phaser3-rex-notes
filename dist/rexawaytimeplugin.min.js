!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";var e,t;e=void 0,t=function(){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r);if(i){var n=o(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}var n=Phaser.Utils.Objects.GetValue,f=function(){function t(e){r(this,t),this.state=l,this.setKey(n(e,"key","away")),this.setPeriod(n(e,"period",1e3))}return e(t,[{key:"destroy",value:function(){this.stop()}},{key:"awayTime",get:function(){var e=localStorage.getItem(this.key);if(this.start(),null==e)return 0;e=parseInt(e);var t=this.curTime;return e<0||t<e?0:t-e}},{key:"curTime",get:function(){return(new Date).getTime()}},{key:"start",value:function(){return this.stop(),this.updateTime(),this.timer=setInterval(this.updateTime.bind(this),this.period),this.state=y,this}},{key:"stop",value:function(){return this.state===l||(clearTimeout(this.timer),this.timer=void 0,this.state=l),this}},{key:"updateTime",value:function(){return localStorage.setItem(this.key,this.curTime),this}},{key:"setKey",value:function(e){return this.key=e,this}},{key:"setPeriod",value:function(e){return this.period=e,this}}]),t}(),l=0,y=1;return function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(n,Phaser.Plugins.BasePlugin);var t=a(n);function n(e){return r(this,n),t.call(this,e)}return e(n,[{key:"start",value:function(){this._awayTime=this.add(),this.game.events.on("destroy",this.destroy,this)}},{key:"destroy",value:function(){this._awayTime.destroy(),c(o(n.prototype),"destroy",this).call(this)}},{key:"add",value:function(e){return new f(e)}},{key:"awayTime",get:function(){return this._awayTime.awayTime}},{key:"setKey",value:function(e){return this._awayTime.setKey(e),this}},{key:"setPeriod",value:function(e){return this._awayTime.setPeriod(e),this}}]),n}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).rexawaytimeplugin=t()});
