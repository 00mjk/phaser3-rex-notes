!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rexfirebaseplugin=e():t.rexfirebaseplugin=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=327)}({0:function(t,e){t.exports=function(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var n=e.split("."),r=t,s=i,o=0;o<n.length;o++){if(!r.hasOwnProperty(n[o])){s=i;break}s=r[n[o]],r=r[n[o]]}return s}return i}return i}},11:function(t,e,i){"use strict";var n=i(7);e.a=function(t,e){var i=Array.isArray(t);for(var r in void 0===e?e=i?[]:{}:Object(n.a)(e),i&&(e.length=t.length),t)e[r]=t[r];return e}},120:function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=Phaser.Loader.FILE_POPULATED,h=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,o(e).apply(this,arguments))}var i,n,h;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,Phaser.Loader.File),i=e,(n=[{key:"load",value:function(){if(this.state===u)this.loader.nextFile(this,!0);else{var t=this.config,e=t.callback,i=t.scope,n=this.onLoad.bind(this),r=this.onError.bind(this);e?i?e.call(i,n,r):e(n,r):this.onLoad()}}},{key:"onLoad",value:function(){this.loader.nextFile(this,!0)}},{key:"onError",value:function(){this.loader.nextFile(this,!1)}}])&&r(i.prototype,n),h&&r(i,h),e}();e.a=h},172:function(t,e){t.exports=function(t,e){if(!(e>=t.length)){for(var i=t.length-1,n=t[e],r=e;r<i;r++)t[r]=t[r+1];return t.length=i,n}}},2:function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=function(t){return null==t||""===t||0===t.length};e.a=function(t,e,i){if("object"===n(t))if(r(e)){if(null==i)return;"object"===n(i)&&(t=i)}else{"string"==typeof e&&(e=e.split("."));var s=e.pop();((function(t,e,i){void 0===i&&(i={});var s=t;if(r(e));else{var o;"string"==typeof e&&(e=e.split("."));for(var a=0,u=e.length;a<u;a++){var h;null!=s[o=e[a]]&&"object"===n(s[o])||(h=a===u-1?i:{},s[o]=h),s=s[o]}}return s})(t,e))[s]=i}}},3:function(t,e,i){"use strict";e.a={setEventEmitter:function(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown()},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(){return this._eventEmitter&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]}}},327:function(t,e,i){"use strict";i.r(e);var n={app:"https://www.gstatic.com/firebasejs/".concat("7.5.2","/firebase-app.js"),database:"https://www.gstatic.com/firebasejs/".concat("7.5.2","/firebase-database.js")},r=i(11),s=function(t,e){var i=Object(r.a)(t);for(var n in e)i.hasOwnProperty(n)&&(i[n]=e[n]);return i},o=i(74),a=function(t){return void 0===t&&(t=0),new Promise(function(e,i){setTimeout(e,t)})},u=function(t){var e;for(var i in t)if(t[i]&&(e=h[i])&&!e())return!1;return!0},h={database:function(){return void 0!==firebase.database}},c=function t(e){return u(e)?Promise.resolve():a(10).then(function(){return t(e)})},f=function(t){return new Promise(function(e,i){Object(o.a)(t,e)})},l=function(t){return t=s(n,t),f(t.app).then(function(){var e,i=0;for(var n in t)"app"!==n&&(e=t[n])&&(i++,Object(o.a)(e,function(){if(0==--i)return Promise.resolve()}));if(0===i)return Promise.resolve()}).then(function(){return c(t)})},m=i(120),v=function(t){return this.addFile(new m.a(this,{type:"firebaseScriptTag",url:"",key:(new Date).getTime().toString(),config:{callback:function(e,i){return l(t).then(function(){setTimeout(e,0)}).catch(i)}}})),this};function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.app=void 0}var e,i,n;return e=t,n=[{key:"register",value:function(e,i){t.prototype[e]=i}}],(i=[{key:"initializeApp",value:function(t){return void 0===this.app&&(this.app=firebase.initializeApp(t)),this}}])&&d(e.prototype,i),n&&d(e,n),t}(),y=i(3),I=i(0),b=i.n(I),g=function(t,e,i){var n=void 0===i?e:"".concat(e,"/").concat(i);return t.ref(n)},R=function(t,e){if(this.sendToRef&&this.sendToRef.key===t||(this.sendToRef=g(this.database,this.rootPath,t)),void 0===e)return this.sendToRef.remove();var i={message:e,senderID:this.senderInfo.userID,senderName:this.senderInfo.userName,stamp:this.stamp};this.skipFirst=!1,this.stamp=!this.stamp;var n=this;return this.sendToRef.set(i).then(function(){return n.emit("send",i),Promise.resolve()}).catch(function(t){return n.emit("send-fail",i),Promise.reject(t)})},E={startReceiving:function(t){return void 0===t&&(t=this.senderInfo.userID),this.isReceiving&&this.receiverRef.key===t?this:(this.stopReceiving(),this.isReceiving=!0,this.skipFirst=!0,this.receiverRef=g(this.database,this.rootPath,t),this.receiverRef.on("value",D,this),this.receiverRef.onDisconnect().remove(),this)},stopReceiving:function(){return this.isReceiving?(this.isReceiving=!1,this.receiverRef.off("value",D,this),this.receiverRef.remove(),this.receiverRef.onDisconnect().cancel(),this):this}},D=function(t){if(this.skipFirst)this.skipFirst=!1;else{var e=t.val();null!=e&&this.emit("receive",e)}},P=E;function k(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var w=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=b()(i,"eventEmitter",void 0),r=b()(i,"EventEmitterClass",void 0);this.setEventEmitter(n,r),this.database=e.database(),this.setRootPath(b()(i,"root","")),this.skipFirst=!0,this.stamp=!1,this.senderInfo={userID:"",userName:""},this.setSender(b()(i,"senderID",""),b()(i,"senderName","")),this.isReceiving=!1}var e,i,n;return e=t,(i=[{key:"shutdown",value:function(){this.stopReceiving().destroyEventEmitter()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setRootPath",value:function(t){return this.rootPath=t,this.sendToRef=void 0,this.receiverRef=void 0,this}},{key:"setSender",value:function(t,e){return"string"==typeof t?(this.senderInfo.userID=t,this.senderInfo.userName=e):this.senderInfo=t,this}}])&&k(e.prototype,i),n&&k(e,n),t}(),j={send:R};Object.assign(w.prototype,y.a,P,j);var _=w,x=i(2);p.register("simpleMessage",function(t){return new _(this.app,t)}),Object(x.a)(window,"RexPlugins.Fire.SimpleMessage",_);var O=i(7),U=i(172),L=i.n(U),N={clear:function(){return this.items.length=0,Object(O.a)(this.itemID2Index),this},getItems:function(){return this.items},hasItem:function(t){return this.itemID2Index.hasOwnProperty(t)},getItemIndexFromItemID:function(t){return null==t?null:this.itemID2Index[t]},getItemFromItemID:function(t){if(null==t)return null;var e=this.getItemIndexFromItemID(t);return null==e?null:this.items[e]},forEach:function(t,e){return this.items.forEach(t,e),this},addItem:function(t,e,i){var n,r=this.getItemCallback,s=this.getItemCallbackScope;if(n=s?r.call(s,t):r(t),i)return this.items.push(n),n;if(null==e)this.items.unshift(n);else{var o=this.itemID2Index[e];o===this.items.length-1?this.items.push(n):this.items.splice(o+1,0,n)}return n},removeItem:function(t){var e=this.itemID2Index[t.key];return L()(this.items,e)},updateItemID2Index:function(){var t;Object(O.a)(this.itemID2Index);for(var e=0,i=this.items.length;e<i;e++)t=this.items[e][this.keyItemID],this.itemID2Index[t]=e;return this}},S=function(t){var e=t.val();return e[this.keyItemID]=t.key,e},T=function(t){this.clear(),t.forEach(function(t){this.addItem(t,null,!0)}.bind(this)),this.updateItemID2Index(),this.emit(this.eventNames.update,this.items)},F={start:function(t){return this.isUpdating=!1,t.once("value",T,this),this},stop:function(){return this}},C=function(t,e){var i=this.addItem(t,e);this.updateItemID2Index(),this.emit(this.eventNames.add,i),this.emit(this.eventNames.update,this.items)},A=function(t){var e=this.removeItem(t);this.updateItemID2Index(),this.emit(this.eventNames.remove,e),this.emit(this.eventNames.update,this.items)},M=function(t,e){var i=this.removeItem(t);this.updateItemID2Index(),this.addItem(t,e),this.updateItemID2Index(),this.emit(this.eventNames.change,i),this.emit(this.eventNames.update,this.items)},q={start:function(t){return t.on("child_added",C,this),t.on("child_removed",A,this),t.on("child_moved",M,this),t.on("child_changed",M,this),this},stop:function(){return this.query.off("child_added",C,this),this.query.off("child_removed",A,this),this.query.off("child_moved",M,this),this.query.off("child_changed",M,this),this}},G={start:function(t){return t.on("value",T,this),this},stop:function(){return this.query.off("value",T,this),this}};function z(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var J=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=b()(e,"eventEmitter",void 0),n=b()(e,"EventEmitterClass",void 0);this.setEventEmitter(i,n),this.isUpdating=!1,this.items=[],this.itemID2Index={},this.eventNames={update:b()(e,"eventNames.update","update"),add:b()(e,"eventNames.add","add"),remove:b()(e,"eventNames.remove","remove"),change:b()(e,"eventNames.change","change")},this.setItemIDKey(b()(e,"itemIDKey","__itemID__")),this.setMode(b()(e,"mode",1)),this.setGetitemCallback(b()(e,"getItemCallback",S),b()(e,"getItemCallbackScope",this)),this.setQuery(b()(e,"query",void 0))}var e,i,n;return e=t,(i=[{key:"shutdown",value:function(){this.stopUpdate().clear()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setItemIDKey",value:function(t){return this.keyItemID=t,this}},{key:"setMode",value:function(t){return"string"==typeof t&&(t=W[t]),this.mode=t,this.updater=K[t],this}},{key:"setGetitemCallback",value:function(t,e){return this.getItemCallback=t,this.getItemCallbackScope=e,this}},{key:"setQuery",value:function(t){return this.query=t,this}},{key:"startUpdate",value:function(t){if(t)this.setQuery(t);else{if(!this.query)return this;t=this.query}return this.stopUpdate().clear(),this.isUpdating=!0,this.updater.start.call(this,t),this}},{key:"stopUpdate",value:function(){return this.query&&this.isUpdating?(this.isUpdating=!1,this.updater.stop.call(this),this):this}}])&&z(e.prototype,i),n&&z(e,n),t}();Object.assign(J.prototype,y.a,N);var K={0:F,1:q,2:G},W={once:0,child:1,all:2},Q=J,B=function(t,e){var i=!1;return t.forEach(function(t){if(t.val().userID===e)return i=!0,!0}),i},V=function(){var t=this.userInfo.userID,e=this.userInfo.userName;if(this.contains(t))return Promise.resolve();var i=this,n={userID:t,userName:e},r=g(this.database,this.rootPath),s=r.push();return s.onDisconnect().remove(),0===this.maxUsers?s.set(n).catch(function(t){return i.emit("join-fail",n),Promise.reject()}):s.set(n).then(function(){return a(0)}).then(function(){return r.limitToFirst(i.maxUsers).once("value")}).then(function(e){return B(e,t)?Promise.resolve():(s.remove().then(function(){s.onDisconnect().cancel()}),Promise.reject())}).catch(function(t){return i.emit("join-fail",n),Promise.reject()})},H=function(){var t=this.userInfo.userID;if(!this.contains(t))return Promise.resolve();var e=this.userID2ItemID[t];return GetRef(this.database,this.rootPath,e).remove()};function X(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Y=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=b()(i,"eventEmitter",void 0),r=b()(i,"EventEmitterClass",void 0);this.setEventEmitter(n,r),this.database=e.database(),this.setRootPath(b()(i,"root","")),this.userInfo={userID:"",userName:""},this.setUser(b()(i,"userID",""),b()(i,"userName","")),this.setMaxUsers(b()(i,"maxUsers",0)),this.userList=new Q({eventEmitter:this.getEventEmitter(),itemIDKey:"joinAt",eventNames:{add:b()(i,"eventNames.join","join"),remove:b()(i,"eventNames.leave","leave"),update:b()(i,"eventNames.update","update")}}),this.userID2ItemID={},this.userList.on(this.userList.eventNames.add,function(t){this.userID2ItemID[t.userID]=t.joinAt,t.userID===this.userInfo.userID&&this.emit("init",this.getUsers())},this).on(this.userList.eventNames.remove,function(t){delete this.userID2ItemID[t.userID]},this)}var e,i,n;return e=t,(i=[{key:"shutdown",value:function(){this.stopUpdate().destroyEventEmitter().leave(),this.userList.shutdown()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setRootPath",value:function(t){return this.rootPath=t,this}},{key:"setUser",value:function(t,e){return"string"==typeof t?(this.userInfo.userID=t,this.userInfo.userName=e):this.userInfo=t,this}},{key:"setMaxUsers",value:function(t){return this.maxUsers=t,this}},{key:"clear",value:function(){return this.userList.clear(),this}},{key:"forEach",value:function(t,e){return this.userList.forEach(t,e),this}},{key:"isFull",value:function(){return 0!==this.maxUsers&&this.userList.getItems().length>=this.maxUsers}},{key:"isFirstUser",value:function(t){var e=this.usersList.getItems()[0];return e&&e.userID===t}},{key:"getUser",value:function(t){if(!this.contains(t))return null;var e=this.userID2ItemID[t];return this.userList.getItemFromItemID(e)}},{key:"getUsers",value:function(){return this.userList.getItems()}},{key:"getUserRef",value:function(t){if(!this.contains(t))return null;var e=this.userID2ItemID[t];return g(this.database,this.rootPath,e)}},{key:"contains",value:function(t){return this.userID2ItemID.hasOwnProperty(t)}},{key:"startUpdate",value:function(){var t=g(this.database,this.rootPath);return this.maxUsers>0&&(t=t.limitToFirst(this.maxUsers)),this.userList.startUpdate(t),this}},{key:"stopUpdate",value:function(){return this.userList.stopUpdate(),this}}])&&X(e.prototype,i),n&&X(e,n),t}(),Z={join:V,leave:H};Object.assign(Y.prototype,y.a,Z);var $=Y;p.register("onlineUserList",function(t){return new $(this.app,t)}),Object(x.a)(window,"RexPlugins.Fire.OnlineUserList",$);var tt=function(t){return this.getRoomAliveRef(t).transaction(function(t){return null===t||void 0})},et=function(t){var e=(t=s(it,t)).roomID,i=t.roomName,n=t.roomType,r=t.doorState,o=t.join,a=this.getRoomRef(e),u=this.getRoomFilterRef(e),h=this.getRoomMetadataRef(e);this.isRemoveRoomWhenLeft=!t.presisted,this.isRemoveRoomWhenLeft&&(a.onDisconnect().remove(),u.onDisconnect().remove(),h.onDisconnect().remove());var c=function(t,e){return"".concat(t,"|").concat(e)}(r,n);o&&(this.userList.setRootPath(this.getUserListPath(e)).setMaxUsers(0).join(),this.userList.setMaxUsers(t.maxUsers));var f={filter:c,name:i},l={name:i,filter:c,maxUsers:t.maxUsers,moderators:{}};l.moderators[this.userInfo.userID]=this.userInfo.userName;var m={};m["rooms/".concat(e)]={alive:!0},m["room-filter/".concat(e)]=f,m["room-metadata/".concat(e)]=l,this.isRoomCreator=!0;var v=this;return this.getRootRef().update(m).then(function(){return v.roomID=e,v.roomName=i,v.roomType=n,v.emit("create",v),o&&v.onJoinRoom(t),Promise.resolve()}).catch(function(t){return v.isRoomCreator=!1,v.emit("create-fail",v),Promise.reject(t)})},it={roomID:"",roomName:"",roomType:"",maxUsers:0,presisted:!1,door:"open",join:!0},nt=function(t){var e=this;return rt.call(e,t).then(function(i){return e.userList.setRootPath(this.getUserListPath(t.roomID)).setMaxUsers(i.maxUsers).join()}).then(function(){return e.onJoinRoom(t),Promise.resolve()}).catch(function(){return e.emit("join-fail",t),Promise.reject()})},rt=function(t){var e=this;return this.getRoomMetadataRef(t.roomID).once("value").then(function(i){var n=i.val();return t.roomName=n.name,t.roomType=n.filter.split("|")[1],e.isRoomOpened(n)?Promise.resolve(n):Promise.reject()})},st={getRootRef:function(t){return g(this.database,this.rootPath,t)},getRoomRef:function(t,e){var i=this.getRootRef("rooms");return void 0!==t&&(i=i.child(t),void 0!==e&&(i=i.child(e))),i},getRoomAliveRef:function(t){return this.getRoomRef(t,"alive")},getUserListRef:function(t){return this.getRoomRef(t,"users")},getRoomFilterRef:function(t){var e=this.getRootRef("room-filter");return void 0!==t&&(e=e.child(t)),e},getRoomMetadataRef:function(t){var e=this.getRootRef("room-metadata");return void 0!==t&&(e=e.child(t)),e},getUserMetadataRef:function(t){var e=this.getRootRef("user-metadata");return void 0!==t&&(e=e.child(t)),e},getUserListPath:function(t){return"".concat(this.rootPath,"/rooms/").concat(t,"/users")}},ot={createRoom:function(t){void 0===t&&(t={}),null==t.roomID&&(t.roomID=this.getRoomRef().push().key);var e=this;return tt.call(e,t.roomID).then(function(){return et.call(e,t)})},joinRoom:function(t){var e=this;return GetValue(t,"leftThenJoin",!0)?this.leaveRoom().then(function(){return nt.call(e,t)}):nt.call(e,t)},joinRandomRoom:function(t){if(this.lockAction)return this;this.lockAction=!0;GetValue(t,"retry",10)},leaveRoom:function(){return this.isInRoom()?(this.leftRoomFlag=!0,this.isRemoveRoomWhenLeft?this.removeRoom():this.userList.leave()):Promise.resolve()},removeRoom:function(t){if(void 0===t&&(t=this.roomID),void 0===t)return Promise.resolve();var e={};return e["room-filter/".concat(t)]=null,e["room-metadata/".concat(t)]=null,e["rooms/".concat(t)]=null,this.getRootRef().update(e)},getUserList:function(t){},kickUser:function(t){},onJoinRoom:function(t){this.roomID=t.roomID,this.roomName=t.roomName,this.roomType=t.roomType,this.userList.startUpdate(),this.emit("join",this)},onLeftRoom:function(){var t={roomID:this.roomID,roomName:this.roomName};this.roomID=void 0,this.roomName=void 0,this.doorState=void 0,this.monitorMyStateOff(),this.userList.stopUpdate().clear(),this.emit("leave",t),this.leftRoomFlag||this.emit("kicked",t),this.leftRoomFlag=!1},isRoomOpened:function(t){if(null==t)return!1;if("closed"===t.filter.split("|")[0])return!1;var e=this.userInfo.userID;if(t.moderators.hasOwnProperty(e))return!0;switch(t.permission){case"black-list":var i=t["black-list"];return!(i&&i.hasOwnProperty(e));case"white-list":var n=t["white-list"];return n&&n.hasOwnProperty(e);default:return!0}}};Object.assign(ot,st);var at=ot;function ut(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ht=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=b()(i,"eventEmitter",void 0),r=b()(i,"EventEmitterClass",void 0);this.setEventEmitter(n,r),this.database=e.database(),this.rootPath=b()(i,"root",""),this.userInfo={userID:"",userName:""},this.setUser(b()(i,"userID",""),b()(i,"userName","")),this.isRoomCreator=!1,this.roomID=void 0,this.roomName=void 0,this.roomType=void 0,this.doorState=void 0,this.leftRoomFlag=!1,this.isRemoveRoomWhenLeft=void 0,this.userList=new $(e,{eventEmitter:this.getEventEmitter(),eventNames:{join:b()(i,"eventNames.join","user.join"),leave:b()(i,"eventNames.leave","user.leave"),update:b()(i,"eventNames.update","userlist.update"),init:b()(i,"eventNames.init","userlist.init")}}),this.userList.on("user.leave",function(t){t.userID===this.userInfo.userID&&this.onLeftRoom()},this).setUser(this.userInfo),this.monitorRefPaths=[]}var e,i,n;return e=t,(i=[{key:"shutdown",value:function(){this.destroyEventEmitter().leaveRoom()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setUser",value:function(t,e){return"string"==typeof t?(this.userInfo.userID=t,this.userInfo.userName=e):this.userInfo=t,this}},{key:"isInRoom",value:function(t){return void 0===t?void 0!==this.roomID:this.roomID===t}},{key:"maxUsers",get:function(){return this.userList.maxUsers}}])&&ut(e.prototype,i),n&&ut(e,n),t}();Object.assign(ht.prototype,y.a,at);var ct=ht;p.register("room",function(t){return new ct(this.app,t)}),Object(x.a)(window,"RexPlugins.Fire.Room",ct);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mt(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vt(t){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pt=function(t){function e(t){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=mt(this,vt(e).call(this,t))).add=new p,t.registerFileType("rexFirebasePreload",v),i}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dt(t,e)}(e,Phaser.Plugins.BasePlugin),i=e,(n=[{key:"start",value:function(){this.game.events.once("destroy",this.destroy,this)}},{key:"initializeApp",value:function(t){return this.add.initializeApp(t),this}},{key:"preload",value:function(t,e){t.sys.load.hasOwnProperty("rexFirebasePreload")||(t.sys.load.rexFirebasePreload=v),t.load.rexFirebasePreload(e)}},{key:"app",get:function(){return this.add.app}}])&&lt(i.prototype,n),r&&lt(i,r),e}();e.default=pt},7:function(t,e,i){"use strict";e.a=function(t){if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e]}},74:function(t,e,i){"use strict";e.a=function(t,e){for(var i=document.getElementsByTagName("script"),n=0,r=i.length;n<r;n++)if(-1!=i[n].src.indexOf(t))return void(e&&e());var s=document.createElement("script");s.setAttribute("src",t),e&&(s.onload=e),document.head.appendChild(s)}}}).default});