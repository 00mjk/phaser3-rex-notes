!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rexcsvscenarioplugin=e():t.rexcsvscenarioplugin=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=85)}({0:function(t,e,s){"use strict";e.a=function(t){return"[object Array]"===Object.prototype.toString.call(t)}},11:function(t,e,s){"use strict";e.a=function(t,e,s,n){e=e||",";for(var r=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),i=[],a=[i],o=null;o=r.exec(t);){var u=o[1];if(u.length&&u!=e&&(i=[],a.push(i)),o[2])var c=o[2].replace(new RegExp('""',"g"),'"');else c=o[3];s&&(c=n?s.call(n,c):s(c)),i.push(c)}return a}},12:function(t,e,s){"use strict";var n=s(13);e.a=n.a},13:function(t,e,s){"use strict";var n=s(4),r=s(7);const i=Phaser.Utils.Objects.GetValue;var a=function(t,e,s){var n,r=i(s,"reverse",!1);if("string"==typeof t[0])n=o(t,e,s);else if(r)for(u=(c=t.length)-1;u>=0;u--)n=a(t[u],e,s);else for(var u=0,c=t.length;u<c;u++)n=a(t[u],e,s);return n},o=function(t,e,s){var r=i(s,"argsConvert",void 0),a=i(s,"argsConvertScope",void 0),o=t[0];if(u=Object(n.a)(u,t,1),void 0!==r){!0===r&&(r=c,a=void 0);for(var h=0,l=u.length;h<l;h++)u[h]=a?r.call(a,t,u[h]):r(t,u[h])}var p=e[o];return null==p&&(p=i(e,o,null)),e?p.apply(e,u):p(u)},u=[];const c=function(t,e){return Object(r.a)(e)};e.a=a},3:function(t,e,s){"use strict";var n=s(0);e.a=function(t){if(Object(n.a)(t))t.length=0;else for(var e in t)delete t[e]}},4:function(t,e,s){"use strict";e.a=function(t,e,s,n){void 0===s&&(s=0),void 0===n&&(n=e.length),t.length=n-s;for(var r=0,i=t.length;r<i;r++)t[r]=e[r+s];return t}},7:function(t,e,s){"use strict";var n=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i;e.a=function(t){if("string"!=typeof t)return t;if(""===t)t=null;else if(n.test(t))t=parseFloat(t);else{var e=t.toLowerCase();"false"===e?t=!1:"true"===e&&(t=!0)}return t}},8:function(t,e,s){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function i(){}function a(t,e,s,n,i){if("function"!=typeof s)throw new TypeError("The listener must be a function");var a=new function(t,e,s){this.fn=t,this.context=e,this.once=s||!1}(s,n||t,i),o=r?r+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],a]:t._events[o].push(a):(t._events[o]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,e,s=[];if(0===this._eventsCount)return s;for(e in t=this._events)n.call(t,e)&&s.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(t)):s},u.prototype.listeners=function(t){var e=r?r+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var n=0,i=s.length,a=new Array(i);n<i;n++)a[n]=s[n].fn;return a},u.prototype.listenerCount=function(t){var e=r?r+t:t,s=this._events[e];return s?s.fn?1:s.length:0},u.prototype.emit=function(t,e,s,n,i,a){var o=r?r+t:t;if(!this._events[o])return!1;var u,c,h=this._events[o],l=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,s),!0;case 4:return h.fn.call(h.context,e,s,n),!0;case 5:return h.fn.call(h.context,e,s,n,i),!0;case 6:return h.fn.call(h.context,e,s,n,i,a),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];h.fn.apply(h.context,u)}else{var p,f=h.length;for(c=0;c<f;c++)switch(h[c].once&&this.removeListener(t,h[c].fn,void 0,!0),l){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,e);break;case 3:h[c].fn.call(h[c].context,e,s);break;case 4:h[c].fn.call(h[c].context,e,s,n);break;default:if(!u)for(p=1,u=new Array(l-1);p<l;p++)u[p-1]=arguments[p];h[c].fn.apply(h[c].context,u)}}return!0},u.prototype.on=function(t,e,s){return a(this,t,e,s,!1)},u.prototype.once=function(t,e,s){return a(this,t,e,s,!0)},u.prototype.removeListener=function(t,e,s,n){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||n&&!a.once||s&&a.context!==s||o(this,i);else{for(var u=0,c=[],h=a.length;u<h;u++)(a[u].fn!==e||n&&!a[u].once||s&&a[u].context!==s)&&c.push(a[u]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u},85:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(86);e.default=class extends Phaser.Plugins.BasePlugin{constructor(t){super(t)}start(){this.game.events.once("destroy",this.destroy,this)}add(t,e){return new n.a(t,e)}}},86:function(t,e,s){"use strict";var n=s(87);e.a=n.a},87:function(t,e,s){"use strict";var n=s(8),r=s.n(n),i=s(11),a=(s(0),s(88)),o=s(89);const u=Phaser.Utils.Objects.GetFastValue;const c={ms:0,s:1,sec:1},h=/^#([a-zA-Z]+)/;e.a=class extends r.a{constructor(t,e){super(),this.scene=t,this.timer=void 0,this.cmdQueue=new a.a(this),this.cmdHandlers=new o.a(this),this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.isRunning=!1,this.isPaused=!1,this.waitEvent=void 0,this.cmdHandlers.resetFromJSON(t),this.cmdQueue.resetFromJSON(t),this.scope=void 0,this.timeUnit=u(t,"timeUnit",0),this.isDebugMode=u(t,"debug",!1),this}toJSON(){return{}}boot(){}shutdown(){this.parent=void 0}destroy(){this.shutdown()}load(t,e,s){return this.stop(),this.timeUnit=u(s,"timeUnit",this.timeUnit),"string"==typeof this.timeUnit&&(this.timeUnit=c[this.timeUnit]),this.scope=e,this.parse(Object(i.a)(t),s),this}start(t){var e=u(t,"label","");this.isRunning=!0,this.isPaused=!1;var s=this.getCmdHandler("label").getIndex(e);null!=s?(this.log("Start at Label: "+e),this.runNextCmd(s)):this.log("Label: "+e+" is not found")}wait(t){if(this.waitEvent=t,"number"==typeof t){var e=t;1===this.timeUnit&&(e*=1e3),this.timer=this.scene.time.delayedCall(e,this.resume,[t],this)}}stop(){this.timer&&(this.timer.remove(),this.timer=void 0),this.isRunning=!1}complete(){this.emit("complete"),this.stop()}append(t){}clean(){}pause(){this.isPaused=!0,this.timer&&(this.timer.paused=!0)}resume(t){this.isRunning&&(void 0===t?(this.isPaused=!1,this.timer&&(this.timer.paused=!1)):this.resumeFromEvent(t))}resumeFromEvent(t){this.isPaused||t===this.waitEvent&&(this.timer=void 0,this.waitEvent=void 0,this.runNextCmd())}get lastLabel(){return this.cmdHandlers.labelCmd.lastLabel}get previousLabel(){return this.cmdHandlers.labelCmd.preLabel}getCmdHandler(t){return"string"!=typeof t&&(t=t[0]),this.cmdHandlers.get(t)}parse(t,e){var s,n,r=u(e,"prefix",h);"string"==typeof r&&(r=new RegExp(r));for(var i=0,a=t.length;i<a;i++)if("-"===(n=(s=t[i])[0]))this.appendCommand(s);else if(isNaN(n))if(r.test(n)){var o=n.match(r);s[0]=o[1].toLowerCase(),this.appendCommand(s)||this.log("Line "+i+": "+JSON.stringify(s)+" is not a valid command")}else this.appendCommand(["waitevent",n]),s[0]="-",this.appendCommand(s);else{var c=parseFloat(n);c>0&&this.appendCommand(["waittime",c]),s[0]="-",this.appendCommand(s)}return this}appendCommand(t){var e=this.getCmdHandler(t);return null!=e&&((t=e.parse(t,this.cmdQueue.length))&&this.cmdQueue.append(t),!0)}runNextCmd(t){for(var e,s=this.cmdQueue;this.isRunning&&!this.isPaused&&void 0===this.waitEvent;){if(0===s.length)return void this.complete();if(null==(e=s.get(t)))return void this.complete();this.getCmdHandler(e).run(e),t=void 0}}log(t){this.isDebugMode&&console.log(t)}}},88:function(t,e,s){"use strict";e.a=class{constructor(t){this.scenario=t,this.queue=[],this.resetFromJSON()}resetFromJSON(t){return this.clean(),this}clean(){return this.queue.length=0,this.currentIdx=-1,this}append(t){return this.queue.push(t),this}appendMultiple(t){for(var e=0,s=t.length;e<s;e++)this.append(t[e]);return this}get(t){return void 0===t&&(t=this.currentIdx+1),this.currentIdx=t,this.queue[t]}get length(){return this.queue.length}}},89:function(t,e,s){"use strict";var n=s(90),r=s(91),i=s(92),a=s(93),o=s(94),u=s(95);e.a=class{constructor(t){this.cmds={"-":new n.a(t),wait:new r.a(t),waittime:new i.a(t),waitevent:new a.a(t),label:new o.a(t),exit:new u.a(t)}}resetFromJSON(t){for(var e in this.cmds)this.cmds[e].resetFromJSON(t);return this}get(t){return this.cmds[t]}isValidCmdName(t){return this.cmds.hasOwnProperty(t)}}},9:function(t,e,s){"use strict";e.a=class{constructor(t,e){this.scenario=t,this.type=e}resetFromJSON(t){}parse(t,e){return t}run(t){}}},90:function(t,e,s){"use strict";var n=s(9),r=(s(4),s(12));const i=Phaser.Utils.Array.SpliceOne;e.a=class extends n.a{constructor(t){super(t,"-"),this.task=void 0}resetFromJSON(t){this.task&&(this.task.off("complete",this.resume,this),this.task=void 0)}parse(t,e){return t=[i(t,0),t]}run(t){var e=this.scenario,s=Object(r.a)(t[1],e.scope);s&&"function"==typeof s.once?(s.once("complete",this.resume,this),this.pause(),this.task=s):this.task=void 0}pause(){this.scenario.pause()}resume(){this.task=void 0;var t=this.scenario;t.resume(),t.runNextCmd()}}},91:function(t,e,s){"use strict";var n=s(9);e.a=class extends n.a{constructor(t){super(t,"wait")}parse(t,e){return isNaN(t[1])?t[0]="waitevent":t[0]="waittime",this.scenario.getCmdHandler(t).parse(t,e)}}},92:function(t,e,s){"use strict";var n=s(9);e.a=class extends n.a{constructor(t){super(t,"waittime")}parse(t,e){var s=parseFloat(this.getDelayTime(t));if(!(s<=0))return t[1]=s,t.length=2,t}run(t){var e=this.getDelayTime(t);e>0&&(this.scenario.log("#WAIT TIME:"+e),this.scenario.wait(e))}getDelayTime(t){return t[1]}}},93:function(t,e,s){"use strict";var n=s(9);e.a=class extends n.a{constructor(t){super(t,"waitevent")}parse(t,e){return t.length=2,t}run(t){var e=this.getEventName(t);this.scenario.log("#WAIT EVENT:"+e),this.scenario.wait(e)}getEventName(t){return t[1]}}},94:function(t,e,s){"use strict";var n=s(9),r=s(3);e.a=class extends n.a{constructor(t){super(t,"label"),this.labels={},this.prevLabel="",this.lastLabel=""}resetFromJSON(t){Object(r.a)(this.labels),this.prevLabel="",this.lastLabel=""}parse(t,e){var s=this.getLabel(t);return this.addLabel(s,e),t.length=2,t}run(t){var e=this.getLabel(t);this.scenario.log("#LABEL:"+e),this.prevLabel=this.lastLabel,this.lastLabel=e;var s=this.scenario;s.emit("labelchange",s,this.prevLabel,this.lastLabel)}getLabel(t){return t[1]}addLabel(t,e){this.labels[t]=e}getIndex(t){return""!==t&&this.hasLabel(t)?this.labels[t]:0}hasLabel(t){return this.labels.hasOwnProperty(t)}}},95:function(t,e,s){"use strict";var n=s(9);e.a=class extends n.a{constructor(t){super(t,"exit")}parse(t,e){return t.length=1,t}run(t){this.scenario.log("#EXIT"),this.scenario.complete()}}}}).default});