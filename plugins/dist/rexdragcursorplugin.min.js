!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rexdragcursorplugin=e():t.rexdragcursorplugin=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=63)}({1:function(t,e,s){"use strict";const i=Phaser.Scene;e.a=function(t){return t instanceof i?t:t.scene&&t.scene instanceof i?t.scene:t.parent&&t.parent.scene&&t.parent.scene instanceof i?t.parent.scene:void 0}},63:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(64);e.default=class extends Phaser.Plugins.BasePlugin{constructor(t){super(t)}start(){this.game.events.once("destroy",this.destroy,this)}add(t,e){return new i.a(t,e)}}},64:function(t,e,s){"use strict";var i=s(65);e.a=i.a},65:function(t,e,s){"use strict";s(1);var i=s(66);const n=Phaser.Utils.Objects.GetAdvancedValue;e.a=class extends i.a{constructor(t,e){super(e),this.parent=t,this.boot()}resetFromJSON(t){super.resetFromJSON(t),this.pointerId=null,void 0==this.cfg.origin&&(this.cfg.origin={}),void 0==this.origin&&(this.origin={});var e=n(t,"origin.x",null),s=n(t,"origin.y",null);return this.setOrigin(e,s),this}toJSON(){var t=super.toJSON();return t.origin={x:this.cfg.origin.x,y:this.cfg.origin.y},t}boot(){if(this.parent&&this.parent.input){var t=this.parent.input;t instanceof Phaser.Input.InputPlugin&&(t.on("pointerdown",this.onDragStart,this),t.on("pointerup",this.onDrop,this),t.on("pointermove",this.onDragging,this))}}shutdown(){var t=this.parent.input;t.off("pointerdown",this.onDragStart,this),t.off("pointerup",this.onDragStart,this),t.off("pointermove",this.onDragStart,this)}destroy(){this.shutdown()}setOrigin(t,e){var s=this.cfg.origin;return s.x=t,s.y=e,this}onDragStart(t){if(null===this.pointerId){this.pointerId=t.id;var e=null!==this.cfg.origin.x;this.origin.x=e?this.cfg.origin.x:t.x,this.origin.y=e?this.cfg.origin.y:t.y,this.setVector(this.origin.x,this.origin.y,t.x,t.y)}}onDragging(t){this.pointerId===t.id&&t.isDown&&this.setVector(this.origin.x,this.origin.y,t.x,t.y)}onDrop(t){this.pointerId===t.id&&(this.pointerId=null,this.origin.x=null,this.origin.y=null,this.cleanVector())}}},66:function(t,e,s){"use strict";Phaser.Utils.Objects.GetFastValue;const i=Phaser.Utils.Objects.GetValue,n=Phaser.Utils.Objects.GetAdvancedValue,r=Phaser.Input.Keyboard.Key,o=Phaser.Math.RadToDeg;const a={"up&down":0,"left&right":1,"4dir":2,"8dir":3};e.a=class{constructor(t){this.resetFromJSON(t)}resetFromJSON(t){void 0==this.cfg&&(this.cfg={}),void 0==this.start&&(this.start={}),void 0==this.end&&(this.end={}),void 0==this.cursorKeys&&(this.cursorKeys={up:new r,down:new r,left:new r,right:new r}),this.setEnable(n(t,"enable",!0)),this.setMode(n(t,"dir","8dir")),this.setDistanceThreshold(n(t,"distanceMin",16));var e=i(t,"start.x",null),s=i(t,"start.y",null),o=i(t,"end.x",null),a=i(t,"end.y",null);return null!==e&&null!==s&&null!==o&&null!==a?this.setVector(e,s,o,a):this.cleanVector(),this}toJSON(){return{enable:this.cfg.enable,dir:this.cfg.dirMode,distanceMin:this.cfg.distanceMin,start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}}}setMode(t){return"string"==typeof t&&(t=a[t]),this.cfg.dirMode=t,this}setEnable(t){(t=void 0==t||!!t)!==this.cfg.enable&&(!1===t&&this.cleanVector(),this.cfg.enable=t)}setDistanceThreshold(t){return t<0&&(t=0),this.cfg.distanceMin=t,this}createCursorKeys(){return this.cursorKeys}setKeyState(t,e){var s=this.cursorKeys[t];if(s.enabled){var i=!e;s.isDown=e,s.isUp=i}}cleanVector(){for(var t in this.start.x=null,this.start.y=null,this.end.x=null,this.end.y=null,this.cursorKeys)this.setKeyState(t,!1);return this}setVector(t,e,s,i){if(!this.cfg.enable)return this;if(this.cleanVector(),null==t)return this;this.start.x=t,this.start.y=e,this.end.x=s,this.end.y=i;var n=s-t,r=i-e,a=Math.sqrt(n*n+r*r),h=o(Math.atan2(r,n));if(h=(360+h)%360,a<this.cfg.distanceMin)return this;switch(this.cfg.dirMode){case 0:var u=h<180?"down":"up";this.setKeyState(u,!0);break;case 1:u=h>90&&h<=270?"left":"right",this.setKeyState(u,!0);break;case 2:u=h>45&&h<=135?"down":h>135&&h<=225?"left":h>225&&h<=315?"up":"right",this.setKeyState(u,!0);break;case 3:h>22.5&&h<=67.5?(this.setKeyState("down",!0),this.setKeyState("right",!0)):h>67.5&&h<=112.5?this.setKeyState("down",!0):h>112.5&&h<=157.5?(this.setKeyState("down",!0),this.setKeyState("left",!0)):h>157.5&&h<=202.5?this.setKeyState("left",!0):h>202.5&&h<=247.5?(this.setKeyState("left",!0),this.setKeyState("up",!0)):h>247.5&&h<=292.5?this.setKeyState("up",!0):h>292.5&&h<=337.5?(this.setKeyState("up",!0),this.setKeyState("right",!0)):this.setKeyState("right",!0)}return this}}}}).default});