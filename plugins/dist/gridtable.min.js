!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var l in i)("object"==typeof exports?exports:t)[l]=i[l]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function i(l){if(e[l])return e[l].exports;var s=e[l]={i:l,l:!1,exports:{}};return t[l].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,l){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:l})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=49)}({1:function(t,e,i){"use strict";e.a=function(t){return"[object Array]"===Object.prototype.toString.call(t)}},3:function(t,e,i){"use strict";var l=i(1);e.a=function(t){if(Object(l.a)(t))t.length=0;else for(var e in t)delete t[e]}},4:function(t,e,i){"use strict";var l=i(9);e.a=l.a},49:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=i(50);e.default=l.a},50:function(t,e,i){"use strict";var l=i(51),s=i(3);i(1);const h=Phaser.GameObjects.Container,r=Phaser.GameObjects.Components,a=Phaser.Utils.Objects.GetValue,o=Phaser.Math.Clamp;class n extends h{constructor(t,e,i,s,h,r){super(t,e,i),this.type="GridTable",this.updateFlag=!0,this._tableOX=0,this._tableOY=0,this.visibleCellIdx={},this.preVisibleCellIdx={},this.visibleStartX=null,this.visibleEndX=null,this.visibleStartY=null,this.visibleEndY=null,this.execeedTopState=!1,this.execeedBottomState=!1,this.execeedLeftState=!1,this.execeedRightState=!1,void 0===s&&(s=0),void 0===h&&(h=0),this.setSize(s,h),this.setScrollMode(a(r,"scrollMode",0)),this.setClampMode(a(r,"clamplTableOXY",!0));var o=a(r,"cellVisibleCallback",null);if(null!==o){var n=a(r,"cellVisibleCallbackScope",void 0);this.on("cellvisible",o,n)}if(null!==(o=a(r,"cellInvisibleCallback",null))){n=a(r,"cellInvisibleCallbackScope",void 0);this.on("cellinvisible",o,n)}this.table=new l.a(this,r),this.updateTable()}setScrollMode(t){"string"==typeof t&&(t=u[t.toLowerCase()]),this.scrollMode=t}setClampMode(t){return this.clampTableOXYMode=t,this}setCellsCunt(t){return this.table.setCellCount(t),this}setColumnCount(t){return this.table.setColumnCount(t),this}setGridSize(t,e){return this.table.setCellsCunt(t*e),this.table.setColumnCount(t),this}get tableOY(){return this._tableOY}get tableOX(){return this._tableOX}set tableOY(t){var e=this.table,i=this.topTableOY,l=this.bottomTableOY,s=this.tableOYExceedTop(t),h=this.tableOYExeceedBottom(t);if(this.clampTableOXYMode)if(e.rowCount<e.heightToRowIndex(this.instHeight,!0))t=0;else if(s)t=i;else{this.tableVisibleHeight;h&&(t=l)}this._tableOY!==t&&(this.updateFlag=!0,this._tableOY=t),s&&(this.execeedTopState||this.emit("execeedtop",this,t,i)),this.execeedTopState=s,h&&(this.execeedBottomState||this.emit("execeedbottom",this,t,l)),this.execeedBottomState=h}set tableOX(t){var e=this.table,i=this.leftTableOX,l=this.rightTableOX,s=this.tableOXExeceedLeft(t),h=this.tableOXExeceedRight(t);if(this.clampTableOXYMode)if(e.colCount<e.widthToColIndex(this.instWidth,!0))t=0;else if(s)t=i;else{this.tableVisibleWidth;h&&(t=l)}this._tableOX!==t&&(this.updateFlag=!0,this._tableOX=t),s&&(this.execeedLeftState||this.emit("execeedleft",this,t,i)),this.execeedLeftState=s,h&&(this.execeedRightState||this.emit("execeedright",this,t,l)),this.execeedRightState=h}setTableOY(t){return this.tableOY=t,this}setTableOX(t){return this.tableOX=t,this}setTableOXY(t,e){return this.tableOX=t,this.tableOY=e,this}addTableOX(t){return this.tableOX+=t,this}addTableOY(t){return this.tableOY+=t,this}addTableOXY(t,e){return this.tableOX+=t,this.tableOY+=e,this}setTableOYByPercentage(t){return t=o(t,0,1),this.setTableOY(-this.tableVisibleHeight*t),this}updateTable(t){return t&&(this.updateFlag=!0),this.updateFlag?(this.updateFlag=!1,t&&(this.cleanVisibleCellIndexes(),this.hideCells()),this.cleanVisibleCellIndexes(),this.showCells(),this.hideCells(),this):this}getCell(t){return this.table.getCell(t,!0)}eachVisibleCell(t,e){for(var i=[null],l=2,s=arguments.length;l<s;l++)i.push(arguments[l]);var h=this.visibleCellIdx;if(e)for(var r in h)i[0]=this.getCell(r),t.apply(e,i);else for(var r in h)i[0]=this.getCell(r),t(i);return this}cleanVisibleCellIndexes(){var t=this.preVisibleCellIdx;this.preVisibleCellIdx=this.visibleCellIdx,this.visibleCellIdx=t,Object(s.a)(this.visibleCellIdx)}showCells(){var t=this.table,e=t.heightToRowIndex(-this.tableOY);e<0&&(e=0);var i=t.widthToColIndex(-this.tableOX);i<0&&(i=0);for(var l=t.colRowToCellIndex(i,e),s=this.bottomBound,h=this.rightBound,r=t.cellCount-1,a=t.colCount-1,o=this.getTLX(i),n=o,u=this.getTLY(e);u<s&&l<=r;){if(this.table.isValidCellIdx(l)){null===this.visibleStartY&&(this.visibleStartY=e,this.visibleEndY=e),null===this.visibleStartX&&(this.visibleStartX=i,this.visibleEndX=i),this.visibleEndY<e&&(this.visibleEndY=e),this.visibleEndX<i&&(this.visibleEndX=i),this.visibleCellIdx[l]=!0;var d=t.getCell(l,!0);this.preVisibleCellIdx.hasOwnProperty(l)||this.showCell(d,l),d.setXY(n,u)}n<h&&i<a?(n+=t.getColWidth(i),i+=1):(n=o,u+=t.getRowHeight(e),i=this.visibleStartX,e+=1),l=t.colRowToCellIndex(i,e)}}showCell(t,e){this.emit("cellvisible",t,e)}hideCells(){var t,e=this.preVisibleCellIdx,i=this.visibleCellIdx,l=this.table;for(var s in e)!i.hasOwnProperty(s)&&l.isValidCellIdx(s)&&(t=this.table.getCell(s,!1),this.hideCell(t,s))}hideCell(t,e){this.emit("cellinvisible",t,e),t.destroyContainer()}get instHeight(){return 0===this.scrollMode?this.height:this.width}get instWidth(){return 0===this.scrollMode?this.width:this.height}get topTableOY(){return 0}get bottomTableOY(){return-this.tableVisibleHeight}get leftTableOX(){return 0}get rightTableOX(){return-this.tableVisibleWidth}tableOYExceedTop(t){return void 0===t&&(t=this.tableOY),t>this.topTableOY}tableOYExeceedBottom(t){return void 0===t&&(t=this.tableOY),t<this.bottomTableOY}tableOXExeceedLeft(t){return void 0===t&&(t=this.tableOX),t>this.leftTableOX}tableOXExeceedRight(t){return void 0===t&&(t=this.tableOX),t<this.rightTableOX}get tableVisibleHeight(){var t=this.table.totalRowsHeight,e=this.instHeight;return t>e?t-e:0}get tableVisibleWidth(){var t=this.table.totalColumnWidth,e=this.instWidth;return t>e?t-e:t}get bottomLeftY(){return-this.displayHeight*this.originY+this.displayHeight}get topRightX(){return-this.displayWidth*this.originX+this.displayWidth}get topLeftX(){return-this.displayWidth*this.originX}get topLeftY(){return-this.displayHeight*this.originY}get bottomBound(){return 0===this.scrollMode?this.bottomLeftY:this.topRightX}get rightBound(){return 0===this.scrollMode?this.topRightX:this.bottomLeftY}getTLX(t){var e=0===this.scrollMode?this.topLeftX:this.topLeftY;return this.tableOX+this.table.colIndexToWidth(0,t-1)+e}getTLY(t){var e=0===this.scrollMode?this.topLeftY:this.topLeftX;return this.tableOY+this.table.rowIndexToHeight(0,t-1)+e}destroy(){this.table.destroy(),super.destroy()}}Object.assign(n.prototype,r.GetBounds);const u={v:0,vertical:0,h:1,horizontal:1};Phaser.GameObjects.GameObjectFactory.register("rexGridTable",function(t,e,i,l,s){return this.displayList.add(new n(this.scene,t,e,i,l,s))}),Phaser.GameObjects.GameObjectCreator.register("rexGridTable",function(t){var e=a(t,"width",256),i=a(t,"height",256),l=new n(this.scene,0,0,e,i,t);return BuildGameObject(this.scene,l,t),l}),e.a=n},51:function(t,e,i){"use strict";var l=i(52),s=i(4);const h=Phaser.Utils.Objects.GetValue;var r=new s.a;e.a=class{constructor(t,e){this.parent=t,this.cells=[],this.resetFromJSON(e)}resetFromJSON(t){return this.colCount=void 0,this.defaultCellHeightMode=!0,this._totalRowsHeight=null,this.setDefaultCellHeight(h(t,"cellHeight",30)),this.setDefaultCellWidth(h(t,"cellWidth",30)),this.setCellCount(h(t,"cellsCount",0)),this.setColumnCount(h(t,"columns",1)),this}setUpdateFlag(t){void 0===t&&(t=!0),this.parent.updateFlag|=t}setDefaultCellHeight(t){return this.defaultCellHeight=t,this}setDefaultCellWidth(t){return this.defaultCellWidth=t,this}setCellCount(t){var e=this.cellCount;if(e===t)return this;var i,l=this.cells;if(e>t){for(var s=t;s<e;s++)(i=l[s])&&(this.parent.hideCell(i),i.destroy(),r.push(i));l.length=t}else if(e<t)for(l.length=t,s=e;s<t;s++)l[s]=null;return Math.floor(e/this.colCount)!==Math.floor(t/this.colCount)&&(this._totalRowsHeight=null),this.setUpdateFlag(),this}setColumnCount(t){return this.setUpdateFlag(this.colCount!==t),this.colCount=t,this._totalRowsHeight=null,this}get rowCount(){return Math.ceil(this.cellCount/this.colCount)}get cellCount(){return this.cells.length}isValidCellIdx(t){return t>=0&&t<this.cellCount}heightToRowIndex(t,e){if(this.defaultCellHeightMode){var i=t/this.defaultCellHeight;return i=e?Math.ceil(i):Math.floor(i)}var l,s=this.rowCount,h=t;for(i=0;;){if(h-=this.getRowHeight(i),l=i>=0&&i<s,!(h>0&&l)){if(0===h)return i;if(e){var r=i;(l=(i+=1)>=0&&i<s)||(i=r)}return i}i+=1}}widthToColIndex(t,e){var i=t/this.defaultCellWidth;return i=e?Math.ceil(i):Math.floor(i)}colRowToCellIndex(t,e){return e*this.colCount+t}rowIndexToHeight(t,e){if(this.defaultCellHeightMode)return(e-t+1)*this.defaultCellHeight;for(var i,l=0,s=!0,h=t;h<=e;h++)l+=i=this.getRowHeight(h),i!==this.defaultCellHeight&&(s=!1);return s&&0===t&&e>=this.rowCount-1&&(this.defaultCellHeightMode=!0),l}colIndexToWidth(t,e){return(e-t+1)*this.defaultCellWidth}getRowHeight(t){var e=this.colCount;if(e<=1)return this.getCellHeight(this.colRowToCellIndex(0,t));for(var i,l=0,s=0;s<e;s++)l<(i=this.getCellHeight(this.colRowToCellIndex(s,t)))&&(l=i);return l}getColWidth(t){return this.defaultCellWidth}getCellHeight(t){if(!this.isValidCellIdx(t))return 0;var e;if(this.defaultCellHeightMode)e=this.defaultCellHeight;else{var i=this.getCell(t,!1),l=i&&i.hasOwnProperty("deltaHeight")?i.deltaHeight:0;e=this.defaultCellHeight+l}return e}get totalRowsHeight(){return null===this._totalRowsHeight&&(this._totalRowsHeight=this.rowIndexToHeight(0,this.rowCount-1)),this._totalRowsHeight}get totalColumnWidth(){return this.colCount*this.defaultCellWidth}cellIndxeToColIndex(t){return t%this.colCount}cellIndxeToRowIndex(t){return Math.floor(t/this.colCount)}getCell(t,e){if(!this.isValidCellIdx(t))return null;if(void 0===e&&(e=!0),null===this.cells[t]&&e){var i=this.newCell();this.cells[t]=i}return this.cells[t]}newCell(t){var e=r.pop();return null===e?e=new l.a(this):e.setParent(this),e}getParentContainer(){return this.parent}destroy(){this.setCellCount(0),this.parent=void 0}}},52:function(t,e,i){"use strict";var l=i(3);e.a=class{constructor(t,e){this.container=null,this.data=null,this.setParent(t)}setParent(t){this.parent=t,this.parentContainer=t.getParentContainer()}getContainer(){return this.container}setContainer(t){return this.container&&this.container.destroy(),this.container=t,this.parentContainer.add(t),this}destroyContainer(){this.container&&(this.container.destroy(),this.container=null)}popContainer(){if(this.container){var t=this.container;return this.container=null,this.parentContainer.remove(t),t}return null}setXY(t,e){this.container&&(this.container.x=t,this.container.y=e)}setData(t,e){return this.data||(this.data={}),this.data[t]=e,this}getData(t,e){this.data||(this.data={});var i=this.data;return i.hasOwnProperty(t)?i[t]:e}cleanData(){this.data&&Object(l.a)(this.data)}destroy(){this.cleanData(),this.destroyContainer(),this.parent=void 0,this.parentContainer=void 0}}},9:function(t,e,i){"use strict";e.a=class{constructor(){this.items=[]}pop(){return this.items.length>0?this.items.pop():null}push(t){this.items.push(t)}pushMultiple(t){for(var e=0,i=t.length;e<i;e++)this.items.push(t[e]);t.length=0}}}})});