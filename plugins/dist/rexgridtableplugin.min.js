!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rexgridtableplugin=e():t.rexgridtableplugin=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function i(l){if(e[l])return e[l].exports;var s=e[l]={i:l,l:!1,exports:{}};return t[l].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,l){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:l})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=57)}({2:function(t,e,i){"use strict";e.a=class{constructor(){this.items=[]}pop(){return this.items.length>0?this.items.pop():null}push(t){this.items.push(t)}pushMultiple(t){for(var e=0,i=t.length;e<i;e++)this.items.push(t[e]);t.length=0}}},3:function(t,e,i){"use strict";e.a=function(t){return"[object Array]"===Object.prototype.toString.call(t)}},57:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=i(58);const s=Phaser.Utils.Objects.GetValue,h=Phaser.GameObjects.BuildGameObject;e.default=class extends Phaser.Plugins.BasePlugin{constructor(t){super(t),t.registerGameObject("rexGridTable",this.addGridTable,this.makeGridTable)}addGridTable(t,e,i,s,h){return this.displayList.add(new l.a(this.scene,t,e,i,s,h))}makeGridTable(t){var e=s(t,"width",256),i=s(t,"height",256),r=new l.a(this.scene,0,0,e,i,t);return h(this.scene,r,t),r}}},58:function(t,e,i){"use strict";var l=i(59);i(7),i(3);const s=Phaser.GameObjects.Container,h=Phaser.GameObjects.Components,r=Phaser.Structs.Set,n=Phaser.Utils.Objects.GetValue,a=Phaser.Math.Clamp;class o extends s{constructor(t,e,i,s,h,a){super(t,e,i),this.type="GridTable",this.updateFlag=!0,this._tableOX=0,this._tableOY=0,this.visibleCells=new r,this.preVisibleCells=new r,this.visibleStartX=null,this.visibleEndX=null,this.visibleStartY=null,this.visibleEndY=null,this.lastVisibleCellIdx=null,this.execeedTopState=!1,this.execeedBottomState=!1,this.execeedLeftState=!1,this.execeedRightState=!1,void 0===s&&(s=0),void 0===h&&(h=0),this.setSize(s,h),this.setScrollMode(n(a,"scrollMode",0)),this.setClampMode(n(a,"clamplTableOXY",!0));var o=n(a,"cellVisibleCallback",null);if(null!==o){var d=n(a,"cellVisibleCallbackScope",void 0);this.on("cellvisible",o,d)}if(null!==(o=n(a,"cellInvisibleCallback",null))){d=n(a,"cellInvisibleCallbackScope",void 0);this.on("cellinvisible",o,d)}this.table=new l.a(this,a),this.updateTable()}setScrollMode(t){"string"==typeof t&&(t=d[t.toLowerCase()]),this.scrollMode=t}setClampMode(t){return this.clampTableOXYMode=t,this}setCellsCount(t){var e=this.table.cellCount;return e===t?this:(e>t?this.removeCell(t,e-t):this.insertNewCell(e,t-e),this)}setColumnCount(t){return this.table.colCount===t?this:(this.table.setColumnCount(t),this.updateFlag=!0,this)}setGridSize(t,e){return this.table.setCellsCunt(t*e),this.table.setColumnCount(t),this}insertNewCell(t,e){return"object"==typeof t&&(t=t.index),void 0===e&&(e=1),e<=0?this:(t=a(t,0,this.table.cellCount),this.table.insertNewCell(t,e),t<=this.lastVisibleCellIdx&&(this.updateFlag=!0),this)}removeCell(t,e){if("object"==typeof t&&(t=t.index),void 0===e&&(e=1),t<0&&(e+=t,t=0),e<=0)return this;if(t>this.table.cellCount)return this;if(t<=this.lastVisibleCellIdx)for(var i,l=this.preVisibleCells,s=this.visibleCells,h=t,r=t+e;h<r;h++)(i=this.getCell(h,!1))&&(s.contains(i)&&(this.hideCell(i),this.updateFlag=!0,s.delete(i)),l.delete(i));return this.table.removeCell(t,e),this}get tableOY(){return this._tableOY}get tableOX(){return this._tableOX}set tableOY(t){var e=this.table,i=this.topTableOY,l=this.bottomTableOY,s=this.tableOYExceedTop(t),h=this.tableOYExeceedBottom(t);if(this.clampTableOXYMode)if(e.rowCount<e.heightToRowIndex(this.instHeight,!0))t=0;else if(s)t=i;else{this.tableVisibleHeight;h&&(t=l)}this._tableOY!==t&&(this.updateFlag=!0,this._tableOY=t),s&&(this.execeedTopState||this.emit("execeedtop",this,t,i)),this.execeedTopState=s,h&&(this.execeedBottomState||this.emit("execeedbottom",this,t,l)),this.execeedBottomState=h}set tableOX(t){var e=this.table,i=this.leftTableOX,l=this.rightTableOX,s=this.tableOXExeceedLeft(t),h=this.tableOXExeceedRight(t);if(this.clampTableOXYMode)if(e.colCount<e.widthToColIndex(this.instWidth,!0))t=0;else if(s)t=i;else{this.tableVisibleWidth;h&&(t=l)}this._tableOX!==t&&(this.updateFlag=!0,this._tableOX=t),s&&(this.execeedLeftState||this.emit("execeedleft",this,t,i)),this.execeedLeftState=s,h&&(this.execeedRightState||this.emit("execeedright",this,t,l)),this.execeedRightState=h}setTableOY(t){return this.tableOY=t,this}setTableOX(t){return this.tableOX=t,this}setTableOXY(t,e){return this.tableOX=t,this.tableOY=e,this}addTableOX(t){return this.tableOX+=t,this}addTableOY(t){return this.tableOY+=t,this}addTableOXY(t,e){return this.tableOX+=t,this.tableOY+=e,this}setTableOYByPercentage(t){return t=a(t,0,1),this.setTableOY(-this.tableVisibleHeight*t),this}updateTable(t){return t&&(this.updateFlag=!0),this.updateFlag?(this.updateFlag=!1,t&&(this.cleanVisibleCellIndexes(),this.hideCells()),this.cleanVisibleCellIndexes(),this.showCells(),this.hideCells(),this):this}getCell(t){return this.table.getCell(t,!0)}eachVisibleCell(t,e){return this.visibleCells.each(t,e),this}iterateVisibleCell(t,e){return this.visibleCells.iterate(t,e),this}cleanVisibleCellIndexes(){var t=this.preVisibleCells;this.preVisibleCells=this.visibleCells,this.visibleCells=t,this.visibleCells.clear()}showCells(){var t=this.table,e=t.heightToRowIndex(-this.tableOY);e<0&&(e=0);var i=t.widthToColIndex(-this.tableOX);i<0&&(i=0);var l=t.colRowToCellIndex(i,e),s=this.bottomBound,h=this.rightBound,r=t.cellCount-1,n=t.colCount-1,a=this.getTLX(i),o=a,d=this.getTLY(e);for(this.visibleStartY=null,this.visibleEndY=null,this.visibleStartX=null,this.visibleEndX=null,this.lastVisibleCellIdx=null;d<s&&l<=r;){if(this.table.isValidCellIdx(l)){null===this.visibleStartY&&(this.visibleStartY=e,this.visibleEndY=e),null===this.visibleStartX&&(this.visibleStartX=i,this.visibleEndX=i),null===this.lastVisibleCellIdx&&(this.lastVisibleCellIdx=l),this.visibleEndY<e&&(this.visibleEndY=e),this.visibleEndX<i&&(this.visibleEndX=i),this.lastVisibleCellIdx<l&&(this.lastVisibleCellIdx=l);var u=t.getCell(l,!0);this.visibleCells.set(u),this.preVisibleCells.contains(u)||this.showCell(u),u.setXY(o,d)}o<h&&i<n?(o+=t.getColWidth(i),i+=1):(o=a,d+=t.getRowHeight(e),i=this.visibleStartX,e+=1),l=t.colRowToCellIndex(i,e)}}showCell(t){this.emit("cellvisible",t)}hideCells(){var t=this.preVisibleCells,e=this.visibleCells;t.iterate(function(t){e.contains(t)||this.hideCell(t)},this)}hideCell(t){this.emit("cellinvisible",t),t.destroyContainer()}get instHeight(){return 0===this.scrollMode?this.height:this.width}get instWidth(){return 0===this.scrollMode?this.width:this.height}get topTableOY(){return 0}get bottomTableOY(){return-this.tableVisibleHeight}get leftTableOX(){return 0}get rightTableOX(){return-this.tableVisibleWidth}tableOYExceedTop(t){return void 0===t&&(t=this.tableOY),t>this.topTableOY}tableOYExeceedBottom(t){return void 0===t&&(t=this.tableOY),t<this.bottomTableOY}tableOXExeceedLeft(t){return void 0===t&&(t=this.tableOX),t>this.leftTableOX}tableOXExeceedRight(t){return void 0===t&&(t=this.tableOX),t<this.rightTableOX}get tableVisibleHeight(){var t=this.table.totalRowsHeight,e=this.instHeight;return t>e?t-e:0}get tableVisibleWidth(){var t=this.table.totalColumnWidth,e=this.instWidth;return t>e?t-e:t}get bottomLeftY(){return-this.displayHeight*this.originY+this.displayHeight}get topRightX(){return-this.displayWidth*this.originX+this.displayWidth}get topLeftX(){return-this.displayWidth*this.originX}get topLeftY(){return-this.displayHeight*this.originY}get bottomBound(){return 0===this.scrollMode?this.bottomLeftY:this.topRightX}get rightBound(){return 0===this.scrollMode?this.topRightX:this.bottomLeftY}getTLX(t){var e=0===this.scrollMode?this.topLeftX:this.topLeftY;return this.tableOX+this.table.colIndexToWidth(0,t-1)+e}getTLY(t){var e=0===this.scrollMode?this.topLeftY:this.topLeftX;return this.tableOY+this.table.rowIndexToHeight(0,t-1)+e}destroy(){this.setCellsCunt(0),this.table.destroy(),super.destroy()}}Object.assign(o.prototype,h.GetBounds);const d={v:0,vertical:0,h:1,horizontal:1};e.a=o},59:function(t,e,i){"use strict";var l=i(60),s=i(61);const h=Phaser.Utils.Objects.GetValue,r=Phaser.Utils.Array.SpliceOne;var n=new s.a;e.a=class{constructor(t,e){this.parent=t,this.cells=[],this.resetFromJSON(e)}resetFromJSON(t){return this.colCount=void 0,this.defaultCellHeightMode=!0,this._totalRowsHeight=null,this.setDefaultCellHeight(h(t,"cellHeight",30)),this.setDefaultCellWidth(h(t,"cellWidth",30)),this.initCells(h(t,"cellsCount",0)),this.setColumnCount(h(t,"columns",1)),this}setDefaultCellHeight(t){return this.defaultCellHeight=t,this}setDefaultCellWidth(t){return this.defaultCellWidth=t,this}initCells(t){var e=this.cells;e.length=t;for(var i=0;i<t;i++)e[i]=null;return this}insertNewCell(t,e){var i=this.cells;if(t===i.length){var l=t+e;i.legth=l;for(var s=t;s<l;s++)i[s]=null}else{var h=[];for(h.length=e,s=0;s<e;s++)h[s]=null;this.cells.splice(t,0,...h)}return this}removeCell(t,e){for(var i=t+e,l=t;l<i;l++)this.freeCell(l);return i===this.cells.length?this.cells.length=t:(1===e?r(this.cells,t):this.cells.splice(t,e),this.buildCellIndex(t)),this}setColumnCount(t){return this.colCount=t,this._totalRowsHeight=null,this}get rowCount(){return Math.ceil(this.cells.length/this.colCount)}get cellCount(){return this.cells.length}isValidCellIdx(t){return t>=0&&t<this.cells.length}heightToRowIndex(t,e){if(this.defaultCellHeightMode){var i=t/this.defaultCellHeight;return i=e?Math.ceil(i):Math.floor(i)}var l,s=this.rowCount,h=t;for(i=0;;){if(h-=this.getRowHeight(i),l=i>=0&&i<s,!(h>0&&l)){if(0===h)return i;if(e){var r=i;(l=(i+=1)>=0&&i<s)||(i=r)}return i}i+=1}}widthToColIndex(t,e){var i=t/this.defaultCellWidth;return i=e?Math.ceil(i):Math.floor(i)}colRowToCellIndex(t,e){return e*this.colCount+t}rowIndexToHeight(t,e){if(this.defaultCellHeightMode)return(e-t+1)*this.defaultCellHeight;for(var i,l=0,s=!0,h=t;h<=e;h++)l+=i=this.getRowHeight(h),i!==this.defaultCellHeight&&(s=!1);return s&&0===t&&e>=this.rowCount-1&&(this.defaultCellHeightMode=!0),l}colIndexToWidth(t,e){return(e-t+1)*this.defaultCellWidth}getRowHeight(t){var e=this.colCount;if(e<=1)return this.getCellHeight(this.colRowToCellIndex(0,t));for(var i,l=0,s=0;s<e;s++)l<(i=this.getCellHeight(this.colRowToCellIndex(s,t)))&&(l=i);return l}getColWidth(t){return this.defaultCellWidth}getCellHeight(t){if(!this.isValidCellIdx(t))return 0;var e;if(this.defaultCellHeightMode)e=this.defaultCellHeight;else{var i=this.getCell(t,!1),l=i&&i.hasOwnProperty("deltaHeight")?i.deltaHeight:0;e=this.defaultCellHeight+l}return e}get totalRowsHeight(){return null===this._totalRowsHeight&&(this._totalRowsHeight=this.rowIndexToHeight(0,this.rowCount-1)),this._totalRowsHeight}get totalColumnWidth(){return this.colCount*this.defaultCellWidth}cellIndxeToColIndex(t){return t%this.colCount}cellIndxeToRowIndex(t){return Math.floor(t/this.colCount)}getCell(t,e){if(!this.isValidCellIdx(t))return null;if(void 0===e&&(e=!0),null===this.cells[t]&&e){var i=this.newCell(t);this.cells[t]=i}return this.cells[t]}newCell(t){var e=n.pop();return null===e?e=new l.a(this):(e.setParent(this),e.hasOwnProperty("deltaHeight")&&delete e.deltaHeight),e.index=t,e}buildCellIndex(t){void 0===t&&(t=0);for(var e,i=this.cells,l=t,s=i.length;l<s;l++)(e=i[l])&&(e.index=l);return this}getParentContainer(){return this.parent}freeCell(t){return"number"==typeof t&&(t=this.cells[t]),t?(t.destroy(),n.push(t),this):this}destroy(){this.parent=void 0}}},60:function(t,e,i){"use strict";var l=i(7);e.a=class{constructor(t,e){this.container=null,this.data=null,this.setParent(t)}setParent(t){this.parent=t,this.parentContainer=t.getParentContainer()}get colIndx(){return this.parent.cellIndxeToColIndex(this.index)}get rowIndx(){return this.parent.cellIndxeToRowIndex(this.index)}getContainer(){return this.container}setContainer(t){return this.container&&this.container.destroy(),this.container=t,this.parentContainer.add(t),this}destroyContainer(){this.container&&(this.container.destroy(),this.container=null)}popContainer(){if(this.container){var t=this.container;return this.container=null,this.parentContainer.remove(t),t}return null}setXY(t,e){this.container&&(this.container.x=t,this.container.y=e)}setData(t,e){return this.data||(this.data={}),this.data[t]=e,this}getData(t,e){this.data||(this.data={});var i=this.data;return i.hasOwnProperty(t)?i[t]:e}cleanData(){this.data&&Object(l.a)(this.data)}destroy(){this.cleanData(),this.destroyContainer(),this.parent=void 0,this.parentContainer=void 0}}},61:function(t,e,i){"use strict";var l=i(2);e.a=l.a},7:function(t,e,i){"use strict";var l=i(3);e.a=function(t){if(Object(l.a)(t))t.length=0;else for(var e in t)delete t[e]}}}).default});